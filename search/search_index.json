{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Universal Trading Strategy Schema","text":"<p>A comprehensive, composable schema for expressing any trading strategy.</p> <ul> <li> <p> Get Started in 5 Minutes</p> <p>Install <code>utss</code> and create your first strategy</p> <p> Quickstart</p> </li> <li> <p>:material-architecture:{ .lg .middle } Understand the Design</p> <p>Learn the architecture and design philosophy</p> <p> Architecture</p> </li> <li> <p> Full Reference</p> <p>Complete schema specification</p> <p> Specification</p> </li> <li> <p> Python API</p> <p>Pydantic models and validation</p> <p> API Reference</p> </li> </ul>"},{"location":"#what-is-utss","title":"What is UTSS?","text":"<p>UTSS (Universal Trading Strategy Schema) is a declarative schema for expressing trading strategies. Instead of writing imperative code, you describe what your strategy does, and execution engines handle the how.</p> <pre><code># A complete trading strategy in YAML\ninfo:\n  id: rsi_reversal\n  name: RSI Reversal Strategy\n  version: \"1.0\"\n\nuniverse:\n  type: static\n  symbols: [AAPL, MSFT, GOOGL]\n\nrules:\n  - name: Buy on oversold\n    when:\n      type: comparison\n      left:\n        type: indicator\n        indicator: RSI\n        params: { period: 14 }\n      operator: \"&lt;\"\n      right:\n        type: constant\n        value: 30\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: percent_of_equity\n        percent: 10\n</code></pre>"},{"location":"#why-utss","title":"Why UTSS?","text":""},{"location":"#the-problem","title":"The Problem","text":"<p>Trading strategies are typically expressed in:</p> Format Problem Imperative Code Tied to specific language/platform, hard to validate Natural Language Ambiguous, no validation, different interpretations Platform DSLs Vendor lock-in, limited expressiveness, not portable"},{"location":"#the-solution","title":"The Solution","text":"<p>UTSS provides a universal, declarative schema that is:</p> <ul> <li>Portable - Same strategy works with any compliant engine</li> <li>Validated - Schema validation catches errors before execution</li> <li>LLM-Friendly - Designed for natural language \u2192 strategy conversion</li> <li>Self-Contained - Complete strategy in one document</li> </ul>"},{"location":"#core-concepts","title":"Core Concepts","text":"<pre><code>Signal \u2192 Condition \u2192 Rule \u2192 Strategy\n  \u2502          \u2502         \u2502        \u2502\n  \u2502          \u2502         \u2502        \u2514\u2500\u2500 Complete trading system\n  \u2502          \u2502         \u2514\u2500\u2500 When (condition) \u2192 Then (action)\n  \u2502          \u2514\u2500\u2500 Boolean expression (RSI &lt; 30 = true/false)\n  \u2514\u2500\u2500 Numeric value (RSI = 45.2)\n</code></pre> Concept What it does Example Signal Produces a number <code>RSI(14) = 45.2</code> Condition Produces true/false <code>RSI &lt; 30 = true</code> Rule When/then pair If oversold, buy Strategy Complete system Universe + rules + constraints"},{"location":"#features","title":"Features","text":""},{"location":"#signal-types","title":"Signal Types","text":"<ul> <li>Price - OHLCV data (<code>close</code>, <code>volume</code>)</li> <li>Indicator - Technical indicators (<code>RSI</code>, <code>MACD</code>, <code>SMA</code>)</li> <li>Fundamental - Company metrics (<code>PE_RATIO</code>, <code>ROE</code>)</li> <li>Portfolio - Position state (<code>unrealized_pnl</code>, <code>days_in_position</code>)</li> <li>Calendar - Date patterns (<code>day_of_week</code>, <code>is_month_end</code>)</li> <li>Event - Market events (<code>EARNINGS_RELEASE</code>)</li> <li>Expression - Custom formulas (<code>(close - SMA(20)) / ATR(14)</code>)</li> <li>External - Runtime signals (webhook, ML model)</li> </ul>"},{"location":"#condition-types","title":"Condition Types","text":"<ul> <li>Comparison - <code>RSI &lt; 30</code></li> <li>Cross - <code>SMA(50) crosses above SMA(200)</code></li> <li>Range - <code>20 &lt; RSI &lt; 80</code></li> <li>Temporal - <code>RSI &lt; 30 for 3 bars</code></li> <li>Sequence - <code>A then B within 5 bars</code></li> <li>Logical - <code>AND</code>, <code>OR</code>, <code>NOT</code></li> </ul>"},{"location":"#action-types","title":"Action Types","text":"<ul> <li>Trade - Buy, sell, short, cover</li> <li>Rebalance - Adjust to target weights</li> <li>Alert - Send notifications</li> </ul>"},{"location":"#sizing-methods","title":"Sizing Methods","text":"<ul> <li>Fixed Amount - <code>$10,000</code></li> <li>Percent of Equity - <code>10%</code></li> <li>Risk-Based - <code>1% risk with ATR stop</code></li> <li>Kelly Criterion - Optimal sizing</li> <li>Conditional - Different sizing by regime</li> </ul>"},{"location":"#supported-markets","title":"Supported Markets","text":""},{"location":"#japan-primary-focus","title":"Japan (Primary Focus)","text":"<p><code>NIKKEI225</code>, <code>TOPIX</code>, <code>TOPIX100</code>, <code>TOPIX500</code>, <code>JPXNIKKEI400</code>, <code>TSE_PRIME</code>, <code>TSE_STANDARD</code>, <code>TSE_GROWTH</code></p>"},{"location":"#us","title":"US","text":"<p><code>SP500</code>, <code>NASDAQ100</code>, <code>DOW30</code>, <code>RUSSELL2000</code>, <code>RUSSELL1000</code></p>"},{"location":"#europe","title":"Europe","text":"<p><code>FTSE100</code>, <code>DAX40</code>, <code>CAC40</code>, <code>STOXX50</code>, <code>STOXX600</code></p>"},{"location":"#asia-pacific","title":"Asia Pacific","text":"<p><code>HANG_SENG</code>, <code>SSE50</code>, <code>CSI300</code>, <code>KOSPI</code>, <code>ASX200</code></p>"},{"location":"#global","title":"Global","text":"<p><code>MSCI_WORLD</code>, <code>MSCI_EM</code>, <code>MSCI_ACWI</code>, <code>MSCI_EAFE</code></p>"},{"location":"#packages","title":"Packages","text":"Package Description Install <code>utss</code> Core schema and validation <code>pip install utss</code> <code>pyutss</code> Backtesting engine <code>pip install pyutss</code> <code>utss-llm</code> Conversational strategy builder <code>pip install utss-llm</code> <code>utss-mcp</code> Claude Code MCP server <code>pip install utss-mcp</code>"},{"location":"#quick-installation","title":"Quick Installation","text":"pipuvpoetry <pre><code>pip install utss           # Schema only\npip install pyutss         # With backtesting\npip install utss-mcp       # For Claude Code\n</code></pre> <pre><code>uv add utss\nuv add pyutss\nuv add utss-mcp\n</code></pre> <pre><code>poetry add utss\npoetry add pyutss\npoetry add utss-mcp\n</code></pre>"},{"location":"#quick-validation","title":"Quick Validation","text":"<pre><code>from utss import validate_yaml\n\nyaml_content = \"\"\"\ninfo:\n  id: my_strategy\n  name: My Strategy\n  version: \"1.0\"\n\nuniverse:\n  type: static\n  symbols: [AAPL]\n\nrules:\n  - name: Buy signal\n    when:\n      type: always\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: percent_of_equity\n        percent: 100\n\"\"\"\n\nstrategy = validate_yaml(yaml_content)\nprint(f\"Loaded: {strategy.info.name}\")\n</code></pre>"},{"location":"#claude-code-integration","title":"Claude Code Integration","text":"<p>Build strategies interactively with Claude Code using the MCP server:</p> <pre><code>// Add to ~/.claude/mcp.json\n{\n  \"mcpServers\": {\n    \"utss\": { \"command\": \"utss-mcp\" }\n  }\n}\n</code></pre> <p>Then in Claude Code:</p> <pre><code>You: Help me build a mean reversion RSI strategy\n\nClaude: [uses build_strategy tool]\n        What type of strategy? 1) Mean Reversion 2) Trend Following...\n\nYou: 1\n\nClaude: [continues guided conversation...]\n</code></pre> <p>The MCP server provides:</p> <ul> <li>build_strategy - Interactive guided builder</li> <li>validate_strategy - Schema validation</li> <li>backtest_strategy - Run simulations</li> <li>list_indicators - Available indicators</li> </ul>"},{"location":"#use-cases","title":"Use Cases","text":"Application How UTSS Helps LLM Agents Natural language \u2192 validated strategy Claude Code MCP server with interactive builder Backtesting Load strategy, simulate on historical data Parameter Optimization Extract parameters, run grid search Live Trading Same strategy, real execution Strategy Marketplace Share and distribute strategies"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li> <p> Quickstart</p> <p>Create your first strategy</p> </li> <li> <p> Examples</p> <p>Browse working strategies</p> </li> <li> <p> Architecture</p> <p>Understand the design</p> </li> <li> <p> API Reference</p> <p>Python types and validation</p> </li> </ul>"},{"location":"api-pyutss/","title":"pyutss API Reference","text":"<p><code>pyutss</code> is the Python backtesting engine for UTSS strategies. It executes strategies against historical market data and provides comprehensive performance analysis.</p>"},{"location":"api-pyutss/#installation","title":"Installation","text":"<pre><code># Basic installation\npip install pyutss\n\n# With optional dependencies for visualization\npip install pyutss[visualization]\n\n# Development installation\npip install pyutss[dev]\n</code></pre>"},{"location":"api-pyutss/#quick-start","title":"Quick Start","text":"<pre><code>from pyutss import Engine\nfrom utss import load_yaml\nimport pandas as pd\n\n# Load strategy\nstrategy = load_yaml(\"my_strategy.yaml\")\n\n# Get historical data (OHLCV DataFrame)\ndata = pd.read_csv(\"AAPL.csv\", index_col=\"date\", parse_dates=True)\n\n# Run backtest (unified Engine for 1..N symbols)\nengine = Engine(\n    initial_capital=100000,\n    commission_rate=0.001,\n    slippage_rate=0.0005,\n)\nresult = engine.backtest(strategy, data=data, symbol=\"AAPL\")\n\n# View results\nprint(f\"Total Return: {result.total_return_pct:.2f}%\")\nprint(f\"Win Rate: {result.win_rate:.1f}%\")\nresult.summary()\n</code></pre>"},{"location":"api-pyutss/#engine","title":"Engine","text":"<p>The unified entry point for running backtests. Handles both single-symbol and multi-symbol strategies with the same API.</p>"},{"location":"api-pyutss/#constructor","title":"Constructor","text":"<pre><code>Engine(\n    initial_capital: float = 100000.0,\n    commission_rate: float = 0.001,\n    slippage_rate: float = 0.0005,\n    risk_free_rate: float = 0.0,\n    lot_size: int = 1,\n    config: BacktestConfig | None = None,\n    executor: BacktestExecutor | None = None,\n)\n</code></pre>"},{"location":"api-pyutss/#methods","title":"Methods","text":""},{"location":"api-pyutss/#backteststrategy-data-symbol-backtestresult-portfolioresult","title":"<code>backtest(strategy, data, symbol, ...) -&gt; BacktestResult | PortfolioResult</code>","text":"<p>Execute a backtest. Returns <code>BacktestResult</code> for single symbol, <code>PortfolioResult</code> for multiple.</p> <pre><code># Single symbol\nresult = engine.backtest(\n    strategy=strategy,          # dict or path to YAML\n    data=ohlcv_dataframe,       # DataFrame with OHLCV columns\n    symbol=\"AAPL\",              # Symbol identifier\n)\n\n# Multi symbol\nresult = engine.backtest(\n    strategy=strategy,\n    data={\"AAPL\": df1, \"MSFT\": df2},\n    weights=\"equal\",            # \"equal\", \"inverse_vol\", \"risk_parity\"\n)\n</code></pre> <p>Parameters:</p> <ul> <li><code>strategy</code>: UTSS strategy dict or path to YAML file</li> <li><code>data</code>: DataFrame (single) or dict of DataFrames (multi), or None for auto-fetch</li> <li><code>symbol</code>: Symbol name (for single-symbol with DataFrame)</li> <li><code>start_date</code>: Backtest start date</li> <li><code>end_date</code>: Backtest end date</li> <li><code>parameters</code>: Strategy parameter overrides</li> <li><code>weights</code>: Weight scheme for multi-symbol</li> <li><code>config</code>: BacktestSpec or path to backtest config YAML</li> </ul> <p>Returns: <code>BacktestResult</code> for single symbol, <code>PortfolioResult</code> for multiple</p>"},{"location":"api-pyutss/#backtestexecutor","title":"BacktestExecutor","text":"<p>Handles simulated trade execution with commission, slippage, and lot size models.</p> <pre><code>from pyutss import BacktestExecutor\n\n# US market (default)\nexecutor = BacktestExecutor(commission_rate=0.001, slippage_rate=0.0005)\n\n# Japanese market with tiered commission\nexecutor = BacktestExecutor(\n    lot_size=100,\n    tiered_commission=[\n        {\"up_to\": 50000, \"fee\": 55},\n        {\"up_to\": 100000, \"fee\": 99},\n        {\"up_to\": 200000, \"fee\": 115},\n        {\"above\": 200000, \"fee\": 275},\n    ],\n    slippage_rate=0.001,\n)\n\nengine = Engine(initial_capital=10_000_000, executor=executor)\n</code></pre>"},{"location":"api-pyutss/#backtestengine-deprecated","title":"BacktestEngine (Deprecated)","text":"<p>Legacy API. Use <code>Engine</code> instead. <code>BacktestEngine</code> is still available for backward compatibility.</p>"},{"location":"api-pyutss/#backtestconfig","title":"BacktestConfig","text":"<p>Configuration for backtest execution.</p> <pre><code>@dataclass\nclass BacktestConfig:\n    initial_capital: float = 100000.0\n    commission_rate: float = 0.001      # 0.1% per trade\n    slippage_rate: float = 0.0005       # 0.05% slippage\n    risk_free_rate: float = 0.0         # Annual risk-free rate\n    margin_requirement: float = 1.0     # 1.0 = no margin\n</code></pre>"},{"location":"api-pyutss/#backtestresult","title":"BacktestResult","text":"<p>Contains all results from a backtest run.</p>"},{"location":"api-pyutss/#properties","title":"Properties","text":"<pre><code>result.strategy_id      # Strategy identifier\nresult.symbol           # Symbol traded\nresult.start_date       # Backtest start date\nresult.end_date         # Backtest end date\nresult.initial_capital  # Starting capital\nresult.final_equity     # Ending equity\nresult.total_return     # Total return in currency\nresult.total_return_pct # Total return as percentage\nresult.num_trades       # Total number of trades\nresult.win_rate         # Win rate percentage\nresult.trades           # List of Trade objects\nresult.equity_curve     # pd.Series of daily equity\nresult.portfolio_history # List of PortfolioSnapshot\n</code></pre>"},{"location":"api-pyutss/#methods_1","title":"Methods","text":""},{"location":"api-pyutss/#summaryprint_outputtrue-str","title":"<code>summary(print_output=True) -&gt; str</code>","text":"<p>Generate and print a formatted summary.</p> <pre><code>result.summary()\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  Backtest Results: AAPL\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  Period: 2023-01-01 to 2024-01-01\n#  Initial Capital: $100,000.00\n#  Final Equity: $115,432.50\n#  ...\n</code></pre>"},{"location":"api-pyutss/#plotdata-kwargs","title":"<code>plot(data, **kwargs)</code>","text":"<p>Plot backtest results with candlestick chart.</p> <pre><code>result.plot(\n    data=ohlcv_df,\n    title=\"My Strategy\",\n    show_equity=True,\n    show_volume=True,\n    figsize=(14, 8),\n)\n</code></pre>"},{"location":"api-pyutss/#data-providers","title":"Data Providers","text":""},{"location":"api-pyutss/#yahoodataprovider","title":"YahooDataProvider","text":"<p>Fetch data from Yahoo Finance.</p> <pre><code>from pyutss.data.providers import YahooDataProvider\n\nprovider = YahooDataProvider()\n\n# Get historical data\ndata = provider.get_ohlcv(\n    symbol=\"AAPL\",\n    start_date=\"2023-01-01\",\n    end_date=\"2024-01-01\",\n)\n</code></pre>"},{"location":"api-pyutss/#jquantsdataprovider","title":"JQuantsDataProvider","text":"<p>Fetch Japanese market data from J-Quants.</p> <pre><code>from pyutss.data.providers import JQuantsDataProvider\n\nprovider = JQuantsDataProvider(\n    mail_address=\"your@email.com\",\n    password=\"your_password\",\n)\n\n# Get Japanese stock data\ndata = provider.get_ohlcv(\n    symbol=\"7203.T\",  # Toyota\n    start_date=\"2023-01-01\",\n    end_date=\"2024-01-01\",\n)\n</code></pre>"},{"location":"api-pyutss/#custom-provider","title":"Custom Provider","text":"<p>Implement your own data provider:</p> <pre><code>from pyutss.data.providers import BaseDataProvider\n\nclass MyProvider(BaseDataProvider):\n    def get_ohlcv(self, symbol, start_date, end_date) -&gt; pd.DataFrame:\n        # Your implementation\n        pass\n</code></pre>"},{"location":"api-pyutss/#metricscalculator","title":"MetricsCalculator","text":"<p>Calculate comprehensive performance metrics.</p> <pre><code>from pyutss import MetricsCalculator\n\ncalculator = MetricsCalculator(risk_free_rate=0.02)\nmetrics = calculator.calculate(result)\n\nprint(f\"Sharpe Ratio: {metrics.sharpe_ratio:.2f}\")\nprint(f\"Max Drawdown: {metrics.max_drawdown_pct:.2f}%\")\nprint(f\"Profit Factor: {metrics.profit_factor:.2f}\")\n</code></pre>"},{"location":"api-pyutss/#performancemetrics","title":"PerformanceMetrics","text":"<p>All calculated metrics:</p> <pre><code>@dataclass\nclass PerformanceMetrics:\n    # Returns\n    total_return: float\n    total_return_pct: float\n    annualized_return: float\n    annualized_return_pct: float\n\n    # Risk-adjusted\n    sharpe_ratio: float\n    sortino_ratio: float\n    calmar_ratio: float\n\n    # Drawdown\n    max_drawdown: float\n    max_drawdown_pct: float\n    max_drawdown_duration_days: int\n    avg_drawdown: float\n    avg_drawdown_pct: float\n\n    # Trade statistics\n    total_trades: int\n    winning_trades: int\n    losing_trades: int\n    win_rate: float\n    profit_factor: float\n    avg_win: float\n    avg_loss: float\n    largest_win: float\n    largest_loss: float\n    avg_trade_pnl: float\n    avg_trade_duration_days: float\n\n    # Risk\n    volatility: float\n    volatility_annualized: float\n    downside_deviation: float\n\n    # Exposure\n    total_exposure_days: int\n    exposure_pct: float\n</code></pre>"},{"location":"api-pyutss/#period-breakdown","title":"Period Breakdown","text":"<p>Get monthly or yearly breakdowns:</p> <pre><code>monthly = calculator.monthly_breakdown(result)\nfor period in monthly:\n    print(f\"{period.period}: {period.return_pct:.2f}%\")\n\nyearly = calculator.yearly_breakdown(result)\n</code></pre>"},{"location":"api-pyutss/#benchmarkmetrics","title":"BenchmarkMetrics","text":"<p>Compare strategy performance against a benchmark.</p> <pre><code>from pyutss import calculate_benchmark_metrics\n\n# Get benchmark data\nbenchmark_returns = spy_data[\"close\"].pct_change().dropna()\nstrategy_returns = result.equity_curve.pct_change().dropna()\n\nmetrics = calculate_benchmark_metrics(\n    strategy_returns=strategy_returns,\n    benchmark_returns=benchmark_returns,\n    risk_free_rate=0.02,\n)\n\nprint(f\"Alpha: {metrics.alpha:.2%}\")\nprint(f\"Beta: {metrics.beta:.2f}\")\nprint(f\"Information Ratio: {metrics.information_ratio:.2f}\")\nprint(f\"Tracking Error: {metrics.tracking_error:.2%}\")\nprint(f\"Up Capture: {metrics.up_capture:.1f}%\")\nprint(f\"Down Capture: {metrics.down_capture:.1f}%\")\n</code></pre>"},{"location":"api-pyutss/#montecarlosimulator","title":"MonteCarloSimulator","text":"<p>Analyze strategy robustness with Monte Carlo simulation.</p> <pre><code>from pyutss import MonteCarloSimulator\n\nsimulator = MonteCarloSimulator(seed=42)\n\n# Shuffle trades to analyze path dependency\nmc_result = simulator.shuffle_trades(\n    trades=result.trades,\n    initial_capital=100000,\n    n_iterations=1000,\n)\n\nprint(mc_result.summary())\n# Monte Carlo Simulation Results (1,000 iterations)\n# ==================================================\n# Drawdown Analysis:\n#   Median Max Drawdown: 8.50%\n#   95th Percentile:     15.20%\n#   99th Percentile:     19.80%\n#\n# Return Analysis (95% CI):\n#   Total Return: [5.20%, 25.80%]\n#   Sharpe Ratio: [0.52, 1.45]\n\n# Bootstrap returns for confidence intervals\nmc_result = simulator.bootstrap_returns(\n    returns=result.equity_curve.pct_change().dropna(),\n    n_iterations=1000,\n    block_size=20,  # Block bootstrap\n)\n</code></pre>"},{"location":"api-pyutss/#multi-symbol-portfolio-backtesting","title":"Multi-Symbol Portfolio Backtesting","text":"<p>Use the unified <code>Engine</code> for multi-symbol strategies. Returns <code>PortfolioResult</code> automatically.</p> <pre><code>from pyutss import Engine\n\nengine = Engine(initial_capital=1000000)\n\n# Prepare data for multiple symbols\ndata_dict = {\n    \"AAPL\": aapl_data,\n    \"MSFT\": msft_data,\n    \"GOOGL\": googl_data,\n}\n\n# Same Engine API - returns PortfolioResult for multi-symbol\nresult = engine.backtest(strategy, data=data_dict, weights=\"equal\")\n\nprint(f\"Portfolio Return: {result.total_return_pct:.2f}%\")\nprint(f\"Symbols: {result.symbols}\")\nprint(f\"Rebalance Count: {result.rebalance_count}\")\n\n# Access per-symbol results\nfor sym, sym_result in result.per_symbol_results.items():\n    print(f\"  {sym}: {sym_result.total_return_pct:.2f}%\")\n</code></pre>"},{"location":"api-pyutss/#weight-schemes","title":"Weight Schemes","text":"<ul> <li><code>\"equal\"</code>: Equal weight across all positions</li> <li><code>\"inverse_vol\"</code>: Weight inversely to volatility</li> <li><code>\"risk_parity\"</code>: Target equal risk contribution</li> <li><code>dict[str, float]</code>: Custom target weights (e.g., <code>{\"AAPL\": 0.5, \"MSFT\": 0.3, \"GOOGL\": 0.2}</code>)</li> </ul>"},{"location":"api-pyutss/#portfoliobacktester-deprecated","title":"PortfolioBacktester (Deprecated)","text":"<p>Legacy API. Use <code>Engine</code> with a data dict instead.</p>"},{"location":"api-pyutss/#optimization","title":"Optimization","text":""},{"location":"api-pyutss/#grid-search","title":"Grid Search","text":"<pre><code>from pyutss.optimization import GridSearchOptimizer\n\noptimizer = GridSearchOptimizer()\n\nparam_grid = {\n    \"rsi_period\": [10, 14, 20],\n    \"entry_threshold\": [25, 30, 35],\n    \"exit_threshold\": [65, 70, 75],\n}\n\nresults = optimizer.optimize(\n    strategy=strategy,\n    data=data,\n    symbol=\"AAPL\",\n    param_grid=param_grid,\n    metric=\"sharpe_ratio\",\n)\n\nprint(f\"Best params: {results.best_params}\")\nprint(f\"Best Sharpe: {results.best_score:.2f}\")\n</code></pre>"},{"location":"api-pyutss/#walk-forward-optimization","title":"Walk-Forward Optimization","text":"<pre><code>from pyutss.optimization import WalkForwardOptimizer\n\noptimizer = WalkForwardOptimizer(\n    train_period=252,  # 1 year training\n    test_period=63,    # 3 month testing\n    step=21,           # Step by 1 month\n)\n\nresults = optimizer.optimize(\n    strategy=strategy,\n    data=data,\n    symbol=\"AAPL\",\n    param_grid=param_grid,\n)\n\n# Results include out-of-sample performance\nprint(f\"In-sample Sharpe: {results.in_sample_sharpe:.2f}\")\nprint(f\"Out-of-sample Sharpe: {results.out_of_sample_sharpe:.2f}\")\n</code></pre>"},{"location":"api-pyutss/#visualization","title":"Visualization","text":""},{"location":"api-pyutss/#tearsheet","title":"TearSheet","text":"<p>Generate comprehensive performance report.</p> <pre><code>from pyutss.visualization import TearSheet\n\nsheet = TearSheet(result)\nsheet.generate()  # Opens in browser\n\n# Or save to file\nsheet.save(\"tearsheet.html\")\n</code></pre>"},{"location":"api-pyutss/#charts","title":"Charts","text":"<pre><code>from pyutss.visualization import plot_equity_curve, plot_drawdown\n\n# Equity curve\nplot_equity_curve(result.equity_curve)\n\n# Drawdown chart\nplot_drawdown(result.equity_curve)\n</code></pre>"},{"location":"api-pyutss/#html-report","title":"HTML Report","text":"<pre><code>from pyutss.visualization import HTMLReport\n\nreport = HTMLReport(result)\nreport.generate(\"backtest_report.html\")\n</code></pre>"},{"location":"api-pyutss/#signal-and-condition-evaluators","title":"Signal and Condition Evaluators","text":"<p>For advanced use cases, access evaluators directly:</p> <pre><code>from pyutss import SignalEvaluator, ConditionEvaluator, EvaluationContext\n\n# Create context\nctx = EvaluationContext(primary_data=ohlcv_df)\n\n# Evaluate signals\nsignal_eval = SignalEvaluator()\nrsi_values = signal_eval.evaluate_signal(\n    {\"type\": \"indicator\", \"indicator\": \"RSI\", \"params\": {\"period\": 14}},\n    ctx,\n)\n\n# Evaluate conditions\ncond_eval = ConditionEvaluator(signal_eval)\nis_oversold = cond_eval.evaluate_condition(\n    {\"type\": \"comparison\", \"left\": ..., \"operator\": \"&lt;\", \"right\": ...},\n    ctx,\n)\n</code></pre>"},{"location":"api-pyutss/#error-handling","title":"Error Handling","text":"<pre><code>from pyutss import EvaluationError, DataProviderError\n\ntry:\n    result = engine.run(strategy, data, \"AAPL\")\nexcept EvaluationError as e:\n    print(f\"Strategy evaluation failed: {e}\")\nexcept DataProviderError as e:\n    print(f\"Data fetch failed: {e}\")\n</code></pre>"},{"location":"api-pyutss/#type-exports","title":"Type Exports","text":"<p>All major types are exported at the package level:</p> <pre><code>from pyutss import (\n    # Engine (unified)\n    Engine,\n    BacktestExecutor,\n    OrderRequest,\n    Fill,\n    PortfolioManager,\n    UniverseResolver,\n\n    # Legacy (deprecated, use Engine instead)\n    BacktestEngine,\n    BacktestConfig,\n\n    # Results\n    BacktestResult,\n    Trade,\n    Position,\n    PortfolioSnapshot,\n\n    # Metrics\n    MetricsCalculator,\n    PerformanceMetrics,\n    PeriodBreakdown,\n    BenchmarkMetrics,\n    calculate_benchmark_metrics,\n\n    # Analysis\n    MonteCarloSimulator,\n    MonteCarloResult,\n\n    # Sizing\n    calculate_size,\n    round_to_lot,\n\n    # Data\n    OHLCV,\n    StockMetadata,\n    BaseDataProvider,\n\n    # Evaluation\n    SignalEvaluator,\n    ConditionEvaluator,\n    EvaluationContext,\n    IndicatorService,\n)\n</code></pre>"},{"location":"api/","title":"Python API Reference","text":"<p>The <code>utss</code> package provides Pydantic models for all schema types and validation utilities.</p>"},{"location":"api/#installation","title":"Installation","text":"<pre><code>pip install utss\n</code></pre>"},{"location":"api/#quick-start","title":"Quick Start","text":"<pre><code>from utss import validate_yaml, Strategy\n\n# Validate YAML\nstrategy = validate_yaml(yaml_content)\n\n# Access strategy components\nprint(strategy.info.name)\nprint(strategy.universe.symbols)\nprint(len(strategy.rules))\n</code></pre>"},{"location":"api/#validation-functions","title":"Validation Functions","text":""},{"location":"api/#validate_yaml","title":"validate_yaml","text":"<p>Validate a YAML string and return a Strategy object.</p> <pre><code>from utss import validate_yaml, ValidationError\n\nyaml_content = \"\"\"\ninfo:\n  id: my_strategy\n  name: My Strategy\n  version: \"1.0\"\nuniverse:\n  type: static\n  symbols: [AAPL]\nrules:\n  - name: Buy\n    when: { type: always }\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 100 }\n\"\"\"\n\ntry:\n    strategy = validate_yaml(yaml_content)\n    print(f\"Valid strategy: {strategy.info.name}\")\nexcept ValidationError as e:\n    for error in e.errors:\n        print(f\"Error: {error}\")\n</code></pre>"},{"location":"api/#validate_strategy","title":"validate_strategy","text":"<p>Validate a dictionary and return a Strategy object.</p> <pre><code>from utss import validate_strategy\n\ndata = {\n    \"info\": {\"id\": \"test\", \"name\": \"Test\", \"version\": \"1.0\"},\n    \"universe\": {\"type\": \"static\", \"symbols\": [\"AAPL\"]},\n    \"rules\": [\n        {\n            \"name\": \"Buy\",\n            \"when\": {\"type\": \"always\"},\n            \"then\": {\n                \"type\": \"trade\",\n                \"direction\": \"buy\",\n                \"sizing\": {\"type\": \"percent_of_equity\", \"percent\": 100}\n            }\n        }\n    ]\n}\n\nstrategy = validate_strategy(data)\n</code></pre>"},{"location":"api/#core-models","title":"Core Models","text":""},{"location":"api/#strategy","title":"Strategy","text":"<p>The top-level strategy model.</p> <pre><code>from utss import Strategy\n\nclass Strategy:\n    info: Info                              # Required\n    universe: Universe                      # Required\n    signals: dict[str, Signal] | None       # Optional\n    conditions: dict[str, Condition] | None # Optional\n    rules: list[Rule]                       # Required (min 1)\n    constraints: Constraints | None         # Optional\n    schedule: Schedule | None               # Optional\n    parameters: dict[str, Parameter] | None # Optional\n</code></pre>"},{"location":"api/#info","title":"Info","text":"<p>Strategy metadata.</p> <pre><code>from utss import Info, Author, Visibility\n\ninfo = Info(\n    id=\"my_strategy\",           # Required, pattern: ^[a-z0-9_-]+$\n    name=\"My Strategy\",         # Required, max 100 chars\n    version=\"1.0\",              # Required, pattern: ^\\d+\\.\\d+(\\.\\d+)?$\n    description=\"Description\",  # Optional, max 2000 chars\n    author=Author(id=\"user\", name=\"User Name\"),  # Optional\n    tags=[\"momentum\", \"japan\"], # Optional, max 10\n    visibility=Visibility.PRIVATE  # public | private | unlisted\n)\n</code></pre>"},{"location":"api/#signal-types","title":"Signal Types","text":"<p>All signal types produce numeric values.</p>"},{"location":"api/#pricesignal","title":"PriceSignal","text":"<pre><code>from utss import PriceSignal, PriceField\n\nsignal = PriceSignal(\n    type=\"price\",\n    field=PriceField.CLOSE,  # open|high|low|close|volume|vwap\n    offset=0,                 # Bars back (0=current)\n    timeframe=\"daily\",        # Optional, for MTF\n    symbol=\"AAPL\"             # Optional, cross-symbol\n)\n</code></pre>"},{"location":"api/#indicatorsignal","title":"IndicatorSignal","text":"<pre><code>from utss import IndicatorSignal, IndicatorType, IndicatorParams\n\nsignal = IndicatorSignal(\n    type=\"indicator\",\n    indicator=IndicatorType.RSI,\n    params=IndicatorParams(period=14),\n    offset=0,\n    timeframe=None,\n    symbol=None\n)\n</code></pre>"},{"location":"api/#fundamentalsignal","title":"FundamentalSignal","text":"<pre><code>from utss import FundamentalSignal, FundamentalMetric\n\nsignal = FundamentalSignal(\n    type=\"fundamental\",\n    metric=FundamentalMetric.PE_RATIO\n)\n</code></pre>"},{"location":"api/#portfoliosignal","title":"PortfolioSignal","text":"<pre><code>from utss import PortfolioSignal, PortfolioField\n\nsignal = PortfolioSignal(\n    type=\"portfolio\",\n    field=PortfolioField.UNREALIZED_PNL_PCT,\n    symbol=None  # Optional, default: current symbol\n)\n</code></pre>"},{"location":"api/#calendarsignal","title":"CalendarSignal","text":"<pre><code>from utss import CalendarSignal, CalendarField\n\nsignal = CalendarSignal(\n    type=\"calendar\",\n    field=CalendarField.DAY_OF_WEEK  # Returns 1-5 (Mon-Fri)\n)\n</code></pre>"},{"location":"api/#constantsignal","title":"ConstantSignal","text":"<pre><code>from utss import ConstantSignal\n\nsignal = ConstantSignal(\n    type=\"constant\",\n    value=30.0\n)\n</code></pre>"},{"location":"api/#arithmeticsignal","title":"ArithmeticSignal","text":"<pre><code>from utss import ArithmeticSignal, ArithmeticOperator\n\nsignal = ArithmeticSignal(\n    type=\"arithmetic\",\n    operator=ArithmeticOperator.SUBTRACT,\n    operands=[sma_20_signal, sma_50_signal]\n)\n</code></pre>"},{"location":"api/#expressionsignal","title":"ExpressionSignal","text":"<pre><code>from utss import ExpressionSignal\n\nsignal = ExpressionSignal(\n    type=\"expr\",\n    formula=\"(close - SMA(close, 20)) / ATR(14)\"\n)\n</code></pre>"},{"location":"api/#externalsignal","title":"ExternalSignal","text":"<pre><code>from utss import ExternalSignal, ExternalSource\n\nsignal = ExternalSignal(\n    type=\"external\",\n    source=ExternalSource.WEBHOOK,\n    url=\"https://api.example.com/signal\",\n    refresh=\"daily\",\n    default=0.5\n)\n</code></pre>"},{"location":"api/#condition-types","title":"Condition Types","text":"<p>All condition types produce boolean values.</p>"},{"location":"api/#comparisoncondition","title":"ComparisonCondition","text":"<pre><code>from utss import ComparisonCondition, ComparisonOperator\n\ncondition = ComparisonCondition(\n    type=\"comparison\",\n    left=rsi_signal,\n    operator=ComparisonOperator.LT,  # &lt; | &lt;= | = | &gt;= | &gt; | !=\n    right=ConstantSignal(type=\"constant\", value=30)\n)\n</code></pre>"},{"location":"api/#andcondition-orcondition","title":"AndCondition / OrCondition","text":"<pre><code>from utss import AndCondition, OrCondition\n\nand_cond = AndCondition(\n    type=\"and\",\n    conditions=[condition1, condition2]  # Min 2\n)\n\nor_cond = OrCondition(\n    type=\"or\",\n    conditions=[condition1, condition2]\n)\n</code></pre>"},{"location":"api/#notcondition","title":"NotCondition","text":"<pre><code>from utss import NotCondition\n\ncondition = NotCondition(\n    type=\"not\",\n    condition=overbought_condition\n)\n</code></pre>"},{"location":"api/#expressioncondition","title":"ExpressionCondition","text":"<p>For complex patterns like crossovers, ranges, and temporal conditions, use the <code>expr</code> type with a formula string. This provides maximum flexibility with minimal primitives.</p> <pre><code>from utss import ExpressionCondition\n\n# Golden cross: SMA(50) crosses above SMA(200)\ncondition = ExpressionCondition(\n    type=\"expr\",\n    formula=\"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"\n)\n\n# RSI in range\ncondition = ExpressionCondition(\n    type=\"expr\",\n    formula=\"RSI(14) &gt;= 40 and RSI(14) &lt;= 60\"\n)\n\n# Price breakout\ncondition = ExpressionCondition(\n    type=\"expr\",\n    formula=\"close &gt; BB(20, 2).upper\"\n)\n</code></pre> <p>See <code>patterns/</code> directory for reusable formula templates for common patterns like: - Crossovers: <code>patterns/crossovers.yaml</code> - Ranges: <code>patterns/ranges.yaml</code> - Temporal: <code>patterns/temporal.yaml</code></p>"},{"location":"api/#alwayscondition","title":"AlwaysCondition","text":"<pre><code>from utss import AlwaysCondition\n\ncondition = AlwaysCondition(type=\"always\")\n</code></pre>"},{"location":"api/#action-types","title":"Action Types","text":""},{"location":"api/#tradeaction","title":"TradeAction","text":"<pre><code>from utss import TradeAction, TradeDirection, OrderType, TimeInForce\n\naction = TradeAction(\n    type=\"trade\",\n    direction=TradeDirection.BUY,  # buy|sell|short|cover\n    sizing=PercentEquitySizing(type=\"percent_of_equity\", percent=10),\n    symbol=None,                   # Optional, default: current\n    order_type=OrderType.MARKET,   # market|limit|stop|stop_limit\n    time_in_force=TimeInForce.DAY  # day|gtc|ioc|fok\n)\n</code></pre>"},{"location":"api/#rebalanceaction","title":"RebalanceAction","text":"<pre><code>from utss import RebalanceAction, RebalanceMethod\n\naction = RebalanceAction(\n    type=\"rebalance\",\n    method=RebalanceMethod.EQUAL_WEIGHT,  # equal_weight|market_cap_weight|risk_parity|inverse_volatility|target_weights\n    threshold=0.05\n)\n</code></pre>"},{"location":"api/#alertaction","title":"AlertAction","text":"<pre><code>from utss import AlertAction, AlertLevel, AlertChannel\n\naction = AlertAction(\n    type=\"alert\",\n    message=\"RSI oversold on {symbol}!\",\n    level=AlertLevel.WARNING,  # info|warning|critical\n    channels=[AlertChannel.LOG, AlertChannel.TELEGRAM],\n    throttle_minutes=60\n)\n</code></pre>"},{"location":"api/#sizing-types","title":"Sizing Types","text":""},{"location":"api/#percentequitysizing","title":"PercentEquitySizing","text":"<pre><code>from utss import PercentEquitySizing\n\nsizing = PercentEquitySizing(\n    type=\"percent_of_equity\",\n    percent=10.0  # 0-100\n)\n</code></pre>"},{"location":"api/#riskbasedsizing","title":"RiskBasedSizing","text":"<pre><code>from utss import RiskBasedSizing\n\nsizing = RiskBasedSizing(\n    type=\"risk_based\",\n    risk_percent=1.0,  # Risk 1% of portfolio\n    stop_distance=atr_signal  # ATR(14) for stop distance\n)\n</code></pre>"},{"location":"api/#conditionalsizing","title":"ConditionalSizing","text":"<pre><code>from utss import ConditionalSizing, ConditionalSizingCase\n\nsizing = ConditionalSizing(\n    type=\"conditional\",\n    cases=[\n        ConditionalSizingCase(\n            when=high_volatility_condition,\n            sizing=PercentEquitySizing(type=\"percent_of_equity\", percent=5)\n        )\n    ],\n    default=PercentEquitySizing(type=\"percent_of_equity\", percent=10)\n)\n</code></pre>"},{"location":"api/#universe-types","title":"Universe Types","text":""},{"location":"api/#staticuniverse","title":"StaticUniverse","text":"<pre><code>from utss import StaticUniverse\n\nuniverse = StaticUniverse(\n    type=\"static\",\n    symbols=[\"AAPL\", \"MSFT\", \"GOOGL\"]\n)\n</code></pre>"},{"location":"api/#indexuniverse","title":"IndexUniverse","text":"<pre><code>from utss import IndexUniverse, StockIndex\n\nuniverse = IndexUniverse(\n    type=\"index\",\n    index=StockIndex.NIKKEI225,\n    rank_by=momentum_signal,  # Optional\n    order=\"desc\",             # asc|desc\n    limit=10                  # Optional\n)\n</code></pre>"},{"location":"api/#dualuniverse","title":"DualUniverse","text":"<pre><code>from utss import DualUniverse, DualUniverseSide\n\nuniverse = DualUniverse(\n    type=\"dual\",\n    long=DualUniverseSide(\n        index=StockIndex.SP500,\n        rank_by=momentum_signal,\n        limit=50\n    ),\n    short=DualUniverseSide(\n        index=StockIndex.SP500,\n        rank_by=momentum_signal,\n        order=\"asc\",\n        limit=50\n    )\n)\n</code></pre>"},{"location":"api/#enums","title":"Enums","text":""},{"location":"api/#indicators","title":"Indicators","text":"<pre><code>from utss import IndicatorType\n\n# Moving Averages\nIndicatorType.SMA, IndicatorType.EMA, IndicatorType.WMA, IndicatorType.KAMA, IndicatorType.HULL\n\n# Momentum\nIndicatorType.RSI, IndicatorType.MACD, IndicatorType.STOCH_K, IndicatorType.ROC, IndicatorType.CCI\n\n# Volatility\nIndicatorType.ATR, IndicatorType.BB_UPPER, IndicatorType.BB_LOWER, IndicatorType.KC_UPPER\n\n# Volume\nIndicatorType.OBV, IndicatorType.VWAP, IndicatorType.CMF\n\n# Statistical\nIndicatorType.ZSCORE, IndicatorType.PERCENTILE, IndicatorType.CORRELATION\n</code></pre>"},{"location":"api/#stock-indices","title":"Stock Indices","text":"<pre><code>from utss import StockIndex\n\n# Japan\nStockIndex.NIKKEI225, StockIndex.TOPIX, StockIndex.TSE_PRIME\n\n# US\nStockIndex.SP500, StockIndex.NASDAQ100, StockIndex.DOW30\n\n# Europe\nStockIndex.FTSE100, StockIndex.DAX40\n\n# Global\nStockIndex.MSCI_WORLD, StockIndex.MSCI_EM\n</code></pre>"},{"location":"api/#parameter-system","title":"Parameter System","text":"<pre><code>from utss import Parameter, ParameterType, ParameterReference\n\n# Define parameter\nparam = Parameter(\n    type=ParameterType.INTEGER,\n    default=14,\n    min=5,\n    max=30,\n    step=1,\n    description=\"RSI period\"\n)\n\n# Reference in signal (YAML uses $param)\n# In Python, use ParameterReference\n</code></pre>"},{"location":"api/#complete-example","title":"Complete Example","text":"<pre><code>from utss import (\n    Strategy, Info, StaticUniverse, Rule,\n    IndicatorSignal, IndicatorType, IndicatorParams,\n    ComparisonCondition, ComparisonOperator,\n    ConstantSignal, TradeAction, TradeDirection,\n    PercentEquitySizing, Constraints, StopConfig\n)\n\nstrategy = Strategy(\n    info=Info(\n        id=\"rsi_reversal\",\n        name=\"RSI Reversal\",\n        version=\"1.0\"\n    ),\n    universe=StaticUniverse(\n        type=\"static\",\n        symbols=[\"AAPL\", \"MSFT\"]\n    ),\n    rules=[\n        Rule(\n            name=\"Buy oversold\",\n            when=ComparisonCondition(\n                type=\"comparison\",\n                left=IndicatorSignal(\n                    type=\"indicator\",\n                    indicator=IndicatorType.RSI,\n                    params=IndicatorParams(period=14)\n                ),\n                operator=ComparisonOperator.LT,\n                right=ConstantSignal(type=\"constant\", value=30)\n            ),\n            then=TradeAction(\n                type=\"trade\",\n                direction=TradeDirection.BUY,\n                sizing=PercentEquitySizing(\n                    type=\"percent_of_equity\",\n                    percent=10\n                )\n            )\n        )\n    ],\n    constraints=Constraints(\n        max_positions=5,\n        stop_loss=StopConfig(percent=5)\n    )\n)\n\n# Convert to dict/JSON\nprint(strategy.model_dump_json(indent=2))\n</code></pre>"},{"location":"architecture/","title":"UTSS Architecture &amp; Design Philosophy","text":"<p>This document explains the key architectural decisions and design philosophy behind the Universal Trading Strategy Schema (UTSS).</p>"},{"location":"architecture/#table-of-contents","title":"Table of Contents","text":"<ol> <li>The Problem We're Solving</li> <li>Core Philosophy</li> <li>Schema as Contract</li> <li>Type Hierarchy</li> <li>Composition Over Inheritance</li> <li>Progressive Disclosure</li> <li>Extensibility Layers</li> <li>Design Decisions</li> <li>Anti-Patterns Avoided</li> <li>Downstream Applications</li> </ol>"},{"location":"architecture/#the-problem-were-solving","title":"The Problem We're Solving","text":"<p>Trading strategies are typically expressed in one of three ways:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     THE FRAGMENTATION PROBLEM                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  1. IMPERATIVE CODE                                                         \u2502\n\u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                            \u2502\n\u2502     \u2502  def strategy(data):                    \u2502  - Tied to specific        \u2502\n\u2502     \u2502      rsi = ta.rsi(data.close, 14)       \u2502    language/platform       \u2502\n\u2502     \u2502      if rsi &lt; 30:                       \u2502  - Hard to validate        \u2502\n\u2502     \u2502          buy(0.1 * equity)              \u2502  - Can't analyze without   \u2502\n\u2502     \u2502      elif rsi &gt; 70:                     \u2502    executing               \u2502\n\u2502     \u2502          sell_all()                     \u2502                            \u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                            \u2502\n\u2502                                                                             \u2502\n\u2502  2. NATURAL LANGUAGE                                                        \u2502\n\u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                            \u2502\n\u2502     \u2502  \"Buy when RSI is oversold and          \u2502  - Ambiguous               \u2502\n\u2502     \u2502   sell when overbought\"                 \u2502  - No validation           \u2502\n\u2502     \u2502                                         \u2502  - Different interpretations\u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                            \u2502\n\u2502                                                                             \u2502\n\u2502  3. PLATFORM-SPECIFIC DSL                                                   \u2502\n\u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                            \u2502\n\u2502     \u2502  //@version=5                           \u2502  - Vendor lock-in          \u2502\n\u2502     \u2502  strategy(\"RSI\", ...)                   \u2502  - Limited expressiveness  \u2502\n\u2502     \u2502  longCondition = ta.rsi(close, 14) &lt; 30 \u2502  - Can't transfer between  \u2502\n\u2502     \u2502  if (longCondition)                     \u2502    platforms               \u2502\n\u2502     \u2502      strategy.entry(\"Long\", ...)        \u2502                            \u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                            \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>UTSS provides a fourth option: a declarative, portable schema.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          THE UTSS SOLUTION                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  UNIVERSAL SCHEMA (Declarative, Validated, Portable)                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  info: { id: rsi_reversal, version: \"1.0\" }                         \u2502   \u2502\n\u2502  \u2502  universe: { type: static, symbols: [AAPL] }                        \u2502   \u2502\n\u2502  \u2502  rules:                                                              \u2502   \u2502\n\u2502  \u2502    - when: RSI(14) &lt; 30  \u2192  buy 10%                                 \u2502   \u2502\n\u2502  \u2502    - when: RSI(14) &gt; 70  \u2192  sell all                                \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                              \u2502                                              \u2502\n\u2502           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                          \u2502\n\u2502           \u25bc                  \u25bc                  \u25bc                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502\n\u2502  \u2502  LLM Agents     \u2502 \u2502  Backtesting    \u2502 \u2502  Live Trading   \u2502               \u2502\n\u2502  \u2502  Natural lang \u2192 \u2502 \u2502  Historical     \u2502 \u2502  Real-time      \u2502               \u2502\n\u2502  \u2502  UTSS strategy  \u2502 \u2502  simulation     \u2502 \u2502  execution      \u2502               \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#core-philosophy","title":"Core Philosophy","text":""},{"location":"architecture/#1-define-what-not-how","title":"1. Define WHAT, Not HOW","text":"<p>UTSS is declarative, not imperative. The schema describes what the strategy does, not how to compute it.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      DECLARATIVE vs IMPERATIVE                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  IMPERATIVE (How)              DECLARATIVE (What)                          \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500             \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                          \u2502\n\u2502                                                                             \u2502\n\u2502  rsi_values = []               signal:                                     \u2502\n\u2502  for i in range(14, len(data)):  type: indicator                          \u2502\n\u2502      gain = ...                   indicator: RSI                           \u2502\n\u2502      loss = ...                   params: { period: 14 }                   \u2502\n\u2502      rs = gain / loss                                                      \u2502\n\u2502      rsi = 100 - (100/(1+rs))                                              \u2502\n\u2502      rsi_values.append(rsi)                                                \u2502\n\u2502                                                                             \u2502\n\u2502  \u25b2 Implementation detail       \u25b2 Intent only                              \u2502\n\u2502                                                                             \u2502\n\u2502  - Execution engine decides    - Schema doesn't care how                   \u2502\n\u2502    how to compute RSI            RSI is calculated                         \u2502\n\u2502  - Could be pandas-ta, TA-Lib, - Same schema works with                    \u2502\n\u2502    or custom implementation      any compliant engine                      \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#2-schema-as-source-of-truth","title":"2. Schema as Source of Truth","text":"<p>The strategy definition is complete in the schema. No external configuration needed.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      SELF-CONTAINED STRATEGY                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  strategy.yaml contains EVERYTHING needed:                                  \u2502\n\u2502                                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  info:        WHO created this, WHEN, WHY                           \u2502   \u2502\n\u2502  \u2502  universe:    WHAT to trade                                         \u2502   \u2502\n\u2502  \u2502  signals:     WHAT values to compute                                \u2502   \u2502\n\u2502  \u2502  conditions:  WHAT states to detect                                 \u2502   \u2502\n\u2502  \u2502  rules:       WHEN to act, WHAT action                              \u2502   \u2502\n\u2502  \u2502  constraints: WHAT limits to enforce                                \u2502   \u2502\n\u2502  \u2502  schedule:    WHEN to evaluate                                      \u2502   \u2502\n\u2502  \u2502  parameters:  WHAT can be optimized                                 \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  NOT in schema (execution engine concerns):                                 \u2502\n\u2502  - HOW to fetch market data                                                 \u2502\n\u2502  - HOW to calculate indicators                                              \u2502\n\u2502  - HOW to send orders to broker                                             \u2502\n\u2502  - HOW to handle slippage/commission                                        \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#3-llm-first-design","title":"3. LLM-First Design","text":"<p>The schema is designed to be easily generated by Large Language Models.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         LLM-FRIENDLY DESIGN                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  User: \"Create a strategy that buys when RSI is oversold\"                  \u2502\n\u2502                              \u2502                                              \u2502\n\u2502                              \u25bc                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502  \u2502                          LLM                                       \u2502     \u2502\n\u2502  \u2502                                                                    \u2502     \u2502\n\u2502  \u2502  Predictable patterns:                                             \u2502     \u2502\n\u2502  \u2502  \u2713 Every object has \"type\" field                                  \u2502     \u2502\n\u2502  \u2502  \u2713 Enums are readable (not codes)                                 \u2502     \u2502\n\u2502  \u2502  \u2713 Clear naming conventions                                        \u2502     \u2502\n\u2502  \u2502  \u2713 Reasonable defaults                                             \u2502     \u2502\n\u2502  \u2502  \u2713 Examples as few-shot prompts                                    \u2502     \u2502\n\u2502  \u2502                                                                    \u2502     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502                              \u2502                                              \u2502\n\u2502                              \u25bc                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502  \u2502  rules:                                                            \u2502     \u2502\n\u2502  \u2502    - name: Buy on oversold                                         \u2502     \u2502\n\u2502  \u2502      when:                                                         \u2502     \u2502\n\u2502  \u2502        type: comparison         \u25c4\u2500\u2500 Type discriminator             \u2502     \u2502\n\u2502  \u2502        left:                                                       \u2502     \u2502\n\u2502  \u2502          type: indicator        \u25c4\u2500\u2500 Type discriminator             \u2502     \u2502\n\u2502  \u2502          indicator: RSI         \u25c4\u2500\u2500 Human-readable enum            \u2502     \u2502\n\u2502  \u2502          params: { period: 14 }                                    \u2502     \u2502\n\u2502  \u2502        operator: \"&lt;\"            \u25c4\u2500\u2500 Intuitive operator             \u2502     \u2502\n\u2502  \u2502        right:                                                      \u2502     \u2502\n\u2502  \u2502          type: constant                                            \u2502     \u2502\n\u2502  \u2502          value: 30                                                 \u2502     \u2502\n\u2502  \u2502      then:                                                         \u2502     \u2502\n\u2502  \u2502        type: trade                                                 \u2502     \u2502\n\u2502  \u2502        direction: buy           \u25c4\u2500\u2500 Clear action                   \u2502     \u2502\n\u2502  \u2502        sizing:                                                     \u2502     \u2502\n\u2502  \u2502          type: percent_of_equity                                   \u2502     \u2502\n\u2502  \u2502          percent: 10                                               \u2502     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#schema-as-contract","title":"Schema as Contract","text":"<p>The UTSS schema is a contract between strategy authors and execution engines.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         SCHEMA AS CONTRACT                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                  \u2502\n\u2502                        \u2502  UTSS Schema    \u2502                                  \u2502\n\u2502                        \u2502  (Contract)     \u2502                                  \u2502\n\u2502                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                  \u2502\n\u2502                                 \u2502                                           \u2502\n\u2502           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u2502\n\u2502           \u2502                                           \u2502                    \u2502\n\u2502           \u25bc                                           \u25bc                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502  \u2502 Strategy Author \u2502                         \u2502 Execution Engine\u2502           \u2502\n\u2502  \u2502                 \u2502                         \u2502                 \u2502           \u2502\n\u2502  \u2502 Guarantees:     \u2502                         \u2502 Guarantees:     \u2502           \u2502\n\u2502  \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502                         \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2502           \u2502\n\u2502  \u2502 \u2022 Valid syntax  \u2502                         \u2502 \u2022 Correct RSI   \u2502           \u2502\n\u2502  \u2502 \u2022 Defined types \u2502                         \u2502 \u2022 Order routing \u2502           \u2502\n\u2502  \u2502 \u2022 Clear intent  \u2502                         \u2502 \u2022 Risk limits   \u2502           \u2502\n\u2502  \u2502                 \u2502                         \u2502 \u2022 Scheduling    \u2502           \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u2502                                                                             \u2502\n\u2502  The CONTRACT ensures:                                                      \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                       \u2502\n\u2502  \u2022 Any valid UTSS document works with any compliant engine                  \u2502\n\u2502  \u2022 Authors don't need to know implementation details                        \u2502\n\u2502  \u2022 Engines don't need to guess author's intent                              \u2502\n\u2502  \u2022 Strategies are portable across platforms                                 \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#type-hierarchy","title":"Type Hierarchy","text":"<p>UTSS uses a clear type hierarchy that mirrors the structure of trading decisions.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           TYPE HIERARCHY                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  Signal \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba Condition \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba Rule \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba Strategy              \u2502\n\u2502    \u2502                  \u2502                 \u2502                \u2502                  \u2502\n\u2502    \u2502                  \u2502                 \u2502                \u2502                  \u2502\n\u2502    \u25bc                  \u25bc                 \u25bc                \u25bc                  \u2502\n\u2502  number            boolean           action          complete              \u2502\n\u2502  (value)          (yes/no)         (do this)         (system)             \u2502\n\u2502                                                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  SIGNAL (Produces a Number)                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502   \u2502\n\u2502  \u2502  \u2502  price  \u2502 \u2502 indicator \u2502 \u2502 fundamental \u2502 \u2502 calendar \u2502           \u2502   \u2502\n\u2502  \u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502 \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502 \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502 \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502           \u2502   \u2502\n\u2502  \u2502  \u2502 close:  \u2502 \u2502 RSI(14):  \u2502 \u2502 PE_RATIO:   \u2502 \u2502 day_of_  \u2502           \u2502   \u2502\n\u2502  \u2502  \u2502   150.5 \u2502 \u2502     45.2  \u2502 \u2502      25.3   \u2502 \u2502 week: 3  \u2502           \u2502   \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502   \u2502\n\u2502  \u2502  \u2502  event  \u2502 \u2502 portfolio \u2502 \u2502 arithmetic  \u2502 \u2502   expr   \u2502           \u2502   \u2502\n\u2502  \u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502 \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502 \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502 \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502           \u2502   \u2502\n\u2502  \u2502  \u2502EARNINGS:\u2502 \u2502 unreal_pnl\u2502 \u2502 SMA20-SMA50 \u2502 \u2502 custom   \u2502           \u2502   \u2502\n\u2502  \u2502  \u2502    1    \u2502 \u2502    2.5%   \u2502 \u2502     -3.2    \u2502 \u2502 formula  \u2502           \u2502   \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  CONDITION (Produces True/False)                                            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502   \u2502\n\u2502  \u2502  \u2502  comparison  \u2502  \u2502    cross    \u2502  \u2502    range    \u2502                \u2502   \u2502\n\u2502  \u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                \u2502   \u2502\n\u2502  \u2502  \u2502 RSI &lt; 30     \u2502  \u2502 SMA50 cross \u2502  \u2502 20&lt;RSI&lt;80  \u2502                \u2502   \u2502\n\u2502  \u2502  \u2502   = true     \u2502  \u2502 above SMA200\u2502  \u2502   = true   \u2502                \u2502   \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                \u2502   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502   \u2502\n\u2502  \u2502  \u2502   and/or     \u2502  \u2502  temporal   \u2502  \u2502  sequence   \u2502                \u2502   \u2502\n\u2502  \u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                \u2502   \u2502\n\u2502  \u2502  \u2502 A AND B      \u2502  \u2502 A for 3bars \u2502  \u2502 A then B   \u2502                \u2502   \u2502\n\u2502  \u2502  \u2502   = true     \u2502  \u2502   = true    \u2502  \u2502   = true   \u2502                \u2502   \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                \u2502   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  ACTION (What to Do)                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502   \u2502\n\u2502  \u2502  \u2502   trade   \u2502  \u2502  rebalance  \u2502  \u2502    alert    \u2502  \u2502   hold   \u2502    \u2502   \u2502\n\u2502  \u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502    \u2502   \u2502\n\u2502  \u2502  \u2502 buy/sell  \u2502  \u2502 adjust to   \u2502  \u2502 send        \u2502  \u2502 do       \u2502    \u2502   \u2502\n\u2502  \u2502  \u2502 short/    \u2502  \u2502 target      \u2502  \u2502 notification\u2502  \u2502 nothing  \u2502    \u2502   \u2502\n\u2502  \u2502  \u2502 cover     \u2502  \u2502 weights     \u2502  \u2502             \u2502  \u2502          \u2502    \u2502   \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#composition-over-inheritance","title":"Composition Over Inheritance","text":"<p>UTSS favors composition (combining small pieces) over inheritance (hierarchies).</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     COMPOSITION vs INHERITANCE                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  INHERITANCE (Avoided)                 COMPOSITION (Used)                  \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                   \u2502\n\u2502                                                                             \u2502\n\u2502  class TrendStrategy:                  signals:                             \u2502\n\u2502    def calculate(self): ...              sma_fast: SMA(20)                  \u2502\n\u2502                                          sma_slow: SMA(50)                  \u2502\n\u2502  class MACrossover(TrendStrategy):                                          \u2502\n\u2502    def calculate(self):                conditions:                          \u2502\n\u2502      super().calculate()                 golden_cross:                      \u2502\n\u2502      # Override behavior                   sma_fast crosses above sma_slow \u2502\n\u2502                                                                             \u2502\n\u2502  class RSIMACross(MACrossover):        rules:                               \u2502\n\u2502    # Fragile base class problem          - when: golden_cross              \u2502\n\u2502    # Tight coupling                        then: buy                        \u2502\n\u2502    # Hard to understand                                                     \u2502\n\u2502                                                                             \u2502\n\u2502  Problems:                             Benefits:                            \u2502\n\u2502  \u2717 Hard to mix unrelated ideas         \u2713 Mix any signals freely            \u2502\n\u2502  \u2717 Inheritance hierarchy grows         \u2713 No hierarchy to maintain          \u2502\n\u2502  \u2717 Changes break subclasses            \u2713 Components are independent        \u2502\n\u2502  \u2717 Must understand all parents         \u2713 Each piece is self-contained      \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#reference-system-ref","title":"Reference System ($ref)","text":"<p>Components are reused through references, not inheritance.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          REFERENCE SYSTEM                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  Define once:                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  signals:                                                           \u2502   \u2502\n\u2502  \u2502    rsi_14:                           \u25c4\u2500\u2500 Named definition           \u2502   \u2502\n\u2502  \u2502      type: indicator                                                \u2502   \u2502\n\u2502  \u2502      indicator: RSI                                                 \u2502   \u2502\n\u2502  \u2502      params: { period: 14 }                                         \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  Reference anywhere:                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  rules:                                                             \u2502   \u2502\n\u2502  \u2502    - when:                                                          \u2502   \u2502\n\u2502  \u2502        type: comparison                                             \u2502   \u2502\n\u2502  \u2502        left: { $ref: \"#/signals/rsi_14\" }  \u25c4\u2500\u2500 Reference            \u2502   \u2502\n\u2502  \u2502        operator: \"&lt;\"                                                \u2502   \u2502\n\u2502  \u2502        right: { type: constant, value: 30 }                         \u2502   \u2502\n\u2502  \u2502      then: ...                                                      \u2502   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2502    - when:                                                          \u2502   \u2502\n\u2502  \u2502        type: comparison                                             \u2502   \u2502\n\u2502  \u2502        left: { $ref: \"#/signals/rsi_14\" }  \u25c4\u2500\u2500 Same reference       \u2502   \u2502\n\u2502  \u2502        operator: \"&gt;\"                                                \u2502   \u2502\n\u2502  \u2502        right: { type: constant, value: 70 }                         \u2502   \u2502\n\u2502  \u2502      then: ...                                                      \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  Benefits:                                                                  \u2502\n\u2502  \u2022 Single source of truth (change once, updates everywhere)                 \u2502\n\u2502  \u2022 Readable (named components convey intent)                                \u2502\n\u2502  \u2022 Validated (references are checked)                                       \u2502\n\u2502  \u2022 Composable (combine any components)                                      \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#progressive-disclosure","title":"Progressive Disclosure","text":"<p>Simple strategies are simple. Complexity is opt-in.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       PROGRESSIVE DISCLOSURE                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  LEVEL 1: Minimal Strategy (5 lines)                                        \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  info: { id: buy_hold, name: Buy and Hold, version: \"1.0\" }        \u2502   \u2502\n\u2502  \u2502  universe: { type: static, symbols: [SPY] }                         \u2502   \u2502\n\u2502  \u2502  rules:                                                             \u2502   \u2502\n\u2502  \u2502    - name: Buy                                                      \u2502   \u2502\n\u2502  \u2502      when: { type: always }                                         \u2502   \u2502\n\u2502  \u2502      then: { type: trade, direction: buy,                           \u2502   \u2502\n\u2502  \u2502              sizing: { type: percent_of_equity, percent: 100 } }    \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  LEVEL 2: Add Risk Management                                               \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  ...                                                                \u2502   \u2502\n\u2502  \u2502  constraints:                          \u25c4\u2500\u2500 Add risk limits          \u2502   \u2502\n\u2502  \u2502    max_positions: 5                                                 \u2502   \u2502\n\u2502  \u2502    stop_loss: { percent: 5 }                                        \u2502   \u2502\n\u2502  \u2502    max_drawdown: 20                                                 \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  LEVEL 3: Add Reusable Components                                           \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  signals:                              \u25c4\u2500\u2500 Define reusable signals  \u2502   \u2502\n\u2502  \u2502    rsi: { type: indicator, indicator: RSI, params: { period: 14 } } \u2502   \u2502\n\u2502  \u2502  conditions:                           \u25c4\u2500\u2500 Define reusable conditions\u2502  \u2502\n\u2502  \u2502    oversold: { type: comparison, left: { $ref: \"#/signals/rsi\" },   \u2502   \u2502\n\u2502  \u2502               operator: \"&lt;\", right: { type: constant, value: 30 } } \u2502   \u2502\n\u2502  \u2502  rules:                                                             \u2502   \u2502\n\u2502  \u2502    - when: { $ref: \"#/conditions/oversold\" }  \u25c4\u2500\u2500 Use references    \u2502   \u2502\n\u2502  \u2502      then: ...                                                      \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  LEVEL 4: Add Parameter Optimization                                        \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  parameters:                           \u25c4\u2500\u2500 Define optimizable params\u2502   \u2502\n\u2502  \u2502    rsi_period: { type: integer, default: 14, min: 5, max: 30 }     \u2502   \u2502\n\u2502  \u2502    threshold: { type: number, default: 30, min: 20, max: 40 }      \u2502   \u2502\n\u2502  \u2502  signals:                                                           \u2502   \u2502\n\u2502  \u2502    rsi:                                                             \u2502   \u2502\n\u2502  \u2502      type: indicator                                                \u2502   \u2502\n\u2502  \u2502      indicator: RSI                                                 \u2502   \u2502\n\u2502  \u2502      params: { period: { $param: rsi_period } }  \u25c4\u2500\u2500 Param reference\u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  LEVEL 5: Advanced Features                                                 \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  \u2022 Sequence conditions (A then B within 5 bars)                     \u2502   \u2502\n\u2502  \u2502  \u2022 Portfolio signals (unrealized_pnl, days_in_position)             \u2502   \u2502\n\u2502  \u2502  \u2022 Conditional sizing (different size based on regime)              \u2502   \u2502\n\u2502  \u2502  \u2022 External signals (ML model predictions via webhook)              \u2502   \u2502\n\u2502  \u2502  \u2022 Expression language (custom formulas)                            \u2502   \u2502\n\u2502  \u2502  \u2022 Platform extensions (x-backtest, x-live)                         \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#extensibility-layers","title":"Extensibility Layers","text":"<p>UTSS has four layers of extensibility, each with different tradeoffs.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        EXTENSIBILITY LAYERS                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  LAYER 4: x-extensions (platform-specific, ignored by validators)    \u2502 \u2502\n\u2502  \u2502                                                                       \u2502 \u2502\n\u2502  \u2502    x-backtest: { slippage: 0.1%, commission: 0.05% }                 \u2502 \u2502\n\u2502  \u2502    x-live: { broker: sbi, account: margin }                          \u2502 \u2502\n\u2502  \u2502    x-freqtrade: { stake_amount: 100, dry_run: true }                 \u2502 \u2502\n\u2502  \u2502                                                                       \u2502 \u2502\n\u2502  \u2502    \u2713 Zero portability (platform-specific)                            \u2502 \u2502\n\u2502  \u2502    \u2713 Maximum flexibility                                              \u2502 \u2502\n\u2502  \u2502    \u2713 Doesn't break validation                                         \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  LAYER 3: External Signals (runtime-resolved)                        \u2502 \u2502\n\u2502  \u2502                                                                       \u2502 \u2502\n\u2502  \u2502    signals:                                                           \u2502 \u2502\n\u2502  \u2502      ml_prediction:                                                   \u2502 \u2502\n\u2502  \u2502        type: external                                                 \u2502 \u2502\n\u2502  \u2502        source: webhook                                                \u2502 \u2502\n\u2502  \u2502        url: \"https://api.mymodel.com/predict\"                        \u2502 \u2502\n\u2502  \u2502        default: 0.5                                                   \u2502 \u2502\n\u2502  \u2502                                                                       \u2502 \u2502\n\u2502  \u2502    \u2713 Low portability (requires external service)                     \u2502 \u2502\n\u2502  \u2502    \u2713 High flexibility (any value from any source)                    \u2502 \u2502\n\u2502  \u2502    \u2713 Validated structure, runtime value                               \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  LAYER 2: Expression Language (parsed, semi-portable)                \u2502 \u2502\n\u2502  \u2502                                                                       \u2502 \u2502\n\u2502  \u2502    signals:                                                           \u2502 \u2502\n\u2502  \u2502      custom_zscore:                                                   \u2502 \u2502\n\u2502  \u2502        type: expr                                                     \u2502 \u2502\n\u2502  \u2502        formula: \"(close - SMA(close, 20)) / STDDEV(close, 20)\"       \u2502 \u2502\n\u2502  \u2502                                                                       \u2502 \u2502\n\u2502  \u2502    \u2713 Medium portability (if engine supports expr)                    \u2502 \u2502\n\u2502  \u2502    \u2713 Medium flexibility (must follow expr syntax)                    \u2502 \u2502\n\u2502  \u2502    \u2713 Validated syntax, interpreted execution                          \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  LAYER 1: Strict Core (fully validated, fully portable)              \u2502 \u2502\n\u2502  \u2502                                                                       \u2502 \u2502\n\u2502  \u2502    signals:                                                           \u2502 \u2502\n\u2502  \u2502      rsi_14:                                                          \u2502 \u2502\n\u2502  \u2502        type: indicator                                                \u2502 \u2502\n\u2502  \u2502        indicator: RSI          \u25c4\u2500\u2500 Known enum                        \u2502 \u2502\n\u2502  \u2502        params: { period: 14 }  \u25c4\u2500\u2500 Validated params                  \u2502 \u2502\n\u2502  \u2502                                                                       \u2502 \u2502\n\u2502  \u2502    \u2713 Full portability (all engines support core)                     \u2502 \u2502\n\u2502  \u2502    \u2713 Limited flexibility (only predefined types)                     \u2502 \u2502\n\u2502  \u2502    \u2713 Full validation, guaranteed execution                            \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                             \u2502\n\u2502  Choose the layer based on your needs:                                      \u2502\n\u2502  \u2022 Need maximum portability? \u2192 Use Layer 1 (Strict Core)                   \u2502\n\u2502  \u2022 Need custom calculations? \u2192 Use Layer 2 (Expressions)                   \u2502\n\u2502  \u2022 Need external data/ML? \u2192 Use Layer 3 (External Signals)                 \u2502\n\u2502  \u2022 Need platform features? \u2192 Use Layer 4 (x-extensions)                    \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#design-decisions","title":"Design Decisions","text":""},{"location":"architecture/#why-json-schema-not-custom-dsl","title":"Why JSON Schema (not custom DSL)?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      WHY JSON SCHEMA?                                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  Option A: Custom DSL          Option B: JSON Schema (Chosen)              \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500          \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500               \u2502\n\u2502                                                                             \u2502\n\u2502  strategy MyStrategy:          info:                                        \u2502\n\u2502    universe = [AAPL]             id: my_strategy                            \u2502\n\u2502    when RSI(14) &lt; 30:          universe:                                    \u2502\n\u2502      buy 10%                     type: static                               \u2502\n\u2502                                  symbols: [AAPL]                            \u2502\n\u2502                                rules:                                       \u2502\n\u2502                                  - when: { RSI(14) &lt; 30 }                   \u2502\n\u2502                                    then: { buy 10% }                        \u2502\n\u2502                                                                             \u2502\n\u2502  \u2717 Need to build parser        \u2713 Standard tooling exists                   \u2502\n\u2502  \u2717 Need to build validator     \u2713 Validators in every language              \u2502\n\u2502  \u2717 Documentation burden        \u2713 JSON Schema is well-documented            \u2502\n\u2502  \u2717 Learning curve              \u2713 YAML/JSON are universal                   \u2502\n\u2502  \u2717 IDE support from scratch    \u2713 IDE support built-in                      \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#why-type-discriminators","title":"Why Type Discriminators?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      WHY TYPE DISCRIMINATORS?                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  Without discriminator:        With discriminator (chosen):                 \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500       \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                 \u2502\n\u2502                                                                             \u2502\n\u2502  signal:                       signal:                                      \u2502\n\u2502    indicator: RSI                type: indicator    \u25c4\u2500\u2500 Clear type         \u2502\n\u2502    period: 14                    indicator: RSI                             \u2502\n\u2502    # Is this a fundamental?      params: { period: 14 }                    \u2502\n\u2502    # A portfolio signal?                                                    \u2502\n\u2502    # Parser must guess...      # Parser knows exactly                      \u2502\n\u2502                                # what this is                               \u2502\n\u2502                                                                             \u2502\n\u2502  Benefits of discriminator:                                                 \u2502\n\u2502  \u2022 Unambiguous parsing (LLMs don't guess)                                   \u2502\n\u2502  \u2022 Clear validation (each type has own rules)                               \u2502\n\u2502  \u2022 Self-documenting (type tells you what it is)                             \u2502\n\u2502  \u2022 Extensible (new types don't conflict)                                    \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#why-separate-signals-and-conditions","title":"Why Separate Signals and Conditions?","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  WHY SEPARATE SIGNALS AND CONDITIONS?                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  Combined (rejected):           Separated (chosen):                         \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500           \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                        \u2502\n\u2502                                                                             \u2502\n\u2502  rule:                          signals:                                    \u2502\n\u2502    when: RSI(14) &lt; 30             rsi_14: RSI(14)     \u25c4\u2500\u2500 Number           \u2502\n\u2502    # Is \"RSI(14) &lt; 30\" a                                                    \u2502\n\u2502    # signal or condition?       conditions:                                 \u2502\n\u2502    # Hard to reuse pieces         oversold:                                 \u2502\n\u2502                                     rsi_14 &lt; 30      \u25c4\u2500\u2500 Boolean           \u2502\n\u2502                                                                             \u2502\n\u2502  Benefits of separation:                                                    \u2502\n\u2502  \u2022 Clear semantics (signals=numbers, conditions=booleans)                   \u2502\n\u2502  \u2022 Better reuse (same signal in multiple conditions)                        \u2502\n\u2502  \u2022 Easier debugging (inspect signals and conditions separately)             \u2502\n\u2502  \u2022 Cleaner composition (compose signals, then conditions, then rules)       \u2502\n\u2502                                                                             \u2502\n\u2502  Example of reuse:                                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  signals:                                                           \u2502   \u2502\n\u2502  \u2502    rsi: RSI(14)                   \u25c4\u2500\u2500 Define once                   \u2502   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2502  conditions:                                                        \u2502   \u2502\n\u2502  \u2502    oversold: rsi &lt; 30             \u25c4\u2500\u2500 Use in multiple conditions   \u2502   \u2502\n\u2502  \u2502    overbought: rsi &gt; 70                                             \u2502   \u2502\n\u2502  \u2502    neutral: 40 &lt; rsi &lt; 60                                           \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#anti-patterns-avoided","title":"Anti-Patterns Avoided","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        ANTI-PATTERNS AVOIDED                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  1. STRING-BASED LOGIC                                                      \u2502\n\u2502     \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                   \u2502\n\u2502     \u2717 when: \"RSI(close, 14) &lt; 30 and MACD(12,26,9).hist &gt; 0\"              \u2502\n\u2502       \u2022 Hard to validate (arbitrary string)                                 \u2502\n\u2502       \u2022 Hard to analyze (must parse string)                                 \u2502\n\u2502       \u2022 Security risk (code injection)                                      \u2502\n\u2502                                                                             \u2502\n\u2502     \u2713 when:                                                                \u2502\n\u2502         type: and                                                           \u2502\n\u2502         conditions:                                                         \u2502\n\u2502           - type: comparison                                                \u2502\n\u2502             left: { type: indicator, indicator: RSI, params: {period: 14} } \u2502\n\u2502             operator: \"&lt;\"                                                   \u2502\n\u2502             right: { type: constant, value: 30 }                            \u2502\n\u2502           - type: comparison                                                \u2502\n\u2502             left: { type: indicator, indicator: MACD_HIST, ... }            \u2502\n\u2502             operator: \"&gt;\"                                                   \u2502\n\u2502             right: { type: constant, value: 0 }                             \u2502\n\u2502                                                                             \u2502\n\u2502  2. IMPLICIT STATE                                                          \u2502\n\u2502     \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                      \u2502\n\u2502     \u2717 when: in_position and profit &gt; 5%                                    \u2502\n\u2502       \u2022 Where does \"in_position\" come from?                                 \u2502\n\u2502       \u2022 What is \"profit\" relative to?                                       \u2502\n\u2502                                                                             \u2502\n\u2502     \u2713 when:                                                                \u2502\n\u2502         type: and                                                           \u2502\n\u2502         conditions:                                                         \u2502\n\u2502           - type: comparison                                                \u2502\n\u2502             left: { type: portfolio, field: position_qty }  \u25c4\u2500\u2500 Explicit   \u2502\n\u2502             operator: \"&gt;\"                                                   \u2502\n\u2502             right: { type: constant, value: 0 }                             \u2502\n\u2502           - type: comparison                                                \u2502\n\u2502             left: { type: portfolio, field: unrealized_pnl_pct } \u25c4\u2500\u2500 Clear \u2502\n\u2502             operator: \"&gt;\"                                                   \u2502\n\u2502             right: { type: constant, value: 5 }                             \u2502\n\u2502                                                                             \u2502\n\u2502  3. MAGIC NUMBERS                                                           \u2502\n\u2502     \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                      \u2502\n\u2502     \u2717 when: RSI(14) &lt; 30                                                   \u2502\n\u2502       \u2022 Why 14? Why 30? Hard to optimize                                    \u2502\n\u2502                                                                             \u2502\n\u2502     \u2713 parameters:                                                          \u2502\n\u2502         rsi_period: { type: integer, default: 14, min: 5, max: 30 }        \u2502\n\u2502         oversold: { type: integer, default: 30, min: 20, max: 40 }         \u2502\n\u2502       signals:                                                              \u2502\n\u2502         rsi: { indicator: RSI, params: { period: { $param: rsi_period } } } \u2502\n\u2502       when:                                                                 \u2502\n\u2502         left: { $ref: \"#/signals/rsi\" }                                     \u2502\n\u2502         operator: \"&lt;\"                                                       \u2502\n\u2502         right: { $param: oversold }                                         \u2502\n\u2502                                                                             \u2502\n\u2502  4. PREMATURE ABSTRACTION                                                   \u2502\n\u2502     \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                               \u2502\n\u2502     \u2717 Deeply nested inheritance hierarchies                                \u2502\n\u2502     \u2717 Abstract base strategies with override points                        \u2502\n\u2502     \u2717 Plugin systems for everything                                         \u2502\n\u2502                                                                             \u2502\n\u2502     \u2713 Flat structure with references                                       \u2502\n\u2502     \u2713 Compose small, focused pieces                                         \u2502\n\u2502     \u2713 Extensions only where truly needed                                    \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#downstream-applications","title":"Downstream Applications","text":"<p>UTSS is designed to be consumed by various applications.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      DOWNSTREAM APPLICATIONS                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                \u2502\n\u2502                         \u2502  UTSS Strategy  \u2502                                \u2502\n\u2502                         \u2502    Document     \u2502                                \u2502\n\u2502                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                \u2502\n\u2502                                  \u2502                                          \u2502\n\u2502         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502\n\u2502         \u2502              \u2502         \u2502         \u2502              \u2502                \u2502\n\u2502         \u25bc              \u25bc         \u25bc         \u25bc              \u25bc                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502  \u2502 LLM Agents  \u2502 \u2502Backtest  \u2502 \u2502Param\u2502 \u2502   Live   \u2502 \u2502 Strategy \u2502           \u2502\n\u2502  \u2502             \u2502 \u2502 Engines  \u2502 \u2502Optim\u2502 \u2502 Trading  \u2502 \u2502Marketplace\u2502          \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u2502                                                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  LLM AGENTS                                                                 \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  User: \"Create a momentum strategy for Japanese stocks\"            \u2502   \u2502\n\u2502  \u2502                              \u2502                                      \u2502   \u2502\n\u2502  \u2502                              \u25bc                                      \u2502   \u2502\n\u2502  \u2502  LLM generates valid UTSS YAML:                                     \u2502   \u2502\n\u2502  \u2502  \u2022 Uses schema for structured output                                \u2502   \u2502\n\u2502  \u2502  \u2022 Examples as few-shot prompts                                     \u2502   \u2502\n\u2502  \u2502  \u2022 Validation catches errors                                        \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  BACKTESTING ENGINES                                                        \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  Engine responsibilities:                                           \u2502   \u2502\n\u2502  \u2502  \u2022 Parse UTSS document                                              \u2502   \u2502\n\u2502  \u2502  \u2022 Calculate indicators (RSI, SMA, etc.)                            \u2502   \u2502\n\u2502  \u2502  \u2022 Evaluate conditions on each bar                                  \u2502   \u2502\n\u2502  \u2502  \u2022 Execute actions (simulated fills)                                \u2502   \u2502\n\u2502  \u2502  \u2022 Track portfolio state                                            \u2502   \u2502\n\u2502  \u2502  \u2022 Generate performance metrics                                     \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  PARAMETER OPTIMIZATION                                                     \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  parameters:                                                        \u2502   \u2502\n\u2502  \u2502    rsi_period: { min: 5, max: 30, step: 1 }                        \u2502   \u2502\n\u2502  \u2502    threshold: { min: 20, max: 40 }                                  \u2502   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2502  Optimizer:                                                         \u2502   \u2502\n\u2502  \u2502  \u2022 Extract parameter ranges from schema                             \u2502   \u2502\n\u2502  \u2502  \u2022 Grid search / genetic algorithm / Bayesian                       \u2502   \u2502\n\u2502  \u2502  \u2022 Generate strategy variants                                       \u2502   \u2502\n\u2502  \u2502  \u2022 Run backtests                                                    \u2502   \u2502\n\u2502  \u2502  \u2022 Find optimal parameters                                          \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  LIVE TRADING                                                               \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  Same strategy document, different execution:                       \u2502   \u2502\n\u2502  \u2502  \u2022 Real-time market data instead of historical                      \u2502   \u2502\n\u2502  \u2502  \u2022 Real broker API instead of simulated fills                       \u2502   \u2502\n\u2502  \u2502  \u2022 Same logic, different environment                                \u2502   \u2502\n\u2502  \u2502                                                                     \u2502   \u2502\n\u2502  \u2502  x-live:                                                            \u2502   \u2502\n\u2502  \u2502    broker: sbi                                                      \u2502   \u2502\n\u2502  \u2502    account_type: margin                                             \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#summary","title":"Summary","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         UTSS DESIGN SUMMARY                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  CORE PRINCIPLES:                                                           \u2502\n\u2502  \u2022 Declarative (WHAT, not HOW)                                             \u2502\n\u2502  \u2022 Self-contained (complete strategy in one document)                       \u2502\n\u2502  \u2022 LLM-friendly (predictable patterns, clear types)                         \u2502\n\u2502  \u2022 Portable (works with any compliant engine)                               \u2502\n\u2502                                                                             \u2502\n\u2502  TYPE HIERARCHY:                                                            \u2502\n\u2502  \u2022 Signal \u2192 number (RSI = 45.2)                                            \u2502\n\u2502  \u2022 Condition \u2192 boolean (RSI &lt; 30 = true)                                   \u2502\n\u2502  \u2022 Rule \u2192 when/then (if oversold, buy)                                     \u2502\n\u2502  \u2022 Strategy \u2192 complete system                                               \u2502\n\u2502                                                                             \u2502\n\u2502  COMPOSITION:                                                               \u2502\n\u2502  \u2022 Define signals and conditions once                                       \u2502\n\u2502  \u2022 Reference with $ref anywhere                                             \u2502\n\u2502  \u2022 No inheritance, just composition                                         \u2502\n\u2502                                                                             \u2502\n\u2502  EXTENSIBILITY:                                                             \u2502\n\u2502  \u2022 Layer 1: Strict core (portable)                                         \u2502\n\u2502  \u2022 Layer 2: Expressions (semi-portable)                                     \u2502\n\u2502  \u2022 Layer 3: External signals (runtime)                                      \u2502\n\u2502  \u2022 Layer 4: x-extensions (platform-specific)                                \u2502\n\u2502                                                                             \u2502\n\u2502  PROGRESSIVE DISCLOSURE:                                                    \u2502\n\u2502  \u2022 Minimal strategy: 5 lines                                                \u2502\n\u2502  \u2022 Full strategy: 100+ lines with all features                              \u2502\n\u2502  \u2022 Complexity is opt-in                                                     \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to the Universal Trading Strategy Schema.</p>"},{"location":"changelog/#100-2024-01","title":"[1.0.0] - 2024-01","text":""},{"location":"changelog/#overview","title":"Overview","text":"<p>UTSS v1.0 is a clean, minimal design with 6 condition types and an <code>expr</code> escape hatch for complex patterns.</p>"},{"location":"changelog/#design-philosophy","title":"Design Philosophy","text":"<ul> <li>Minimal Primitives: Only 6 condition types (comparison, and, or, not, expr, always)</li> <li>expr for Complexity: Crossovers, ranges, temporal patterns via formula expressions</li> <li>No Sugar Bloat: Avoids unbounded type additions</li> <li>LLM-Friendly: Predictable structure, clear type discriminators</li> </ul>"},{"location":"changelog/#signal-types","title":"Signal Types","text":"Type Description <code>price</code> Raw OHLCV data <code>indicator</code> 50+ technical indicators (SMA, RSI, MACD, etc.) <code>fundamental</code> 30+ company metrics (PE_RATIO, ROE, etc.) <code>calendar</code> Date patterns (day_of_week, is_month_end, etc.) <code>event</code> Market events (EARNINGS_RELEASE, DIVIDEND_EX_DATE, etc.) <code>portfolio</code> Position state (unrealized_pnl, days_in_position, etc.) <code>relative</code> Benchmark comparisons (ratio, beta, correlation) <code>constant</code> Fixed numeric values <code>arithmetic</code> Math operations (add, subtract, multiply, etc.) <code>expr</code> Custom formula expressions <code>external</code> Runtime signals (webhook, file, provider)"},{"location":"changelog/#condition-types-minimal-primitives","title":"Condition Types (Minimal Primitives)","text":"Type Description Example <code>comparison</code> Compare signals <code>RSI &lt; 30</code> <code>and</code> All must be true <code>RSI &lt; 30 AND MACD &gt; 0</code> <code>or</code> Any must be true <code>Monday OR Friday</code> <code>not</code> Negate condition <code>NOT in_position</code> <code>expr</code> Formula expression <code>\"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"</code> <code>always</code> Unconditional For scheduled rebalancing <p>Complex patterns (crossovers, ranges, temporal, sequences) are expressed via <code>expr</code> formulas. See <code>patterns/</code> directory for reusable formula library.</p>"},{"location":"changelog/#action-types","title":"Action Types","text":"<ul> <li>TradeAction - Buy, sell, short, cover with various sizing methods</li> <li>RebalanceAction - Equal weight, risk parity, target weights</li> <li>AlertAction - Notifications via log, webhook, email, telegram, etc.</li> <li>HoldAction - Explicitly do nothing</li> </ul>"},{"location":"changelog/#sizing-types","title":"Sizing Types","text":"<ul> <li><code>fixed_amount</code>, <code>percent_of_equity</code>, <code>percent_of_position</code></li> <li><code>risk_based</code>, <code>kelly</code>, <code>volatility_adjusted</code>, <code>conditional</code></li> </ul>"},{"location":"changelog/#universe-types","title":"Universe Types","text":"<ul> <li><code>static</code> - Fixed symbol list</li> <li><code>index</code> - Index members with filters/ranking</li> <li><code>screener</code> - Dynamic screening</li> <li><code>dual</code> - Separate long/short universes</li> </ul>"},{"location":"changelog/#other-features","title":"Other Features","text":"<ul> <li>Parameters - Optimizable values with <code>$param</code> references</li> <li>Constraints - Stop loss, take profit, trailing stop, position limits</li> <li>Schedule - Evaluation frequency, market hours, timezone</li> <li>Execution - Slippage/commission models as strategy design decisions</li> <li>Extensibility - <code>custom:</code>, <code>talib:</code>, <code>platform:</code> prefixes for extensions</li> </ul>"},{"location":"changelog/#versioning","title":"Versioning","text":"<p>This project uses Semantic Versioning:</p> <ul> <li>MAJOR: Incompatible schema changes</li> <li>MINOR: New features, backward compatible</li> <li>PATCH: Bug fixes, backward compatible</li> </ul> <p>Schema version is specified in strategy documents:</p> <pre><code>$schema: https://obichan117.github.io/universal-trading-strategy-schema/schema/v1/strategy.json\n</code></pre>"},{"location":"comparison/","title":"Comparison with Existing Approaches","text":"<p>This document compares UTSS with existing strategy representation approaches used in popular backtesting libraries and trading platforms.</p>"},{"location":"comparison/#overview","title":"Overview","text":"Approach Examples Portability Validation LLM-Friendly Complexity Imperative Code Backtrader, Zipline, bt Low None Poor High Platform DSL Pine Script, MQL, EasyLanguage Very Low Partial Poor Medium Config + Code Freqtrade, Jesse Low Partial Poor Medium Visual Builder TradingView Strategy Tester Very Low Good N/A Low UTSS This project High Full Excellent Low-High"},{"location":"comparison/#detailed-comparisons","title":"Detailed Comparisons","text":""},{"location":"comparison/#1-imperative-code-libraries","title":"1. Imperative Code Libraries","text":"<p>Examples: Backtrader, Zipline, bt, VectorBT, QuantLib</p>"},{"location":"comparison/#how-they-work","title":"How They Work","text":"<p>Strategies are written as Python/C++ classes with callbacks:</p> <pre><code># Backtrader Example\nclass RSIStrategy(bt.Strategy):\n    params = (('period', 14), ('oversold', 30), ('overbought', 70))\n\n    def __init__(self):\n        self.rsi = bt.indicators.RSI(self.data.close, period=self.params.period)\n\n    def next(self):\n        if not self.position:\n            if self.rsi &lt; self.params.oversold:\n                self.buy(size=self.broker.getcash() * 0.1 / self.data.close[0])\n        else:\n            if self.rsi &gt; self.params.overbought:\n                self.close()\n</code></pre> <pre><code># Zipline Example\ndef initialize(context):\n    context.asset = symbol('AAPL')\n    context.rsi_period = 14\n\ndef handle_data(context, data):\n    prices = data.history(context.asset, 'price', context.rsi_period + 1, '1d')\n    rsi = talib.RSI(prices.values, context.rsi_period)[-1]\n\n    if rsi &lt; 30:\n        order_target_percent(context.asset, 0.1)\n    elif rsi &gt; 70:\n        order_target_percent(context.asset, 0)\n</code></pre>"},{"location":"comparison/#comparison-with-utss","title":"Comparison with UTSS","text":"Aspect Imperative Code UTSS Portability Tied to specific library Works with any compliant engine Validation Runtime errors only Schema validation before execution Readability Requires understanding Python/library Self-documenting YAML LLM Generation Prone to syntax errors, API misuse Structured output, easy validation Testability Requires mocking broker, data Logic is pure data, easily testable Debugging Step through code Inspect signals/conditions directly Optimization Custom loop required Parameters extracted from schema Flexibility Unlimited (it's code) Bounded by schema (extensible)"},{"location":"comparison/#when-to-use-what","title":"When to Use What","text":"<ul> <li>Use Imperative Code when:</li> <li>You need custom indicators not in UTSS</li> <li>Complex position management (scaling in/out)</li> <li>Integration with specific broker APIs</li> <li> <p>Real-time tick-by-tick logic</p> </li> <li> <p>Use UTSS when:</p> </li> <li>Strategy can be expressed declaratively</li> <li>Need portability across platforms</li> <li>LLM-generated strategies</li> <li>Sharing/distributing strategies</li> <li>Parameter optimization</li> </ul>"},{"location":"comparison/#2-platform-specific-dsls","title":"2. Platform-Specific DSLs","text":"<p>Examples: TradingView Pine Script, MetaTrader MQL4/5, TradeStation EasyLanguage</p>"},{"location":"comparison/#how-they-work_1","title":"How They Work","text":"<pre><code>// TradingView Pine Script\n//@version=5\nstrategy(\"RSI Strategy\", overlay=true)\n\nlength = input(14, \"RSI Length\")\noversold = input(30, \"Oversold\")\noverbought = input(70, \"Overbought\")\n\nrsi = ta.rsi(close, length)\n\nif (rsi &lt; oversold)\n    strategy.entry(\"Buy\", strategy.long, qty=strategy.equity * 0.1 / close)\n\nif (rsi &gt; overbought)\n    strategy.close(\"Buy\")\n</code></pre> <pre><code>// MetaTrader MQL5\nint OnInit() {\n    rsiHandle = iRSI(_Symbol, PERIOD_D1, 14, PRICE_CLOSE);\n    return INIT_SUCCEEDED;\n}\n\nvoid OnTick() {\n    double rsi[];\n    CopyBuffer(rsiHandle, 0, 0, 1, rsi);\n\n    if (rsi[0] &lt; 30 &amp;&amp; PositionSelect(_Symbol) == false) {\n        double lots = AccountInfoDouble(ACCOUNT_EQUITY) * 0.1 / SymbolInfoDouble(_Symbol, SYMBOL_ASK);\n        trade.Buy(lots, _Symbol);\n    }\n    else if (rsi[0] &gt; 70 &amp;&amp; PositionSelect(_Symbol)) {\n        trade.PositionClose(_Symbol);\n    }\n}\n</code></pre>"},{"location":"comparison/#comparison-with-utss_1","title":"Comparison with UTSS","text":"Aspect Platform DSL UTSS Lock-in Complete (Pine = TradingView only) None Learning Curve New language per platform YAML + schema Execution Platform handles everything Bring your own engine Backtesting Built into platform Separate concern Data Access Platform data only Any data source Indicators Platform's library Engine's library Sharing Within platform Universal"},{"location":"comparison/#migration-path","title":"Migration Path","text":"<p>UTSS can represent most Pine Script strategies:</p> <pre><code># UTSS equivalent of Pine Script above\ninfo:\n  id: rsi_strategy\n  name: RSI Strategy\n  version: \"1.0\"\n\nparameters:\n  length:\n    type: integer\n    default: 14\n  oversold:\n    type: integer\n    default: 30\n  overbought:\n    type: integer\n    default: 70\n\nuniverse:\n  type: static\n  symbols: [AAPL]\n\nsignals:\n  rsi:\n    type: indicator\n    indicator: RSI\n    params:\n      period: { $param: length }\n\nrules:\n  - name: Buy oversold\n    when:\n      type: comparison\n      left: { $ref: \"#/signals/rsi\" }\n      operator: \"&lt;\"\n      right: { $param: oversold }\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 10 }\n\n  - name: Sell overbought\n    when:\n      type: comparison\n      left: { $ref: \"#/signals/rsi\" }\n      operator: \"&gt;\"\n      right: { $param: overbought }\n    then:\n      type: trade\n      direction: sell\n      sizing: { type: percent_of_position, percent: 100 }\n</code></pre>"},{"location":"comparison/#3-configuration-code-hybrids","title":"3. Configuration + Code Hybrids","text":"<p>Examples: Freqtrade, Jesse, Hummingbot</p>"},{"location":"comparison/#how-they-work_2","title":"How They Work","text":"<p>These use configuration files for parameters but require code for strategy logic:</p> <pre><code># Freqtrade - strategy.py\nclass RSIStrategy(IStrategy):\n    minimal_roi = {\"0\": 0.15, \"30\": 0.10, \"60\": 0.05}\n    stoploss = -0.10\n    timeframe = '1h'\n\n    def populate_indicators(self, dataframe: DataFrame, metadata: dict) -&gt; DataFrame:\n        dataframe['rsi'] = ta.RSI(dataframe, timeperiod=14)\n        return dataframe\n\n    def populate_entry_trend(self, dataframe: DataFrame, metadata: dict) -&gt; DataFrame:\n        dataframe.loc[dataframe['rsi'] &lt; 30, 'enter_long'] = 1\n        return dataframe\n\n    def populate_exit_trend(self, dataframe: DataFrame, metadata: dict) -&gt; DataFrame:\n        dataframe.loc[dataframe['rsi'] &gt; 70, 'exit_long'] = 1\n        return dataframe\n</code></pre> <pre><code>// Freqtrade - config.json\n{\n    \"max_open_trades\": 5,\n    \"stake_currency\": \"USDT\",\n    \"stake_amount\": \"unlimited\",\n    \"tradable_balance_ratio\": 0.99,\n    \"dry_run\": true,\n    \"exchange\": {\n        \"name\": \"binance\",\n        \"key\": \"\",\n        \"secret\": \"\"\n    }\n}\n</code></pre>"},{"location":"comparison/#comparison-with-utss_2","title":"Comparison with UTSS","text":"Aspect Config + Code UTSS Strategy Logic In code In schema Configuration In JSON/YAML In schema Separation Config vs code split All in one document Validation Config validated, code not Everything validated Sharing Must share code + config Single file Platform Framework-specific Universal"},{"location":"comparison/#utss-advantage","title":"UTSS Advantage","text":"<p>UTSS puts everything in the schema:</p> <pre><code># UTSS - Complete strategy in one file\ninfo:\n  id: rsi_strategy\n  name: RSI Strategy\n  version: \"1.0\"\n\nuniverse:\n  type: static\n  symbols: [BTC/USDT]\n\nsignals:\n  rsi:\n    type: indicator\n    indicator: RSI\n    params: { period: 14 }\n\nrules:\n  - name: Entry\n    when:\n      type: comparison\n      left: { $ref: \"#/signals/rsi\" }\n      operator: \"&lt;\"\n      right: { type: constant, value: 30 }\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 10 }\n\n  - name: Exit\n    when:\n      type: comparison\n      left: { $ref: \"#/signals/rsi\" }\n      operator: \"&gt;\"\n      right: { type: constant, value: 70 }\n    then:\n      type: trade\n      direction: sell\n      sizing: { type: percent_of_position, percent: 100 }\n\nconstraints:\n  max_positions: 5\n  stop_loss: { percent: 10 }\n\n# Platform-specific settings via x-extensions\nx-freqtrade:\n  stake_currency: USDT\n  dry_run: true\n  exchange: binance\n</code></pre>"},{"location":"comparison/#4-visual-strategy-builders","title":"4. Visual Strategy Builders","text":"<p>Examples: TradingView Strategy Builder, MetaTrader Strategy Tester, QuantConnect Algorithm Lab</p>"},{"location":"comparison/#how-they-work_3","title":"How They Work","text":"<p>Drag-and-drop interfaces that generate code/config behind the scenes.</p>"},{"location":"comparison/#comparison-with-utss_3","title":"Comparison with UTSS","text":"Aspect Visual Builder UTSS User Interface Graphical Text (YAML) Accessibility Non-programmers Technical users Expressiveness Limited to UI options Full schema Version Control Difficult Native (text files) Collaboration Platform-dependent Standard tools Export Platform-specific Universal"},{"location":"comparison/#utss-as-backend","title":"UTSS as Backend","text":"<p>Visual builders could use UTSS as their export format:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Visual Strategy Builder                   \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502  RSI    \u2502\u2500\u2500\u2500\u25b6\u2502   &lt;30   \u2502\u2500\u2500\u2500\u25b6\u2502   BUY   \u2502                 \u2502\n\u2502  \u2502 Period:14\u2502    \u2502         \u2502    \u2502  10%    \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n                            \u25bc Export\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  rules:                                                     \u2502\n\u2502    - name: Buy signal                                       \u2502\n\u2502      when:                                                  \u2502\n\u2502        type: comparison                                     \u2502\n\u2502        left: { type: indicator, indicator: RSI, ... }      \u2502\n\u2502        operator: \"&lt;\"                                        \u2502\n\u2502        right: { type: constant, value: 30 }                \u2502\n\u2502      then:                                                  \u2502\n\u2502        type: trade                                          \u2502\n\u2502        direction: buy                                       \u2502\n\u2502        sizing: { type: percent_of_equity, percent: 10 }    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"comparison/#5-other-schema-approaches","title":"5. Other Schema Approaches","text":""},{"location":"comparison/#quantconnect-lean-algorithm-framework","title":"QuantConnect LEAN Algorithm Framework","text":"<pre><code>// LEAN uses C# with a component architecture\npublic class RSIAlgorithm : QCAlgorithm\n{\n    private RelativeStrengthIndex _rsi;\n\n    public override void Initialize()\n    {\n        SetStartDate(2020, 1, 1);\n        AddEquity(\"AAPL\", Resolution.Daily);\n        _rsi = RSI(\"AAPL\", 14);\n    }\n\n    public override void OnData(Slice data)\n    {\n        if (_rsi &lt; 30 &amp;&amp; !Portfolio.Invested)\n            SetHoldings(\"AAPL\", 0.1);\n        else if (_rsi &gt; 70 &amp;&amp; Portfolio.Invested)\n            Liquidate(\"AAPL\");\n    }\n}\n</code></pre> <p>Comparison: LEAN is code-first but inspired UTSS's component architecture.</p>"},{"location":"comparison/#bt-python-backtesting-library","title":"bt (Python Backtesting Library)","text":"<pre><code># bt uses composable \"algos\"\nimport bt\n\ndata = bt.get('aapl', start='2020-01-01')\n\nstrategy = bt.Strategy('RSI Strategy', [\n    bt.algos.RunDaily(),\n    bt.algos.SelectWhere(data['rsi'] &lt; 30),\n    bt.algos.WeighEqually(),\n    bt.algos.Rebalance()\n])\n\nbacktest = bt.Backtest(strategy, data)\nresult = bt.run(backtest)\n</code></pre> <p>Comparison: bt's composable algos inspired UTSS's composition model, but bt is still Python code.</p>"},{"location":"comparison/#feature-matrix","title":"Feature Matrix","text":"Feature Backtrader Zipline Pine Script Freqtrade UTSS Language Python Python Pine Python YAML/JSON Validation Runtime Runtime Compile Runtime Schema Portability None None None None Full LLM Generation Hard Hard Hard Hard Easy Parameter Optimization Manual Manual Built-in Manual Built-in Multi-Asset Yes Yes Limited Yes Yes Multi-Timeframe Yes Yes Yes Yes Yes Custom Indicators Yes Yes Yes Yes Via expr/external Portfolio Signals Code Code Limited Code Built-in Event-Driven Yes Yes Limited Yes Yes Risk Management Code Code Built-in Config Schema Live Trading Yes No Via broker Yes Engine-dependent"},{"location":"comparison/#when-to-use-utss","title":"When to Use UTSS","text":""},{"location":"comparison/#ideal-use-cases","title":"Ideal Use Cases","text":"<ol> <li>LLM-Generated Strategies</li> <li>Structured output is easy to validate</li> <li>Schema provides guardrails</li> <li> <p>Examples serve as few-shot prompts</p> </li> <li> <p>Strategy Distribution</p> </li> <li>Single file contains everything</li> <li>No code execution needed to understand</li> <li> <p>Version control friendly</p> </li> <li> <p>Cross-Platform Execution</p> </li> <li>Same strategy, multiple engines</li> <li> <p>Test on one platform, deploy on another</p> </li> <li> <p>Parameter Optimization</p> </li> <li>Parameters are explicit in schema</li> <li> <p>Easy to extract and iterate</p> </li> <li> <p>Strategy Marketplaces</p> </li> <li>Standardized format</li> <li>Easy to validate and display</li> </ol>"},{"location":"comparison/#less-ideal-use-cases","title":"Less Ideal Use Cases","text":"<ol> <li>Complex Position Management</li> <li>Scaling in/out with multiple entries</li> <li>Grid trading, DCA strategies</li> <li> <p>(Consider x-extensions or custom engine)</p> </li> <li> <p>Tick-by-Tick Strategies</p> </li> <li>HFT, market making</li> <li> <p>(UTSS supports tick frequency, but execution is engine-dependent)</p> </li> <li> <p>Custom Indicator Development</p> </li> <li>Use <code>expr</code> or <code>external</code> signals</li> <li> <p>Or develop in execution engine</p> </li> <li> <p>Broker-Specific Features</p> </li> <li>Use x-extensions for platform-specific settings</li> </ol>"},{"location":"comparison/#migration-guides","title":"Migration Guides","text":""},{"location":"comparison/#from-backtrader-to-utss","title":"From Backtrader to UTSS","text":"<pre><code># Backtrader\nclass MyStrategy(bt.Strategy):\n    params = (('period', 14),)\n\n    def __init__(self):\n        self.sma = bt.indicators.SMA(period=self.params.period)\n\n    def next(self):\n        if self.data.close &gt; self.sma:\n            self.buy()\n</code></pre> <pre><code># UTSS\nparameters:\n  period: { type: integer, default: 14 }\n\nsignals:\n  sma:\n    type: indicator\n    indicator: SMA\n    params: { period: { $param: period } }\n\nrules:\n  - name: Buy above SMA\n    when:\n      type: comparison\n      left: { type: price, field: close }\n      operator: \"&gt;\"\n      right: { $ref: \"#/signals/sma\" }\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 100 }\n</code></pre>"},{"location":"comparison/#from-pine-script-to-utss","title":"From Pine Script to UTSS","text":"<pre><code>// Pine Script\n//@version=5\nstrategy(\"Golden Cross\")\nfast = ta.sma(close, 50)\nslow = ta.sma(close, 200)\nif ta.crossover(fast, slow)\n    strategy.entry(\"Long\", strategy.long)\nif ta.crossunder(fast, slow)\n    strategy.close(\"Long\")\n</code></pre> <pre><code># UTSS\nsignals:\n  sma_fast: { type: indicator, indicator: SMA, params: { period: 50 } }\n  sma_slow: { type: indicator, indicator: SMA, params: { period: 200 } }\n\nrules:\n  - name: Golden Cross\n    when:\n      type: expr\n      formula: \"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 100 }\n\n  - name: Death Cross\n    when:\n      type: expr\n      formula: \"SMA(50)[-1] &gt;= SMA(200)[-1] and SMA(50) &lt; SMA(200)\"\n    then:\n      type: trade\n      direction: sell\n      sizing: { type: percent_of_position, percent: 100 }\n</code></pre>"},{"location":"comparison/#summary","title":"Summary","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        STRATEGY REPRESENTATION SPECTRUM                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                             \u2502\n\u2502  More Flexible \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba More Portable   \u2502\n\u2502                                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 Imperative   \u2502  \u2502 Platform     \u2502  \u2502 Config +     \u2502  \u2502    UTSS      \u2502   \u2502\n\u2502  \u2502 Code         \u2502  \u2502 DSL          \u2502  \u2502 Code         \u2502  \u2502              \u2502   \u2502\n\u2502  \u2502              \u2502  \u2502              \u2502  \u2502              \u2502  \u2502              \u2502   \u2502\n\u2502  \u2502 \u2022 Backtrader \u2502  \u2502 \u2022 Pine Script\u2502  \u2502 \u2022 Freqtrade  \u2502  \u2502 \u2022 Declarative\u2502   \u2502\n\u2502  \u2502 \u2022 Zipline    \u2502  \u2502 \u2022 MQL        \u2502  \u2502 \u2022 Jesse      \u2502  \u2502 \u2022 Validated  \u2502   \u2502\n\u2502  \u2502 \u2022 bt         \u2502  \u2502 \u2022 EasyLang   \u2502  \u2502              \u2502  \u2502 \u2022 Portable   \u2502   \u2502\n\u2502  \u2502              \u2502  \u2502              \u2502  \u2502              \u2502  \u2502 \u2022 LLM-ready  \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                             \u2502\n\u2502  Flexibility: Can do anything    Portability: Works anywhere               \u2502\n\u2502  Validation: None/runtime        Validation: Full schema                   \u2502\n\u2502  LLM: Difficult                  LLM: Excellent                            \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>UTSS occupies a unique position: maximum portability while maintaining expressiveness through its layered extensibility (strict core \u2192 expressions \u2192 external \u2192 x-extensions).</p>"},{"location":"contributing/","title":"Contributing","text":"<p>Thank you for your interest in contributing to UTSS!</p>"},{"location":"contributing/#development-setup","title":"Development Setup","text":""},{"location":"contributing/#clone-the-repository","title":"Clone the Repository","text":"<pre><code>git clone https://github.com/obichan117/universal-trading-strategy-schema.git\ncd universal-trading-strategy-schema\n</code></pre>"},{"location":"contributing/#install-dependencies","title":"Install Dependencies","text":"<pre><code>cd python\nuv sync --extra dev --extra docs\n</code></pre>"},{"location":"contributing/#run-tests","title":"Run Tests","text":"<pre><code>uv run pytest\n</code></pre>"},{"location":"contributing/#run-type-checker","title":"Run Type Checker","text":"<pre><code>uv run mypy utss --ignore-missing-imports\n</code></pre>"},{"location":"contributing/#build-documentation","title":"Build Documentation","text":"<pre><code>uv run mkdocs serve\n</code></pre>"},{"location":"contributing/#project-structure","title":"Project Structure","text":"<pre><code>universal-trading-strategy-schema/\n\u251c\u2500\u2500 schema/v1/\n\u2502   \u2514\u2500\u2500 strategy.schema.json    # JSON Schema (SOURCE OF TRUTH)\n\u251c\u2500\u2500 python/utss/\n\u2502   \u251c\u2500\u2500 models.py               # Pydantic models\n\u2502   \u251c\u2500\u2500 validator.py            # Validation functions\n\u2502   \u2514\u2500\u2500 __init__.py             # Public API\n\u251c\u2500\u2500 examples/                   # Example strategies\n\u251c\u2500\u2500 docs/                       # Documentation (MkDocs)\n\u2514\u2500\u2500 mkdocs.yml                  # MkDocs configuration\n</code></pre>"},{"location":"contributing/#making-changes","title":"Making Changes","text":""},{"location":"contributing/#schema-changes","title":"Schema Changes","text":"<p>The JSON Schema is the source of truth. When making schema changes:</p> <ol> <li>Update JSON Schema first (<code>schema/v1/strategy.schema.json</code>)</li> <li>Update Python models (<code>python/utss/models.py</code>)</li> <li>Add/update examples (<code>examples/</code>)</li> <li>Update documentation (<code>docs/</code>)</li> <li>Run tests to ensure everything works</li> </ol>"},{"location":"contributing/#adding-a-new-signal-type","title":"Adding a New Signal Type","text":"<ol> <li>Add to JSON Schema under <code>definitions</code>:</li> </ol> <pre><code>\"NewSignal\": {\n  \"type\": \"object\",\n  \"required\": [\"type\", \"field\"],\n  \"properties\": {\n    \"type\": { \"const\": \"new_signal\" },\n    \"field\": { \"type\": \"string\" }\n  }\n}\n</code></pre> <ol> <li> <p>Add to <code>Signal</code> oneOf in JSON Schema</p> </li> <li> <p>Add Pydantic model:</p> </li> </ol> <pre><code>class NewSignal(BaseSchema):\n    type: Literal[\"new_signal\"]\n    field: str\n</code></pre> <ol> <li> <p>Add to <code>Signal</code> union type</p> </li> <li> <p>Export from <code>__init__.py</code></p> </li> <li> <p>Add example usage in <code>docs/</code></p> </li> </ol>"},{"location":"contributing/#adding-a-new-indicator","title":"Adding a New Indicator","text":"<ol> <li>Add to <code>IndicatorType</code> enum in JSON Schema</li> <li>Add to <code>IndicatorType</code> enum in <code>models.py</code></li> <li>Document in specification</li> </ol>"},{"location":"contributing/#code-style","title":"Code Style","text":""},{"location":"contributing/#python","title":"Python","text":"<ul> <li>Use Ruff for formatting and linting</li> <li>Follow PEP 8</li> <li>Use type hints everywhere</li> <li>Keep lines under 100 characters</li> </ul> <pre><code># Format code\nuv run ruff format utss\n\n# Check linting\nuv run ruff check utss\n</code></pre>"},{"location":"contributing/#yaml-examples","title":"YAML Examples","text":"<ul> <li>Use 2-space indentation</li> <li>Include comments explaining the strategy</li> <li>Follow existing example patterns</li> </ul>"},{"location":"contributing/#pull-request-process","title":"Pull Request Process","text":"<ol> <li>Fork the repository</li> <li>Create a branch for your feature (<code>git checkout -b feature/my-feature</code>)</li> <li>Make changes following the guidelines above</li> <li>Run tests (<code>uv run pytest</code>)</li> <li>Run type checker (<code>uv run mypy utss</code>)</li> <li>Build docs (<code>uv run mkdocs build --strict</code>)</li> <li>Commit with a clear message</li> <li>Push to your fork</li> <li>Open a Pull Request</li> </ol>"},{"location":"contributing/#commit-messages","title":"Commit Messages","text":"<p>Follow Conventional Commits:</p> <pre><code>feat: add new portfolio signal fields\nfix: correct RSI indicator parameter validation\ndocs: update quickstart guide\nchore: update dependencies\n</code></pre>"},{"location":"contributing/#reporting-issues","title":"Reporting Issues","text":""},{"location":"contributing/#bug-reports","title":"Bug Reports","text":"<p>Include:</p> <ul> <li>UTSS version (<code>python -c \"import utss; print(utss.__version__)\"</code>)</li> <li>Python version</li> <li>Minimal example to reproduce</li> <li>Expected vs actual behavior</li> </ul>"},{"location":"contributing/#feature-requests","title":"Feature Requests","text":"<p>Include:</p> <ul> <li>Use case description</li> <li>Example of how it would be used</li> <li>Any alternative approaches considered</li> </ul>"},{"location":"contributing/#questions","title":"Questions?","text":"<ul> <li>Open an issue on GitHub</li> <li>Check existing issues for similar questions</li> <li>Review the documentation</li> </ul>"},{"location":"contributing/#license","title":"License","text":"<p>By contributing, you agree that your contributions will be licensed under the MIT License.</p>"},{"location":"examples/","title":"Examples","text":"<p>This page showcases complete, working strategy examples.</p>"},{"location":"examples/#rsi-reversal-strategy","title":"RSI Reversal Strategy","text":"<p>A mean-reversion strategy that buys when RSI is oversold and sells when overbought.</p> <pre><code># RSI Reversal Strategy\n# Buy when RSI is oversold, sell when overbought\n\n$schema: https://obichan117.github.io/universal-trading-strategy-schema/schema/v1/strategy.json\n\ninfo:\n  id: rsi_reversal\n  name: RSI Reversal Strategy\n  version: \"1.0\"\n  description: |\n    A mean-reversion strategy that buys when RSI(14) drops below 30\n    and sells when RSI(14) rises above 70.\n  tags:\n    - reversal\n    - RSI\n    - mean-reversion\n  visibility: public\n\nuniverse:\n  type: static\n  symbols:\n    - AAPL\n    - MSFT\n    - GOOGL\n\n# Reusable signal definitions\nsignals:\n  rsi_14:\n    type: indicator\n    indicator: RSI\n    params:\n      period: 14\n\n# Reusable condition definitions\nconditions:\n  oversold:\n    type: comparison\n    left:\n      $ref: \"#/signals/rsi_14\"\n    operator: \"&lt;\"\n    right:\n      type: constant\n      value: 30\n\n  overbought:\n    type: comparison\n    left:\n      $ref: \"#/signals/rsi_14\"\n    operator: \"&gt;\"\n    right:\n      type: constant\n      value: 70\n\nrules:\n  - name: Buy on oversold\n    description: Enter long position when RSI drops below 30\n    when:\n      $ref: \"#/conditions/oversold\"\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: percent_of_equity\n        percent: 10\n    priority: 1\n\n  - name: Sell on overbought\n    description: Exit position when RSI rises above 70\n    when:\n      $ref: \"#/conditions/overbought\"\n    then:\n      type: trade\n      direction: sell\n      sizing:\n        type: percent_of_position\n        percent: 100\n    priority: 2\n\nconstraints:\n  max_positions: 5\n  max_position_size: 20\n  stop_loss:\n    percent: 5\n  take_profit:\n    percent: 15\n  no_shorting: true\n  no_leverage: true\n\nschedule:\n  frequency: daily\n  market_hours_only: true\n  timezone: America/New_York\n\n# Execution assumptions (strategy design decisions)\nexecution:\n  slippage:\n    type: percentage\n    value: 0.001  # 0.1% expected slippage\n  commission:\n    type: per_trade\n    value: 5  # $5 per trade\n  min_capital: 50000  # Minimum $50k for proper diversification\n  min_history: 200  # Need 200 days for RSI warmup and context\n</code></pre> <p>Key Features:</p> <ul> <li>Uses reusable <code>signals</code> and <code>conditions</code> sections</li> <li>References components with <code>$ref</code></li> <li>Includes stop loss and take profit constraints</li> </ul> <p> View on GitHub</p>"},{"location":"examples/#golden-cross-strategy","title":"Golden Cross Strategy","text":"<p>A trend-following strategy using moving average crossovers.</p> <pre><code># Golden Cross Strategy\n# Classic moving average crossover strategy\n\n$schema: https://obichan117.github.io/universal-trading-strategy-schema/schema/v1/strategy.json\n\ninfo:\n  id: golden_cross\n  name: Golden Cross Strategy\n  version: \"1.0\"\n  description: |\n    Trend-following strategy using SMA(50) and SMA(200) crossover.\n    Golden Cross (buy): SMA(50) crosses above SMA(200)\n    Death Cross (sell): SMA(50) crosses below SMA(200)\n  tags:\n    - trend-following\n    - moving-average\n    - crossover\n  visibility: public\n\nuniverse:\n  type: index\n  index: SP500\n\nsignals:\n  sma_50:\n    type: indicator\n    indicator: SMA\n    params:\n      period: 50\n\n  sma_200:\n    type: indicator\n    indicator: SMA\n    params:\n      period: 200\n\nrules:\n  - name: Golden Cross - Buy\n    description: Buy when SMA(50) crosses above SMA(200)\n    when:\n      # Cross above: was below or equal yesterday, is above today\n      type: expr\n      formula: \"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: percent_of_equity\n        percent: 5\n\n  - name: Death Cross - Sell\n    description: Sell when SMA(50) crosses below SMA(200)\n    when:\n      # Cross below: was above or equal yesterday, is below today\n      type: expr\n      formula: \"SMA(50)[-1] &gt;= SMA(200)[-1] and SMA(50) &lt; SMA(200)\"\n    then:\n      type: trade\n      direction: sell\n      sizing:\n        type: percent_of_position\n        percent: 100\n\nconstraints:\n  max_positions: 10\n  max_position_size: 10\n  trailing_stop:\n    percent: 10\n  no_shorting: true\n\nschedule:\n  frequency: daily\n  market_hours_only: true\n</code></pre> <p>Key Features:</p> <ul> <li>Uses <code>expr</code> condition type for MA crossover detection</li> <li>Index-based universe (SP500)</li> <li>Trailing stop for risk management</li> </ul> <p> View on GitHub</p>"},{"location":"examples/#earnings-play-strategy","title":"Earnings Play Strategy","text":"<p>An event-driven strategy that trades around earnings announcements.</p> <pre><code># Earnings Volatility Strategy\n# Trade around earnings announcements\n\n$schema: https://obichan117.github.io/universal-trading-strategy-schema/schema/v1/strategy.json\n\ninfo:\n  id: earnings_play\n  name: Earnings Volatility Strategy\n  version: \"1.0\"\n  description: |\n    Event-driven strategy that takes positions before earnings announcements\n    and exits after the event.\n  tags:\n    - event-driven\n    - earnings\n    - volatility\n  visibility: public\n\nuniverse:\n  type: screener\n  base: NASDAQ100\n  filters:\n    - type: comparison\n      left:\n        type: fundamental\n        metric: MARKET_CAP\n      operator: \"&gt;\"\n      right:\n        type: constant\n        value: 10000000000  # &gt; $10B market cap\n  limit: 20\n  rank_by:\n    type: indicator\n    indicator: ATR\n    params:\n      period: 14\n  order: desc\n\nrules:\n  - name: Pre-earnings Entry\n    description: Enter position 3 days before earnings\n    when:\n      type: and\n      conditions:\n        - type: comparison\n          left:\n            type: event\n            event: EARNINGS_RELEASE\n            days_before: 3\n          operator: \"=\"\n          right:\n            type: constant\n            value: 1\n        - type: comparison\n          left:\n            type: indicator\n            indicator: RSI\n            params:\n              period: 14\n          operator: \"&lt;\"\n          right:\n            type: constant\n            value: 60\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: risk_based\n        risk_percent: 1\n        stop_distance:\n          type: indicator\n          indicator: ATR\n          params:\n            period: 14\n\n  - name: Post-earnings Exit\n    description: Exit position 1 day after earnings\n    when:\n      type: comparison\n      left:\n        type: event\n        event: EARNINGS_RELEASE\n        days_after: 1\n      operator: \"=\"\n      right:\n        type: constant\n        value: 1\n    then:\n      type: trade\n      direction: sell\n      sizing:\n        type: percent_of_position\n        percent: 100\n\nconstraints:\n  max_positions: 5\n  max_position_size: 10\n  max_drawdown: 15\n  daily_loss_limit: 3\n  stop_loss:\n    atr_multiple: 2\n  no_shorting: true\n  no_leverage: true\n\nschedule:\n  frequency: daily\n  market_hours_only: true\n  timezone: America/New_York\n</code></pre> <p>Key Features:</p> <ul> <li>Uses <code>event</code> signal type for earnings detection</li> <li>Screener-based universe with fundamental filters</li> <li>Risk-based position sizing with ATR</li> </ul> <p> View on GitHub</p>"},{"location":"examples/#weekly-calendar-strategy","title":"Weekly Calendar Strategy","text":"<p>A calendar-based strategy that buys Monday and sells Friday.</p> <pre><code># Weekly Calendar Strategy\n# Buy Monday open, sell Friday close\n\n$schema: https://obichan117.github.io/universal-trading-strategy-schema/schema/v1/strategy.json\n\ninfo:\n  id: weekly_momentum\n  name: Weekly Momentum Strategy\n  version: \"1.0\"\n  description: |\n    Calendar-based strategy that captures intra-week momentum.\n    Buy at Monday open, sell at Friday close.\n  tags:\n    - calendar\n    - momentum\n    - weekly\n  visibility: public\n\nuniverse:\n  type: static\n  symbols:\n    - SPY\n    - QQQ\n\nsignals:\n  day_of_week:\n    type: calendar\n    field: day_of_week\n\nrules:\n  - name: Monday Entry\n    description: Enter position at Monday open\n    when:\n      type: comparison\n      left:\n        $ref: \"#/signals/day_of_week\"\n      operator: \"=\"\n      right:\n        type: constant\n        value: 0  # Monday = 0 (pandas: Mon=0, Tue=1, ..., Fri=4)\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: percent_of_equity\n        percent: 50\n\n  - name: Friday Exit\n    description: Exit position at Friday close\n    when:\n      type: comparison\n      left:\n        $ref: \"#/signals/day_of_week\"\n      operator: \"=\"\n      right:\n        type: constant\n        value: 4  # Friday = 4\n    then:\n      type: trade\n      direction: sell\n      sizing:\n        type: percent_of_position\n        percent: 100\n\nconstraints:\n  max_positions: 2\n  stop_loss:\n    percent: 3\n  no_shorting: true\n\nschedule:\n  frequency: daily\n  trading_days:\n    - monday\n    - friday\n</code></pre> <p>Key Features:</p> <ul> <li>Uses <code>calendar</code> signal type</li> <li>Simple day-of-week logic</li> <li>Specific trading days in schedule</li> </ul> <p> View on GitHub</p>"},{"location":"examples/#more-examples","title":"More Examples","text":""},{"location":"examples/#minimal-strategy","title":"Minimal Strategy","text":"<p>The simplest possible valid strategy:</p> <pre><code>info:\n  id: minimal\n  name: Minimal Strategy\n  version: \"1.0\"\n\nuniverse:\n  type: static\n  symbols: [SPY]\n\nrules:\n  - name: Always buy\n    when:\n      type: always\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: percent_of_equity\n        percent: 100\n</code></pre>"},{"location":"examples/#risk-parity-portfolio","title":"Risk Parity Portfolio","text":"<p>Monthly rebalancing with risk parity weights:</p> <pre><code>info:\n  id: risk_parity\n  name: Risk Parity Portfolio\n  version: \"1.0\"\n\nuniverse:\n  type: static\n  symbols: [SPY, TLT, GLD, VNQ]\n\nrules:\n  - name: Monthly rebalance\n    when:\n      type: comparison\n      left:\n        type: calendar\n        field: is_month_start\n      operator: \"=\"\n      right:\n        type: constant\n        value: 1\n    then:\n      type: rebalance\n      method: risk_parity\n      threshold: 0.05\n\nconstraints:\n  max_drawdown: 15\n\nschedule:\n  frequency: daily\n</code></pre>"},{"location":"examples/#parameter-optimization","title":"Parameter Optimization","text":"<p>Strategy with optimizable parameters:</p> <pre><code>info:\n  id: rsi_optimizable\n  name: RSI with Parameters\n  version: \"1.0\"\n\nparameters:\n  rsi_period:\n    type: integer\n    default: 14\n    min: 5\n    max: 30\n    step: 1\n\n  oversold:\n    type: integer\n    default: 30\n    min: 20\n    max: 40\n\n  overbought:\n    type: integer\n    default: 70\n    min: 60\n    max: 80\n\nuniverse:\n  type: static\n  symbols: [AAPL]\n\nsignals:\n  rsi:\n    type: indicator\n    indicator: RSI\n    params:\n      period:\n        $param: rsi_period\n\nrules:\n  - name: Buy oversold\n    when:\n      type: comparison\n      left:\n        $ref: \"#/signals/rsi\"\n      operator: \"&lt;\"\n      right:\n        $param: oversold\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: percent_of_equity\n        percent: 10\n\n  - name: Sell overbought\n    when:\n      type: comparison\n      left:\n        $ref: \"#/signals/rsi\"\n      operator: \"&gt;\"\n      right:\n        $param: overbought\n    then:\n      type: trade\n      direction: sell\n      sizing:\n        type: percent_of_position\n        percent: 100\n</code></pre>"},{"location":"examples/#japanese-market-momentum","title":"Japanese Market Momentum","text":"<p>Nikkei 225 momentum with hedging:</p> <pre><code>info:\n  id: nikkei_momentum\n  name: Nikkei 225 Momentum\n  version: \"1.0\"\n  tags: [japan, momentum]\n\nuniverse:\n  type: index\n  index: NIKKEI225\n  rank_by:\n    type: indicator\n    indicator: RETURN\n    params:\n      period: 126\n  limit: 10\n\nsignals:\n  nikkei_etf_rsi:\n    type: indicator\n    indicator: RSI\n    params:\n      period: 14\n    symbol: \"1321.T\"\n\nrules:\n  - name: Monthly rebalance\n    when:\n      type: comparison\n      left:\n        type: calendar\n        field: is_month_start\n      operator: \"=\"\n      right:\n        type: constant\n        value: 1\n    then:\n      type: rebalance\n      method: equal_weight\n\n  - name: Hedge when overbought\n    when:\n      type: comparison\n      left:\n        $ref: \"#/signals/nikkei_etf_rsi\"\n      operator: \"&gt;\"\n      right:\n        type: constant\n        value: 70\n    then:\n      type: trade\n      direction: short\n      symbol: \"1321.T\"\n      sizing:\n        type: percent_of_equity\n        percent: 30\n\nconstraints:\n  max_positions: 11\n  stop_loss:\n    percent: 10\n\nschedule:\n  frequency: daily\n  timezone: Asia/Tokyo\n</code></pre>"},{"location":"examples/#create-your-own","title":"Create Your Own","text":"<p>Use these examples as starting points:</p> <ol> <li>Copy an example that's close to your idea</li> <li>Modify the universe for your target symbols</li> <li>Adjust the signals and conditions</li> <li>Set appropriate constraints</li> <li>Validate with <code>validate_yaml()</code></li> </ol> <p>See the Quickstart Guide for step-by-step instructions.</p>"},{"location":"formula-reference/","title":"Formula Reference","text":"<p>UTSS supports a powerful expression language for defining conditions using the <code>expr</code> type. This reference documents the complete syntax and available functions.</p>"},{"location":"formula-reference/#expression-syntax","title":"Expression Syntax","text":"<p>Expressions are strings that evaluate to boolean values. They support:</p> <ul> <li>Comparisons: <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>==</code>, <code>!=</code></li> <li>Logical operators: <code>and</code>, <code>or</code>, <code>not</code></li> <li>Parentheses: <code>(...)</code> for grouping</li> <li>Historical indexing: <code>[-1]</code>, <code>[-2]</code>, etc.</li> </ul>"},{"location":"formula-reference/#basic-example","title":"Basic Example","text":"<pre><code>conditions:\n  golden_cross:\n    type: expr\n    formula: \"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"\n</code></pre>"},{"location":"formula-reference/#price-fields","title":"Price Fields","text":"<p>Access OHLCV data directly:</p> Field Description <code>close</code> Closing price <code>open</code> Opening price <code>high</code> High price <code>low</code> Low price <code>volume</code> Trading volume <code>hl2</code> (high + low) / 2 <code>hlc3</code> (high + low + close) / 3 <code>ohlc4</code> (open + high + low + close) / 4"},{"location":"formula-reference/#examples","title":"Examples","text":"<pre><code># Price above yesterday's high\nformula: \"close &gt; high[-1]\"\n\n# Volume spike\nformula: \"volume &gt; SMA(volume, 20) * 2\"\n\n# Price in upper half of range\nformula: \"close &gt; hl2\"\n</code></pre>"},{"location":"formula-reference/#historical-indexing","title":"Historical Indexing","text":"<p>Access previous values using bracket notation:</p> Syntax Meaning <code>close[-1]</code> Yesterday's close <code>SMA(20)[-1]</code> Yesterday's SMA(20) <code>RSI(14)[-5]</code> RSI value 5 days ago <p>Note</p> <p>Index 0 (current bar) is the default and can be omitted: <code>close</code> = <code>close[0]</code></p>"},{"location":"formula-reference/#indicator-functions","title":"Indicator Functions","text":""},{"location":"formula-reference/#moving-averages","title":"Moving Averages","text":"Function Parameters Description <code>SMA(period)</code> period: int Simple Moving Average <code>EMA(period)</code> period: int Exponential Moving Average <code>WMA(period)</code> period: int Weighted Moving Average <pre><code># Golden cross detection\nformula: \"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"\n\n# Price above EMA\nformula: \"close &gt; EMA(20)\"\n</code></pre>"},{"location":"formula-reference/#momentum-indicators","title":"Momentum Indicators","text":"Function Parameters Description <code>RSI(period)</code> period: int Relative Strength Index (0-100) <code>STOCH(k, d)</code> k_period, d_period Stochastic Oscillator <code>CCI(period)</code> period: int Commodity Channel Index <code>MFI(period)</code> period: int Money Flow Index <code>ROC(period)</code> period: int Rate of Change <code>WILLIAMS_R(period)</code> period: int Williams %R <code>ADX(period)</code> period: int Average Directional Index <pre><code># RSI oversold bounce\nformula: \"RSI(14)[-1] &lt; 30 and RSI(14) &gt; 30\"\n\n# Strong trend (ADX &gt; 25)\nformula: \"ADX(14) &gt; 25\"\n</code></pre>"},{"location":"formula-reference/#volatility-indicators","title":"Volatility Indicators","text":"Function Parameters Description <code>ATR(period)</code> period: int Average True Range <code>BB(period, std)</code> period, std_dev Bollinger Bands <p>Bollinger Bands return an object with <code>.upper</code>, <code>.middle</code>, <code>.lower</code>:</p> <pre><code># Bollinger Band breakout\nformula: \"close &gt; BB(20, 2).upper\"\n\n# Price in lower band\nformula: \"close &lt; BB(20, 2).lower\"\n\n# Band squeeze\nformula: \"BB(20, 2).upper - BB(20, 2).lower &lt; ATR(14) * 2\"\n</code></pre>"},{"location":"formula-reference/#trend-indicators","title":"Trend Indicators","text":"Function Parameters Description <code>MACD(fast, slow, signal)</code> 12, 26, 9 default MACD Line <p>MACD returns <code>.macd</code>, <code>.signal</code>, <code>.histogram</code>:</p> <pre><code># MACD crossover\nformula: \"MACD(12, 26, 9).macd[-1] &lt;= MACD(12, 26, 9).signal[-1] and MACD(12, 26, 9).macd &gt; MACD(12, 26, 9).signal\"\n\n# Positive histogram\nformula: \"MACD(12, 26, 9).histogram &gt; 0\"\n</code></pre>"},{"location":"formula-reference/#volume-indicators","title":"Volume Indicators","text":"Function Parameters Description <code>OBV()</code> none On-Balance Volume <code>VWAP()</code> none Volume Weighted Average Price <pre><code># OBV rising\nformula: \"OBV() &gt; OBV()[-1]\"\n\n# Price above VWAP\nformula: \"close &gt; VWAP()\"\n</code></pre>"},{"location":"formula-reference/#common-patterns","title":"Common Patterns","text":""},{"location":"formula-reference/#crossovers","title":"Crossovers","text":"<p>A crossover occurs when one value crosses above or below another:</p> <pre><code># Cross above: was at or below, now above\nformula: \"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"\n\n# Cross below: was at or above, now below\nformula: \"RSI(14)[-1] &gt;= 70 and RSI(14) &lt; 70\"\n</code></pre>"},{"location":"formula-reference/#ranges","title":"Ranges","text":"<p>Check if a value is within a range:</p> <pre><code># RSI in neutral zone\nformula: \"RSI(14) &gt;= 40 and RSI(14) &lt;= 60\"\n\n# Price in consolidation\nformula: \"ATR(14) &lt; ATR(14)[-20] * 0.5\"\n</code></pre>"},{"location":"formula-reference/#breakouts","title":"Breakouts","text":"<p>Detect when price breaks a key level:</p> <pre><code># Break above resistance (20-day high)\nformula: \"close &gt; high[-1] and close[-1] &lt;= high[-2]\"\n\n# Bollinger Band breakout\nformula: \"close &gt; BB(20, 2).upper and close[-1] &lt;= BB(20, 2).upper[-1]\"\n\n# Volume breakout\nformula: \"volume &gt; SMA(volume, 20) * 2\"\n</code></pre>"},{"location":"formula-reference/#temporal-patterns","title":"Temporal Patterns","text":"<p>Patterns that consider multiple bars:</p> <pre><code># RSI oversold for 3 bars\nformula: \"RSI(14) &lt; 30 and RSI(14)[-1] &lt; 30 and RSI(14)[-2] &lt; 30\"\n\n# Consecutive up days\nformula: \"close &gt; close[-1] and close[-1] &gt; close[-2] and close[-2] &gt; close[-3]\"\n\n# Higher highs\nformula: \"high &gt; high[-1] and high[-1] &gt; high[-2]\"\n</code></pre>"},{"location":"formula-reference/#price-action","title":"Price Action","text":"<p>Common candlestick and price patterns:</p> <pre><code># Inside bar\nformula: \"high &lt; high[-1] and low &gt; low[-1]\"\n\n# Outside bar\nformula: \"high &gt; high[-1] and low &lt; low[-1]\"\n\n# Bullish candle (close in upper 30%)\nformula: \"(close - low) / (high - low) &gt; 0.7\"\n\n# Bearish candle (close in lower 30%)\nformula: \"(close - low) / (high - low) &lt; 0.3\"\n\n# Gap up\nformula: \"open &gt; high[-1]\"\n\n# Gap down\nformula: \"open &lt; low[-1]\"\n</code></pre>"},{"location":"formula-reference/#divergences","title":"Divergences","text":"<p>Detect divergence between price and indicator:</p> <pre><code># Bullish RSI divergence (price lower low, RSI higher low)\nformula: \"low &lt; low[-5] and RSI(14) &gt; RSI(14)[-5]\"\n\n# Bearish divergence\nformula: \"high &gt; high[-5] and RSI(14) &lt; RSI(14)[-5]\"\n</code></pre>"},{"location":"formula-reference/#complete-examples","title":"Complete Examples","text":""},{"location":"formula-reference/#mean-reversion-strategy","title":"Mean Reversion Strategy","text":"<pre><code>conditions:\n  oversold_bounce:\n    type: expr\n    formula: \"RSI(14)[-1] &lt; 30 and RSI(14) &gt; RSI(14)[-1] and close &gt; SMA(20)\"\n\n  overbought_reversal:\n    type: expr\n    formula: \"RSI(14)[-1] &gt; 70 and RSI(14) &lt; RSI(14)[-1]\"\n</code></pre>"},{"location":"formula-reference/#trend-following-strategy","title":"Trend Following Strategy","text":"<pre><code>conditions:\n  trend_entry:\n    type: expr\n    formula: \"close &gt; SMA(50) and SMA(50) &gt; SMA(200) and ADX(14) &gt; 25\"\n\n  pullback_buy:\n    type: expr\n    formula: \"close &gt; SMA(200) and close &lt;= SMA(20) and RSI(14) &lt; 40\"\n</code></pre>"},{"location":"formula-reference/#volatility-breakout","title":"Volatility Breakout","text":"<pre><code>conditions:\n  squeeze_release:\n    type: expr\n    formula: \"BB(20, 2).upper - BB(20, 2).lower &lt; ATR(14)[-1] * 3 and close &gt; BB(20, 2).upper\"\n\n  volatility_expansion:\n    type: expr\n    formula: \"ATR(14) &gt; ATR(14)[-1] * 1.5 and volume &gt; SMA(volume, 20) * 2\"\n</code></pre>"},{"location":"formula-reference/#best-practices","title":"Best Practices","text":"<ol> <li> <p>Use parentheses for clarity: Complex expressions benefit from explicit grouping    <pre><code>formula: \"(RSI(14) &lt; 30) and (close &gt; SMA(20))\"\n</code></pre></p> </li> <li> <p>Break complex conditions into parts: Use named conditions for readability    <pre><code>conditions:\n  rsi_oversold:\n    type: comparison\n    left: { $ref: \"#/signals/rsi_14\" }\n    operator: \"&lt;\"\n    right: { type: constant, value: 30 }\n\n  price_above_ma:\n    type: expr\n    formula: \"close &gt; SMA(20)\"\n\n  entry_valid:\n    type: and\n    conditions:\n      - $ref: \"#/conditions/rsi_oversold\"\n      - $ref: \"#/conditions/price_above_ma\"\n</code></pre></p> </li> <li> <p>Test expressions: Use pyutss to validate your formulas    <pre><code>from pyutss import BacktestEngine\n# Engine will raise ExpressionError for invalid formulas\n</code></pre></p> </li> <li> <p>Consider warmup periods: Indicators need historical data</p> </li> <li>SMA(200) needs 200 bars</li> <li>RSI(14) needs ~14 bars</li> <li>Set <code>min_history</code> in execution section appropriately</li> </ol>"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#python-packages","title":"Python Packages","text":"<p>UTSS provides multiple packages for different use cases:</p> Package Description <code>utss</code> Core schema and validation <code>pyutss</code> Backtesting engine with indicators and metrics <code>utss-llm</code> LLM integration and conversational strategy builder <code>utss-mcp</code> MCP server for Claude Code integration"},{"location":"installation/#using-pip","title":"Using pip","text":"<pre><code>pip install utss           # Schema only\npip install pyutss         # With backtesting engine\npip install utss-llm       # With LLM/conversation features\npip install utss-mcp       # MCP server for Claude Code\n</code></pre>"},{"location":"installation/#using-uv-recommended","title":"Using uv (recommended)","text":"<pre><code>uv add utss           # Schema only\nuv add pyutss         # With backtesting engine\nuv add utss-llm       # With LLM features\nuv add utss-mcp       # MCP server\n</code></pre>"},{"location":"installation/#using-poetry","title":"Using poetry","text":"<pre><code>poetry add utss\npoetry add pyutss\npoetry add utss-llm\npoetry add utss-mcp\n</code></pre>"},{"location":"installation/#from-source","title":"From source","text":"<pre><code>git clone https://github.com/obichan117/universal-trading-strategy-schema.git\ncd universal-trading-strategy-schema\n\n# Install all packages in development mode\nuv sync\n</code></pre>"},{"location":"installation/#requirements","title":"Requirements","text":"<ul> <li>Python 3.10 or higher</li> <li>pydantic &gt;= 1.0.0</li> <li>pyyaml &gt;= 6.0</li> </ul>"},{"location":"installation/#verify-installation","title":"Verify Installation","text":"<pre><code>import utss\n\nprint(f\"UTSS version: {utss.__version__}\")\n\n# Test validation\nfrom utss import validate_yaml\n\nyaml = \"\"\"\ninfo:\n  id: test\n  name: Test\n  version: \"1.0\"\nuniverse:\n  type: static\n  symbols: [AAPL]\nrules:\n  - name: Buy\n    when: { type: always }\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 100 }\n\"\"\"\n\nstrategy = validate_yaml(yaml)\nprint(f\"Strategy loaded: {strategy.info.name}\")\n</code></pre> <p>Expected output:</p> <pre><code>UTSS version: 1.0.0\nStrategy loaded: Test\n</code></pre>"},{"location":"installation/#development-installation","title":"Development Installation","text":"<p>For contributing or running tests:</p> <pre><code>git clone https://github.com/obichan117/universal-trading-strategy-schema.git\ncd universal-trading-strategy-schema\n\n# Install all workspace packages with dev dependencies\nuv sync\n\n# Run all tests (132 tests across all packages)\nuv run pytest\n\n# Run tests for specific package\nuv run pytest packages/utss-mcp/tests -v\n</code></pre>"},{"location":"installation/#documentation-development","title":"Documentation Development","text":"<p>To build and preview documentation locally:</p> <pre><code># Install docs dependencies\nuv sync --extra docs\n\n# Serve locally\nuv run mkdocs serve\n\n# Build static site\nuv run mkdocs build --strict\n</code></pre> <p>Then open http://localhost:8000 in your browser.</p>"},{"location":"installation/#mcp-server-setup-claude-code","title":"MCP Server Setup (Claude Code)","text":"<p>To use UTSS with Claude Code:</p> <ol> <li> <p>Install the MCP package:    <pre><code>pip install utss-mcp\n</code></pre></p> </li> <li> <p>Add to your Claude Code MCP configuration (<code>~/.claude/mcp.json</code> or project config):    <pre><code>{\n  \"mcpServers\": {\n    \"utss\": {\n      \"command\": \"utss-mcp\",\n      \"args\": []\n    }\n  }\n}\n</code></pre></p> </li> <li> <p>Use in Claude Code:    <pre><code>You: Help me build a mean reversion strategy for tech stocks\n\nClaude: [calls build_strategy tool]\n        What type of strategy would you like?\n        1. Mean Reversion\n        2. Trend Following\n        3. Breakout\n        ...\n</code></pre></p> </li> </ol>"},{"location":"installation/#available-mcp-tools","title":"Available MCP Tools","text":"<ul> <li>build_strategy - Interactive strategy builder with guided questions</li> <li>validate_strategy - Validate UTSS YAML against schema</li> <li>backtest_strategy - Run backtest with performance metrics</li> <li>list_indicators - List supported technical indicators</li> <li>revise_strategy - Modify strategy in active session</li> </ul>"},{"location":"llm-guide/","title":"LLM Integration Guide","text":"<p><code>utss-llm</code> provides tools for building UTSS strategies using natural language and large language models.</p>"},{"location":"llm-guide/#installation","title":"Installation","text":"<pre><code>pip install utss-llm\n</code></pre> <p>For specific providers, install with extras:</p> <pre><code>pip install utss-llm[anthropic]  # Claude support\npip install utss-llm[openai]     # GPT support\npip install utss-llm[all]        # All providers\n</code></pre>"},{"location":"llm-guide/#provider-setup","title":"Provider Setup","text":""},{"location":"llm-guide/#anthropic-claude","title":"Anthropic (Claude)","text":"<pre><code>from utss_llm.providers import AnthropicProvider\n\nprovider = AnthropicProvider(\n    api_key=\"your-api-key\",  # Or set ANTHROPIC_API_KEY env var\n    model=\"claude-sonnet-4-20250514\",  # Optional, defaults to latest\n)\n</code></pre>"},{"location":"llm-guide/#openai-gpt","title":"OpenAI (GPT)","text":"<pre><code>from utss_llm.providers import OpenAIProvider\n\nprovider = OpenAIProvider(\n    api_key=\"your-api-key\",  # Or set OPENAI_API_KEY env var\n    model=\"gpt-4\",\n)\n</code></pre>"},{"location":"llm-guide/#google-gemini","title":"Google Gemini","text":"<pre><code>from utss_llm.providers import GeminiProvider\n\nprovider = GeminiProvider(\n    api_key=\"your-api-key\",  # Or set GOOGLE_API_KEY env var\n    model=\"gemini-pro\",\n)\n</code></pre>"},{"location":"llm-guide/#local-models-ollama","title":"Local Models (Ollama)","text":"<pre><code>from utss_llm.providers import LocalProvider\n\nprovider = LocalProvider(\n    base_url=\"http://localhost:11434\",\n    model=\"llama2\",\n)\n</code></pre>"},{"location":"llm-guide/#strategyparser-one-shot-generation","title":"StrategyParser (One-Shot Generation)","text":"<p>Generate complete UTSS strategies from natural language descriptions.</p>"},{"location":"llm-guide/#basic-usage","title":"Basic Usage","text":"<pre><code>from utss_llm import StrategyParser\nfrom utss_llm.providers import AnthropicProvider\n\n# Setup\nprovider = AnthropicProvider()\nparser = StrategyParser(provider=provider)\n\n# Parse natural language to strategy\nresult = await parser.parse(\n    \"RSI reversal strategy for AAPL. \"\n    \"Buy when RSI drops below 30, sell when above 70.\"\n)\n\nif result.success:\n    print(result.yaml_output)\n    # info:\n    #   id: rsi_reversal\n    #   name: RSI Reversal Strategy\n    #   ...\nelse:\n    print(f\"Errors: {result.errors}\")\n</code></pre>"},{"location":"llm-guide/#with-context","title":"With Context","text":"<p>Provide additional context for better results:</p> <pre><code>result = await parser.parse(\n    \"Mean reversion strategy using Bollinger Bands\",\n    context={\n        \"symbols\": [\"AAPL\", \"MSFT\", \"GOOGL\"],\n        \"market\": \"US\",\n        \"timeframe\": \"daily\",\n    },\n)\n</code></pre>"},{"location":"llm-guide/#synchronous-usage","title":"Synchronous Usage","text":"<pre><code># Use parse_sync for non-async contexts\nresult = parser.parse_sync(\"RSI strategy for tech stocks\")\n</code></pre>"},{"location":"llm-guide/#parseresult","title":"ParseResult","text":"<p>The result object contains:</p> <pre><code>@dataclass\nclass ParseResult:\n    success: bool                # Whether parsing succeeded\n    strategy: Strategy | None    # Validated UTSS Strategy object\n    yaml_output: str | None      # Generated YAML\n    errors: list[str]            # Any validation errors\n    assumptions: list[str]       # Assumptions made by the LLM\n    tokens_used: int             # Total tokens consumed\n</code></pre>"},{"location":"llm-guide/#conversationsession-guided-building","title":"ConversationSession (Guided Building)","text":"<p>Build strategies interactively with step-by-step guidance.</p>"},{"location":"llm-guide/#basic-flow","title":"Basic Flow","text":"<pre><code>from utss_llm.conversation import ConversationSession, create_session\n\n# Create session\nsession = create_session(provider=provider)\n\n# Start conversation\nresponse = await session.start()\n\n# Interactive loop\nwhile response.needs_input:\n    print(response.message)\n\n    if response.question:\n        for i, opt in enumerate(response.question.options, 1):\n            print(f\"  {i}. {opt.label}\")\n\n    user_input = input(\"&gt; \")\n    response = await session.answer(user_input)\n\n# Get final strategy\nif response.is_complete:\n    print(response.strategy_yaml)\n</code></pre>"},{"location":"llm-guide/#smart-start","title":"Smart Start","text":"<p>When using an LLM provider, the session can extract information from an initial description:</p> <pre><code>session = ConversationSession(provider=provider, use_llm=True)\n\n# Provide initial description - LLM extracts what it can\nresponse = await session.start(\n    \"I want an RSI mean reversion strategy for tech stocks, \"\n    \"buy at 30, sell at 70, with 5% stop loss\"\n)\n\n# Session skips to first unanswered question\n# (e.g., position sizing if not mentioned)\n</code></pre>"},{"location":"llm-guide/#revising-strategies","title":"Revising Strategies","text":"<p>Modify strategies after building:</p> <pre><code># Change thresholds\nresponse = await session.revise(\"change RSI entry to 25\")\n\n# Update stop loss\nresponse = await session.revise(\"set stop loss to 7%\")\n\n# Adjust sizing\nresponse = await session.revise(\"increase position size to 15%\")\n</code></pre>"},{"location":"llm-guide/#session-management","title":"Session Management","text":"<pre><code>from utss_llm.conversation import create_session, get_session, delete_session\n\n# Create and store session\nsession = create_session(provider=provider)\nsession_id = session.session_id\n\n# Later: retrieve session\nsession = get_session(session_id)\nif session:\n    response = await session.answer(\"RSI\")\n\n# Cleanup\ndelete_session(session_id)\n</code></pre>"},{"location":"llm-guide/#response-types","title":"Response Types","text":"<pre><code>from utss_llm.conversation import ResponseType\n\n# Question - needs user input\nif response.type == ResponseType.QUESTION:\n    print(response.question.text)\n    for opt in response.question.options:\n        print(f\"  - {opt.label}: {opt.description}\")\n\n# Confirmation - showing preview for approval\nif response.type == ResponseType.CONFIRMATION:\n    print(response.preview_yaml)\n    # User confirms or requests changes\n\n# Complete - strategy is done\nif response.type == ResponseType.COMPLETE:\n    print(response.strategy_yaml)\n\n# Preview - after revision\nif response.type == ResponseType.PREVIEW:\n    print(response.preview_yaml)\n</code></pre>"},{"location":"llm-guide/#parse-modes","title":"Parse Modes","text":""},{"location":"llm-guide/#beginner-mode-default","title":"Beginner Mode (Default)","text":"<p>Step-by-step guided flow with predefined options:</p> <pre><code>from utss_llm import ParseMode\n\nsession = ConversationSession(mode=ParseMode.BEGINNER)\n</code></pre>"},{"location":"llm-guide/#advanced-mode","title":"Advanced Mode","text":"<p>For experienced users - one-shot generation:</p> <pre><code>parser = StrategyParser(mode=ParseMode.ADVANCED)\n</code></pre>"},{"location":"llm-guide/#without-llm-guided-only","title":"Without LLM (Guided Only)","text":"<p>You can use the conversation builder without an LLM:</p> <pre><code># No provider - pure guided flow\nsession = ConversationSession(use_llm=False)\n\nresponse = await session.start()\n# Uses predefined questions and options only\n</code></pre>"},{"location":"llm-guide/#customization","title":"Customization","text":""},{"location":"llm-guide/#custom-prompts","title":"Custom Prompts","text":"<p>Override default prompts:</p> <pre><code>from utss_llm.prompts import SYSTEM_PROMPT, ADVANCED_TEMPLATE\n\n# Modify prompts\ncustom_system = SYSTEM_PROMPT + \"\\nAlways include stop losses.\"\n\nparser = StrategyParser(provider=provider)\n# Pass custom prompts via provider.generate() kwargs\n</code></pre>"},{"location":"llm-guide/#custom-questions","title":"Custom Questions","text":"<p>Extend the question flow:</p> <pre><code>from utss_llm.conversation import Question, Option\n\ncustom_question = Question(\n    id=\"custom_indicator\",\n    text=\"Which proprietary indicator should we use?\",\n    options=[\n        Option(id=\"my_indicator\", label=\"MyIndicator\", description=\"Custom signal\"),\n    ],\n    allow_custom=True,\n)\n</code></pre>"},{"location":"llm-guide/#error-handling","title":"Error Handling","text":"<pre><code>from utss import ValidationError\n\ntry:\n    result = await parser.parse(description)\n\n    if not result.success:\n        for error in result.errors:\n            print(f\"Validation error: {error}\")\nexcept Exception as e:\n    print(f\"Provider error: {e}\")\n</code></pre>"},{"location":"llm-guide/#best-practices","title":"Best Practices","text":""},{"location":"llm-guide/#1-be-specific","title":"1. Be Specific","text":"<p>More detail = better strategies:</p> <pre><code># Less specific\n\"RSI strategy for stocks\"\n\n# More specific\n\"RSI mean reversion strategy for AAPL, MSFT, GOOGL. \"\n\"Buy when RSI(14) &lt; 30, sell when RSI(14) &gt; 70. \"\n\"Position size 10% of equity, 5% stop loss.\"\n</code></pre>"},{"location":"llm-guide/#2-validate-output","title":"2. Validate Output","text":"<p>Always validate generated strategies:</p> <pre><code>from utss import validate_yaml\n\nresult = await parser.parse(description)\nif result.success:\n    # Re-validate to be sure\n    strategy = validate_yaml(result.yaml_output)\n</code></pre>"},{"location":"llm-guide/#3-use-conversation-for-complex-strategies","title":"3. Use Conversation for Complex Strategies","text":"<p>For strategies with many parameters, the guided conversation often produces better results:</p> <pre><code># Better for complex strategies\nsession = create_session(provider=provider, use_llm=True)\nresponse = await session.start(description)\n# ...answer questions...\n\n# vs one-shot for simple strategies\nresult = await parser.parse(\"Simple RSI strategy\")\n</code></pre>"},{"location":"llm-guide/#4-handle-token-limits","title":"4. Handle Token Limits","text":"<p>Monitor token usage for cost control:</p> <pre><code>result = await parser.parse(description)\nprint(f\"Tokens used: {result.tokens_used}\")\n\nif result.tokens_used &gt; 2000:\n    print(\"Consider simplifying the description\")\n</code></pre>"},{"location":"llm-guide/#complete-example","title":"Complete Example","text":"<pre><code>import asyncio\nfrom utss_llm import StrategyParser\nfrom utss_llm.conversation import create_session\nfrom utss_llm.providers import AnthropicProvider\nfrom pyutss import BacktestEngine, BacktestConfig\nfrom utss import validate_yaml\nimport pandas as pd\n\nasync def main():\n    # Setup provider\n    provider = AnthropicProvider()\n\n    # Method 1: One-shot parsing\n    parser = StrategyParser(provider=provider)\n    result = await parser.parse(\n        \"Golden cross strategy for SPY using 50 and 200 day SMAs\"\n    )\n\n    if result.success:\n        strategy = result.strategy\n        print(\"Strategy generated successfully!\")\n\n        # Backtest it\n        engine = BacktestEngine()\n        data = pd.read_csv(\"SPY.csv\", index_col=\"date\", parse_dates=True)\n        backtest_result = engine.run(strategy, data, \"SPY\")\n        print(f\"Return: {backtest_result.total_return_pct:.2f}%\")\n\n    # Method 2: Guided conversation\n    session = create_session(provider=provider, use_llm=True)\n    response = await session.start(\"I want a momentum strategy\")\n\n    # Simulate answering questions\n    answers = [\"trend_following\", \"static\", \"AAPL,MSFT\", \"SMA\", \"50\", \"200\", \"10\", \"5\", \"none\", \"5\", \"yes\"]\n\n    for answer in answers:\n        if response.needs_input:\n            response = await session.answer(answer)\n\n    if response.is_complete:\n        print(response.strategy_yaml)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"llm-guide/#api-reference","title":"API Reference","text":""},{"location":"llm-guide/#strategyparser","title":"StrategyParser","text":"<pre><code>class StrategyParser:\n    def __init__(\n        self,\n        provider: LLMProvider,\n        mode: ParseMode = ParseMode.ADVANCED,\n        validate: bool = True,\n    ): ...\n\n    async def parse(\n        self,\n        description: str,\n        context: dict | None = None,\n    ) -&gt; ParseResult: ...\n\n    def parse_sync(\n        self,\n        description: str,\n        context: dict | None = None,\n    ) -&gt; ParseResult: ...\n</code></pre>"},{"location":"llm-guide/#conversationsession","title":"ConversationSession","text":"<pre><code>class ConversationSession:\n    provider: LLMProvider | None\n    mode: ParseMode\n    session_id: str\n    state: ConversationState\n    use_llm: bool\n\n    async def start(\n        self,\n        initial_prompt: str | None = None,\n    ) -&gt; ConversationResponse: ...\n\n    async def answer(\n        self,\n        user_answer: str,\n    ) -&gt; ConversationResponse: ...\n\n    async def revise(\n        self,\n        instruction: str,\n    ) -&gt; ConversationResponse: ...\n\n    def export(self) -&gt; str | None: ...\n    def export_dict(self) -&gt; dict | None: ...\n    def get_preview(self) -&gt; str: ...\n</code></pre>"},{"location":"mcp-guide/","title":"MCP Integration Guide","text":"<p><code>utss-mcp</code> provides a Model Context Protocol (MCP) server for integrating UTSS with Claude Code and other MCP-compatible tools.</p>"},{"location":"mcp-guide/#installation","title":"Installation","text":"<pre><code>pip install utss-mcp\n</code></pre> <p>This installs both <code>utss</code> and <code>pyutss</code> as dependencies.</p>"},{"location":"mcp-guide/#claude-code-configuration","title":"Claude Code Configuration","text":""},{"location":"mcp-guide/#1-add-to-claude_desktop_configjson","title":"1. Add to claude_desktop_config.json","text":"<p>Add the UTSS MCP server to your Claude Code configuration:</p> <p>macOS: <code>~/Library/Application Support/Claude/claude_desktop_config.json</code> Windows: <code>%APPDATA%/Claude/claude_desktop_config.json</code></p> <pre><code>{\n  \"mcpServers\": {\n    \"utss\": {\n      \"command\": \"utss-mcp\"\n    }\n  }\n}\n</code></pre> <p>If you installed in a virtual environment:</p> <pre><code>{\n  \"mcpServers\": {\n    \"utss\": {\n      \"command\": \"/path/to/venv/bin/utss-mcp\"\n    }\n  }\n}\n</code></pre>"},{"location":"mcp-guide/#2-restart-claude-code","title":"2. Restart Claude Code","text":"<p>After updating the configuration, restart Claude Code to load the UTSS tools.</p>"},{"location":"mcp-guide/#3-verify-installation","title":"3. Verify Installation","text":"<p>In Claude Code, you should now see the UTSS tools available:</p> <ul> <li><code>build_strategy</code></li> <li><code>validate_strategy</code></li> <li><code>backtest_strategy</code></li> <li><code>list_indicators</code></li> <li><code>revise_strategy</code></li> </ul>"},{"location":"mcp-guide/#available-tools","title":"Available Tools","text":""},{"location":"mcp-guide/#build_strategy","title":"build_strategy","text":"<p>Build a trading strategy interactively through guided conversation.</p> <p>Parameters:</p> Parameter Type Required Description <code>prompt</code> string Yes Strategy description or answer to current question <code>session_id</code> string No Session ID to continue (omit for new session) <p>Example:</p> <pre><code>User: I want to build an RSI mean reversion strategy\n\nClaude: [Uses build_strategy tool with prompt=\"I want to build an RSI mean reversion strategy\"]\n\nResponse:\n{\n  \"session_id\": \"abc123\",\n  \"message\": \"Let's build your trading strategy step by step.\",\n  \"question\": {\n    \"id\": \"strategy_type\",\n    \"text\": \"What type of strategy?\",\n    \"options\": [\n      {\"id\": \"mean_reversion\", \"label\": \"Mean Reversion\"},\n      {\"id\": \"trend_following\", \"label\": \"Trend Following\"},\n      ...\n    ]\n  }\n}\n\nUser: mean reversion\n\nClaude: [Uses build_strategy tool with prompt=\"mean_reversion\", session_id=\"abc123\"]\n\n... continues until strategy is complete ...\n</code></pre>"},{"location":"mcp-guide/#validate_strategy","title":"validate_strategy","text":"<p>Validate a UTSS strategy YAML against the schema.</p> <p>Parameters:</p> Parameter Type Required Description <code>strategy_yaml</code> string Yes The UTSS strategy in YAML format <p>Example:</p> <pre><code>User: Validate this strategy:\n```yaml\ninfo:\n  id: test\n  name: Test Strategy\n  version: \"1.0\"\nuniverse:\n  type: static\n  symbols: [AAPL]\nrules:\n  - name: Buy\n    when:\n      type: always\n    then:\n      type: trade\n      direction: buy\n</code></pre> <p>Claude: [Uses validate_strategy tool]</p> <p>Response: {   \"valid\": true,   \"strategy\": {     \"info\": {...},     \"universe\": {...},     ...   } } <pre><code>### backtest_strategy\n\nRun a backtest simulation on a UTSS strategy.\n\n**Parameters:**\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| `strategy_yaml` | string | Yes | The UTSS strategy in YAML format |\n| `symbol` | string | Yes | Stock symbol (e.g., \"AAPL\", \"7203.T\") |\n| `start_date` | string | Yes | Start date (YYYY-MM-DD) |\n| `end_date` | string | Yes | End date (YYYY-MM-DD) |\n| `initial_capital` | number | No | Starting capital (default: 100000) |\n\n**Example:**\n</code></pre> User: Backtest this RSI strategy on AAPL from 2023-01-01 to 2024-01-01</p> <p>Claude: [Uses backtest_strategy tool]</p> <p>Response: {   \"success\": true,   \"metrics\": {     \"total_return_pct\": 15.32,     \"sharpe_ratio\": 1.24,     \"max_drawdown_pct\": 8.45,     \"win_rate\": 58.3,     \"total_trades\": 24,     \"profit_factor\": 1.85   },   \"trades\": [     {       \"entry_date\": \"2023-01-15\",       \"exit_date\": \"2023-01-22\",       \"direction\": \"long\",       \"pnl\": 234.50,       \"pnl_pct\": 2.34     },     ...   ] } <pre><code>### list_indicators\n\nList all supported technical indicators for UTSS strategies.\n\n**Parameters:** None\n\n**Example:**\n</code></pre> User: What indicators can I use?</p> <p>Claude: [Uses list_indicators tool]</p> <p>Response: {   \"moving_averages\": {     \"SMA\": \"Simple Moving Average\",     \"EMA\": \"Exponential Moving Average\",     \"WMA\": \"Weighted Moving Average\"   },   \"momentum\": {     \"RSI\": \"Relative Strength Index (0-100)\",     \"STOCH\": \"Stochastic Oscillator\",     \"CCI\": \"Commodity Channel Index\",     \"MFI\": \"Money Flow Index\",     \"ROC\": \"Rate of Change\",     \"WILLIAMS_R\": \"Williams %R\",     \"ADX\": \"Average Directional Index\"   },   \"volatility\": {     \"ATR\": \"Average True Range\",     \"BB\": \"Bollinger Bands\"   },   \"trend\": {     \"MACD\": \"Moving Average Convergence Divergence\"   },   \"volume\": {     \"OBV\": \"On-Balance Volume\",     \"VWAP\": \"Volume Weighted Average Price\"   } } <pre><code>### revise_strategy\n\nRevise a strategy being built in an active session.\n\n**Parameters:**\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| `session_id` | string | Yes | The session ID from build_strategy |\n| `instruction` | string | Yes | What to change (e.g., \"change RSI to 25\") |\n\n**Example:**\n</code></pre> User: Change the RSI entry threshold to 25</p> <p>Claude: [Uses revise_strategy tool with session_id=\"abc123\", instruction=\"change RSI entry to 25\"]</p> <p>Response: {   \"success\": true,   \"message\": \"Strategy updated. Here's the revised version:\",   \"preview_yaml\": \"info:\\n  id: rsi_reversal\\n  ...\",   \"changes\": [     \"Entry threshold changed from 30 to 25\"   ] } <pre><code>## Example Workflow\n\nHere's a complete workflow using Claude Code with UTSS:\n\n### 1. Build a Strategy\n</code></pre> User: Help me create an RSI mean reversion strategy for AAPL</p> <p>Claude: I'll help you build this strategy step by step. [Uses build_strategy tool]</p> <p>Let me start building your RSI strategy. I see you want a mean reversion approach for AAPL. Let me configure this:</p> <p>[Continues conversation, answering questions...]</p> <p>Here's your completed strategy:</p> <pre><code>info:\n  id: rsi_reversal\n  name: RSI Reversal Strategy\n  version: \"1.0\"\n...\n</code></pre>"},{"location":"mcp-guide/#2-validate-the-strategy","title":"2. Validate the Strategy","text":"<pre><code>User: Make sure this is valid\n\nClaude: [Uses validate_strategy tool]\n\n\u2713 Strategy is valid and conforms to UTSS v1.0 schema.\n</code></pre>"},{"location":"mcp-guide/#3-backtest","title":"3. Backtest","text":"<pre><code>User: Backtest it on AAPL for 2023\n\nClaude: [Uses backtest_strategy tool]\n\nBacktest Results for AAPL (2023-01-01 to 2023-12-31):\n\n| Metric | Value |\n|--------|-------|\n| Total Return | 15.32% |\n| Sharpe Ratio | 1.24 |\n| Max Drawdown | 8.45% |\n| Win Rate | 58.3% |\n| Total Trades | 24 |\n</code></pre>"},{"location":"mcp-guide/#4-refine","title":"4. Refine","text":"<pre><code>User: The win rate is a bit low. Try RSI entry at 25 instead of 30\n\nClaude: [Uses revise_strategy tool]\n\nUpdated the entry threshold to RSI &lt; 25.\n\n[Uses backtest_strategy tool]\n\nWith RSI entry at 25:\n| Metric | Value |\n|--------|-------|\n| Total Return | 12.85% |\n| Win Rate | 64.2% |\n\nThe win rate improved, though total return is slightly lower due to fewer\ntrades. Would you like to try other adjustments?\n</code></pre>"},{"location":"mcp-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"mcp-guide/#server-not-found","title":"Server Not Found","text":"<p>If Claude Code doesn't find the <code>utss-mcp</code> command:</p> <ol> <li>Verify installation: <code>which utss-mcp</code> or <code>where utss-mcp</code></li> <li>Use the full path in the config</li> <li>Check that the Python environment is activated</li> </ol>"},{"location":"mcp-guide/#import-errors","title":"Import Errors","text":"<p>If you see import errors:</p> <pre><code># Ensure all dependencies are installed\npip install utss-mcp[all]\n</code></pre>"},{"location":"mcp-guide/#backtest-errors","title":"Backtest Errors","text":"<p>If backtests fail:</p> <ul> <li>Check date format is YYYY-MM-DD</li> <li>Verify the symbol exists (e.g., \"AAPL\" not \"aapl\")</li> <li>Ensure date range has sufficient data (at least 50 bars recommended)</li> <li>Check internet connection for data fetching</li> </ul>"},{"location":"mcp-guide/#session-expired","title":"Session Expired","text":"<p>Sessions are stored in memory. If Claude Code restarts, you'll need to start a new session:</p> <pre><code>User: Continue building my strategy\n\nClaude: I don't have an active session. Let's start fresh.\n[Uses build_strategy tool with no session_id]\n</code></pre>"},{"location":"mcp-guide/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"mcp-guide/#custom-data-provider","title":"Custom Data Provider","text":"<p>By default, the MCP server uses Yahoo Finance. For other data sources, you'll need to modify the server or use pyutss directly.</p>"},{"location":"mcp-guide/#logging","title":"Logging","text":"<p>Enable verbose logging:</p> <pre><code>{\n  \"mcpServers\": {\n    \"utss\": {\n      \"command\": \"utss-mcp\",\n      \"env\": {\n        \"LOG_LEVEL\": \"DEBUG\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"mcp-guide/#rate-limiting","title":"Rate Limiting","text":"<p>For high-frequency usage, consider implementing rate limiting on the data provider side to avoid API restrictions.</p>"},{"location":"mcp-guide/#api-reference","title":"API Reference","text":""},{"location":"mcp-guide/#server-initialization","title":"Server Initialization","text":"<p>The MCP server is created with:</p> <pre><code>from mcp.server import Server\nserver = Server(\"utss-mcp\")\n</code></pre>"},{"location":"mcp-guide/#tool-registration","title":"Tool Registration","text":"<p>Tools are registered using decorators:</p> <pre><code>@server.list_tools()\nasync def list_tools() -&gt; list[Tool]:\n    return TOOLS\n\n@server.call_tool()\nasync def call_tool(name: str, arguments: dict) -&gt; list[TextContent]:\n    # Handle tool calls\n    ...\n</code></pre>"},{"location":"mcp-guide/#running-the-server","title":"Running the Server","text":"<pre><code>from utss_mcp import main\nmain()  # Starts stdio server\n</code></pre> <p>Or via command line:</p> <pre><code>utss-mcp\n</code></pre>"},{"location":"quickstart/","title":"UTSS Quickstart Guide","text":"<p>Get started with the Universal Trading Strategy Schema in 5 minutes.</p>"},{"location":"quickstart/#installation","title":"Installation","text":"<pre><code>pip install utss\n# or\nuv add utss\n</code></pre>"},{"location":"quickstart/#your-first-strategy","title":"Your First Strategy","text":"<p>Create a file <code>my_strategy.yaml</code>:</p> <pre><code>info:\n  id: my_first_strategy\n  name: My First Strategy\n  version: \"1.0\"\n\nuniverse:\n  type: static\n  symbols:\n    - AAPL\n\nrules:\n  - name: Buy signal\n    when:\n      type: comparison\n      left:\n        type: indicator\n        indicator: RSI\n        params:\n          period: 14\n      operator: \"&lt;\"\n      right:\n        type: constant\n        value: 30\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: percent_of_equity\n        percent: 10\n</code></pre>"},{"location":"quickstart/#validate-your-strategy","title":"Validate Your Strategy","text":"<pre><code>from utss import validate_yaml\n\nwith open(\"my_strategy.yaml\") as f:\n    strategy = validate_yaml(f.read())\n\nprint(f\"Loaded: {strategy.info.name}\")\nprint(f\"Trading: {strategy.universe.symbols}\")\nprint(f\"Rules: {len(strategy.rules)}\")\n</code></pre>"},{"location":"quickstart/#building-blocks","title":"Building Blocks","text":""},{"location":"quickstart/#signals-numbers","title":"Signals (Numbers)","text":"<p>Signals produce numeric values. Use them to represent market data.</p> <pre><code># Price data\nclose_price:\n  type: price\n  field: close\n\n# Technical indicator\nrsi_14:\n  type: indicator\n  indicator: RSI\n  params:\n    period: 14\n\n# Fundamental data\npe_ratio:\n  type: fundamental\n  metric: PE_RATIO\n\n# Portfolio state\nunrealized_pnl:\n  type: portfolio\n  field: unrealized_pnl_pct\n\n# Fixed value\nthreshold:\n  type: constant\n  value: 30\n</code></pre>"},{"location":"quickstart/#conditions-truefalse","title":"Conditions (True/False)","text":"<p>Conditions combine signals to produce boolean values.</p> <pre><code># Comparison\noversold:\n  type: comparison\n  left: { $ref: \"#/signals/rsi_14\" }\n  operator: \"&lt;\"\n  right: { type: constant, value: 30 }\n\n# Crossover (using expr formula)\ngolden_cross:\n  type: expr\n  formula: \"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"\n\n# Range (using expr formula)\nneutral_zone:\n  type: expr\n  formula: \"RSI(14) &gt;= 40 and RSI(14) &lt;= 60\"\n\n# Logical AND\nbuy_setup:\n  type: and\n  conditions:\n    - { $ref: \"#/conditions/oversold\" }\n    - { $ref: \"#/conditions/volume_spike\" }\n</code></pre>"},{"location":"quickstart/#actions-what-to-do","title":"Actions (What to Do)","text":"<p>Actions define what happens when conditions are met.</p> <pre><code># Trade\nbuy_action:\n  type: trade\n  direction: buy\n  sizing:\n    type: percent_of_equity\n    percent: 10\n\n# Rebalance\nmonthly_rebalance:\n  type: rebalance\n  method: equal_weight\n  threshold: 0.05\n\n# Alert\nsend_alert:\n  type: alert\n  message: \"RSI oversold on {symbol}!\"\n  level: warning\n  channels: [telegram, log]\n</code></pre>"},{"location":"quickstart/#common-patterns","title":"Common Patterns","text":""},{"location":"quickstart/#pattern-1-mean-reversion-rsi","title":"Pattern 1: Mean Reversion (RSI)","text":"<pre><code>info:\n  id: rsi_mean_reversion\n  name: RSI Mean Reversion\n  version: \"1.0\"\n\nuniverse:\n  type: static\n  symbols: [AAPL, MSFT, GOOGL]\n\nsignals:\n  rsi:\n    type: indicator\n    indicator: RSI\n    params: { period: 14 }\n\nrules:\n  - name: Buy oversold\n    when:\n      type: comparison\n      left: { $ref: \"#/signals/rsi\" }\n      operator: \"&lt;\"\n      right: { type: constant, value: 30 }\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 10 }\n\n  - name: Sell overbought\n    when:\n      type: comparison\n      left: { $ref: \"#/signals/rsi\" }\n      operator: \"&gt;\"\n      right: { type: constant, value: 70 }\n    then:\n      type: trade\n      direction: sell\n      sizing: { type: percent_of_position, percent: 100 }\n\nconstraints:\n  stop_loss: { percent: 5 }\n  take_profit: { percent: 15 }\n</code></pre>"},{"location":"quickstart/#pattern-2-trend-following-moving-average-crossover","title":"Pattern 2: Trend Following (Moving Average Crossover)","text":"<pre><code>info:\n  id: golden_cross\n  name: Golden Cross\n  version: \"1.0\"\n\nuniverse:\n  type: index\n  index: SP500\n  limit: 50\n\nsignals:\n  sma_fast:\n    type: indicator\n    indicator: SMA\n    params: { period: 50 }\n  sma_slow:\n    type: indicator\n    indicator: SMA\n    params: { period: 200 }\n\nrules:\n  - name: Buy on golden cross\n    when:\n      type: expr\n      formula: \"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 5 }\n\n  - name: Sell on death cross\n    when:\n      type: expr\n      formula: \"SMA(50)[-1] &gt;= SMA(200)[-1] and SMA(50) &lt; SMA(200)\"\n    then:\n      type: trade\n      direction: sell\n      sizing: { type: percent_of_position, percent: 100 }\n\nconstraints:\n  trailing_stop: { percent: 10 }\n</code></pre>"},{"location":"quickstart/#pattern-3-monthly-rebalancing","title":"Pattern 3: Monthly Rebalancing","text":"<pre><code>info:\n  id: monthly_rebalance\n  name: Monthly Equal Weight\n  version: \"1.0\"\n\nuniverse:\n  type: static\n  symbols: [SPY, TLT, GLD, VNQ]\n\nrules:\n  - name: Monthly rebalance\n    when:\n      type: comparison\n      left: { type: calendar, field: is_month_start }\n      operator: \"=\"\n      right: { type: constant, value: 1 }\n    then:\n      type: rebalance\n      method: equal_weight\n      threshold: 0.05\n\nschedule:\n  frequency: daily\n</code></pre>"},{"location":"quickstart/#pattern-4-risk-based-position-sizing","title":"Pattern 4: Risk-Based Position Sizing","text":"<pre><code>rules:\n  - name: Buy with risk management\n    when: { $ref: \"#/conditions/entry_signal\" }\n    then:\n      type: trade\n      direction: buy\n      sizing:\n        type: risk_based\n        risk_percent: 1  # Risk 1% of portfolio per trade\n        stop_distance:\n          type: indicator\n          indicator: ATR\n          params: { period: 14 }\n</code></pre>"},{"location":"quickstart/#pattern-5-exit-on-profit-target","title":"Pattern 5: Exit on Profit Target","text":"<pre><code>signals:\n  pnl:\n    type: portfolio\n    field: unrealized_pnl_pct\n\nrules:\n  - name: Take profit at 20%\n    when:\n      type: comparison\n      left: { $ref: \"#/signals/pnl\" }\n      operator: \"&gt;=\"\n      right: { type: constant, value: 20 }\n    then:\n      type: trade\n      direction: sell\n      sizing: { type: percent_of_position, percent: 100 }\n</code></pre>"},{"location":"quickstart/#parameter-optimization","title":"Parameter Optimization","text":"<p>Make your strategy optimizable:</p> <pre><code>parameters:\n  rsi_period:\n    type: integer\n    default: 14\n    min: 5\n    max: 30\n    step: 1\n    description: RSI calculation period\n\n  oversold_threshold:\n    type: integer\n    default: 30\n    min: 20\n    max: 40\n    description: RSI oversold level\n\nsignals:\n  rsi:\n    type: indicator\n    indicator: RSI\n    params:\n      period: { $param: rsi_period }  # Reference parameter\n\nrules:\n  - name: Buy oversold\n    when:\n      type: comparison\n      left: { $ref: \"#/signals/rsi\" }\n      operator: \"&lt;\"\n      right: { $param: oversold_threshold }  # Reference parameter\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 10 }\n</code></pre>"},{"location":"quickstart/#japanese-market-example","title":"Japanese Market Example","text":"<pre><code>info:\n  id: nikkei_momentum\n  name: Nikkei 225 Momentum\n  version: \"1.0\"\n  tags: [japan, momentum]\n\nuniverse:\n  type: index\n  index: NIKKEI225\n  rank_by:\n    type: indicator\n    indicator: RETURN\n    params: { period: 126 }  # 6-month return\n  limit: 10  # Top 10 momentum stocks\n\nrules:\n  - name: Monthly rebalance\n    when:\n      type: comparison\n      left: { type: calendar, field: is_month_start }\n      operator: \"=\"\n      right: { type: constant, value: 1 }\n    then:\n      type: rebalance\n      method: equal_weight\n\nconstraints:\n  max_positions: 10\n  stop_loss: { percent: 10 }\n\nschedule:\n  frequency: daily\n  timezone: Asia/Tokyo\n</code></pre>"},{"location":"quickstart/#backtesting-with-pyutss","title":"Backtesting with pyutss","text":"<p>Once you have a strategy, run it against historical data:</p> <pre><code>pip install pyutss  # Includes Yahoo Finance data provider\n</code></pre> <pre><code>from pyutss import Engine\nfrom pyutss.data import fetch\nfrom utss import load_yaml\n\n# Load strategy\nstrategy = load_yaml(open(\"my_strategy.yaml\").read())\n\n# Fetch data\ndata = fetch(\"AAPL\", start=\"2023-01-01\", end=\"2024-01-01\")\n\n# Run backtest (unified Engine for 1..N symbols)\nengine = Engine(initial_capital=100000)\nresult = engine.backtest(strategy, data=data, symbol=\"AAPL\")\n\n# View results\nresult.summary()\n</code></pre>"},{"location":"quickstart/#advanced-features","title":"Advanced Features","text":"<pre><code># Portfolio backtesting (same Engine, multiple symbols)\nfrom pyutss import Engine\n\nengine = Engine(initial_capital=100000)\nresult = engine.backtest(\n    strategy,\n    data={\"AAPL\": aapl_df, \"MSFT\": msft_df},\n    weights=\"equal\",\n)\n# Returns PortfolioResult for multi-symbol, BacktestResult for single\n\n# Japanese market with lot size and tiered commission\nfrom pyutss import Engine, BacktestExecutor\n\nexecutor = BacktestExecutor(\n    lot_size=100,  # Standard Japanese lot\n    tiered_commission=[\n        {\"up_to\": 50000, \"fee\": 55},\n        {\"up_to\": 100000, \"fee\": 99},\n        {\"up_to\": 200000, \"fee\": 115},\n    ],\n    slippage_rate=0.001,\n)\nengine = Engine(initial_capital=10_000_000, executor=executor)\nresult = engine.backtest(strategy, data=data, symbol=\"7203.T\")\n\n# Walk-forward optimization\nfrom pyutss.optimization import WalkForwardOptimizer\n\noptimizer = WalkForwardOptimizer(\n    strategy=strategy,\n    param_grid={\"rsi_period\": [10, 14, 20], \"rsi_oversold\": [25, 30, 35]},\n    n_splits=5,\n)\nresult = optimizer.run(data, symbol=\"AAPL\")\nprint(f\"Best params: {result.best_params}\")\n\n# Performance visualization (tear sheets)\nfrom pyutss.visualization import TearSheet\n\nsheet = TearSheet(result)\nsheet.full_report(\"report.html\")  # Generate HTML tear sheet\nsheet.plot_equity()               # Interactive equity curve\nsheet.plot_monthly_heatmap()      # Calendar heatmap\n</code></pre>"},{"location":"quickstart/#next-steps","title":"Next Steps","text":"<ol> <li>Read the Architecture Guide - Understand design philosophy</li> <li>Browse Examples - See complete strategy files</li> <li>Read the Specification - Full reference documentation</li> <li>Build your own strategy - Start with a simple idea, add complexity gradually</li> </ol>"},{"location":"quickstart/#common-mistakes","title":"Common Mistakes","text":""},{"location":"quickstart/#1-missing-type-field","title":"1. Missing <code>type</code> field","text":"<pre><code># Wrong\nwhen:\n  left: { indicator: RSI }  # Missing type!\n\n# Correct\nwhen:\n  left:\n    type: indicator  # Always include type\n    indicator: RSI\n</code></pre>"},{"location":"quickstart/#2-wrong-reference-path","title":"2. Wrong reference path","text":"<pre><code># Wrong\n$ref: \"#/components/signals/rsi\"  # Old v1.0 path\n\n# Correct (v1.0)\n$ref: \"#/signals/rsi\"  # Direct path\n</code></pre>"},{"location":"quickstart/#3-missing-required-fields","title":"3. Missing required fields","text":"<pre><code># Wrong - missing operator\nwhen:\n  type: comparison\n  left: { ... }\n  right: { ... }\n\n# Correct\nwhen:\n  type: comparison\n  left: { ... }\n  operator: \"&lt;\"  # Required!\n  right: { ... }\n</code></pre>"},{"location":"quickstart/#getting-help","title":"Getting Help","text":"<ul> <li>Validation errors: Use <code>validate_yaml()</code> to get detailed error messages</li> <li>Examples: Check the <code>examples/</code> directory for working strategies</li> <li>Specification: See specification.md for complete reference</li> </ul>"},{"location":"research/","title":"Research Background","text":"<p>This document summarizes existing research and industry practices related to trading strategy representation, comparing code-based vs schema-based approaches with particular emphasis on LLM applications.</p>"},{"location":"research/#executive-summary","title":"Executive Summary","text":"Approach Representation LLM Accuracy Portability Validation Imperative Code (Pine Script, Python) Source code ~60-77% Platform-locked Runtime only Schema-based (UTSS) JSON/YAML ~95%+ Universal Static + Runtime <p>Key finding: Research shows that constrained, schema-based representations outperform general-purpose code by 20-40 percentage points for LLM generation tasks, particularly for multi-step operations like trading strategies.</p>"},{"location":"research/#part-1-industry-landscape","title":"Part 1: Industry Landscape","text":""},{"location":"research/#11-the-fragmented-ecosystem","title":"1.1 The Fragmented Ecosystem","text":"<p>The trading bot industry lacks a standard strategy representation. Each platform uses its own format:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    CURRENT INDUSTRY STATE                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Platform          \u2502 Format              \u2502 Portability          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  TradingView       \u2502 Pine Script         \u2502 TradingView only     \u2502\n\u2502  TradeStation      \u2502 EasyLanguage        \u2502 TradeStation only    \u2502\n\u2502  MetaTrader        \u2502 MQL4/MQL5           \u2502 MetaTrader only      \u2502\n\u2502  Freqtrade         \u2502 Python classes      \u2502 Freqtrade only       \u2502\n\u2502  QuantConnect      \u2502 C#/Python code      \u2502 LEAN engine only     \u2502\n\u2502  Tradetron         \u2502 Proprietary cloud   \u2502 Tradetron only       \u2502\n\u2502  3Commas           \u2502 Proprietary JSON    \u2502 3Commas only         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"research/#12-typical-workflow","title":"1.2 Typical Workflow","text":"<p>Most traders follow this fragmented workflow:</p> <pre><code>1. IDEATION              2. PROTOTYPING           3. LIVE TRADING\n   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500        \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   Natural language    \u2192    Pine Script         \u2192    Python/Bot\n   \"Buy when RSI &lt; 30\"      (TradingView)            (manual rewrite)\n                                  \u2502\n                                  \u25bc\n                            Backtest results\n                                  \u2502\n                                  \u25bc\n                            Manual conversion \u2190 No standard format!\n                                  \u2502\n                                  \u25bc\n                            Python code for\n                            Freqtrade/custom bot\n</code></pre> <p>The problem: Strategy logic is manually rewritten between platforms, introducing errors and preventing automation.</p>"},{"location":"research/#13-strategy-marketplaces","title":"1.3 Strategy Marketplaces","text":"<p>Several marketplaces exist, but all are platform-locked:</p> Platform Model Strategy Format Export? TradingView Scripts 150K+ public scripts Pine Script No (code only) QuantConnect Alpha Algorithm library C#/Python Git-based Tradetron Subscription marketplace Proprietary No Collective2 Signal following Signals only No strategy logic <p>Key insight: No marketplace offers a portable, machine-readable strategy specification that works across platforms.</p>"},{"location":"research/#14-webhook-signal-formats","title":"1.4 Webhook Signal Formats","text":"<p>For bridging platforms, webhooks are used\u2014but with no standard format:</p> <p>TradersPost format: <pre><code>{\n  \"ticker\": \"AAPL\",\n  \"action\": \"buy\",\n  \"quantity\": 100,\n  \"quantityType\": \"fixed_quantity\"\n}\n</code></pre></p> <p>3Commas format: <pre><code>{\n  \"message_type\": \"bot\",\n  \"bot_id\": 12345,\n  \"email_token\": \"abc123\",\n  \"delay_seconds\": 0\n}\n</code></pre></p> <p>WunderTrading, Altrady, Growlonix: All different formats.</p> <p>This fragmentation means every integration requires custom code.</p>"},{"location":"research/#part-2-code-based-vs-schema-based-approaches","title":"Part 2: Code-Based vs Schema-Based Approaches","text":""},{"location":"research/#21-the-fundamental-trade-off","title":"2.1 The Fundamental Trade-off","text":"Aspect Code-Based Schema-Based Expressiveness Turing-complete Constrained to schema Flexibility Any logic possible Limited to defined types Validation Runtime only Static + runtime LLM generation Error-prone Highly accurate Human authoring Requires programming Declarative, simpler Machine parsing Requires AST analysis Native structure Portability Platform-dependent Universal"},{"location":"research/#22-existing-trading-dsls","title":"2.2 Existing Trading DSLs","text":""},{"location":"research/#pine-script-tradingview","title":"Pine Script (TradingView)","text":"<p>Philosophy: \"Lightweight language for traders, not programmers\"</p> <p>Design: - Time-series native (every variable is implicitly a series) - Bar-by-bar execution model - Event-driven on realtime ticks</p> <pre><code>// Pine Script example\nrsi = ta.rsi(close, 14)\nif rsi &lt; 30\n    strategy.entry(\"Buy\", strategy.long)\n</code></pre> <p>Limitations (documented): - 64 plot limit per script - 40 <code>request.security()</code> calls max - 9,000 orders in backtests - No external libraries - Platform-locked execution</p>"},{"location":"research/#easylanguage-tradestation","title":"EasyLanguage (TradeStation)","text":"<p>Philosophy: \"English-like expressions using trading terms\"</p> <pre><code>if RSI(Close, 14) crosses below 30 then\n    Buy next bar at market;\n</code></pre> <p>Strengths: Natural language syntax, 25+ years of libraries Limitations: Proprietary, TradeStation-only</p>"},{"location":"research/#mql5-metatrader","title":"MQL5 (MetaTrader)","text":"<p>Philosophy: \"C++-like power for trading applications\"</p> <pre><code>void OnTick() {\n   double rsi = iRSI(_Symbol, PERIOD_H1, 14, PRICE_CLOSE);\n   if (rsi &lt; 30) {\n      trade.Buy(0.1, _Symbol);\n   }\n}\n</code></pre> <p>Strengths: High performance, full OOP Limitations: Platform-locked, steep learning curve</p>"},{"location":"research/#23-the-atlas-abstract-strategy-tree","title":"2.3 The Atlas Abstract Strategy Tree","text":"<p>The Atlas framework takes a tree-based approach similar to UTSS:</p> <pre><code>AllocationNode\n\u2514\u2500\u2500 ExchangeViewNode (filter: spread &gt; 0)\n    \u2514\u2500\u2500 AssetCompNode (trend direction)\n        \u251c\u2500\u2500 AssetIfNode (close &gt; upper_band)\n        \u2514\u2500\u2500 AssetOpNode (upper_band = median + multiplier \u00d7 ATR)\n</code></pre> <p>Key differences from UTSS:</p> Aspect Atlas AST UTSS Format C++ objects JSON/YAML Purpose Runtime execution Specification Level Low-level ops High-level concepts Portability Compiled binary Any platform"},{"location":"research/#part-3-llm-parsing-research","title":"Part 3: LLM Parsing Research","text":""},{"location":"research/#31-the-core-problem","title":"3.1 The Core Problem","text":"<p>LLMs generating trading strategies face two challenges:</p> <ol> <li>Syntax errors: Invalid code that won't parse</li> <li>Semantic errors: Valid code with wrong logic</li> </ol> <p>Research shows these problems are dramatically reduced with schema-based approaches.</p>"},{"location":"research/#32-key-research-findings","title":"3.2 Key Research Findings","text":""},{"location":"research/#anka-dsl-study-arxiv-dec-2025","title":"Anka DSL Study (arXiv, Dec 2025)","text":"<p>The Anka DSL research designed a language specifically for LLM generation:</p> Metric Anka (Schema-like) Python (Code) Improvement Parse success 99.9% 95%+ +4.9% Simple tasks ~95% ~95% No difference Multi-step tasks 100% 60% +40% Overall accuracy 95.8% 91.2% +4.6% <p>Critical insight: The advantage of constrained syntax grows with task complexity. Trading strategies are inherently multi-step, making this finding highly relevant.</p>"},{"location":"research/#dsl-mediated-trading-strategy-generation-2025","title":"DSL-Mediated Trading Strategy Generation (2025)","text":"<p>Research from Xi'an Jiaotong-Liverpool University found:</p> <ul> <li>95.3% accuracy mapping natural language to trading DSL</li> <li>DSL intermediary reduces hallucinations compared to direct code generation</li> <li>Interpretability maintained throughout the pipeline</li> </ul>"},{"location":"research/#microsoft-dsl-research-dec-2025","title":"Microsoft DSL Research (Dec 2025)","text":"<p>Microsoft's study on AI coding agents:</p> Scenario LLM Accuracy DSL without context &lt;20% DSL with 3-5 examples up to 85% General-purpose language Variable <p>Key finding: LLMs need explicit schema examples, not training data.</p>"},{"location":"research/#33-why-schemas-outperform-code","title":"3.3 Why Schemas Outperform Code","text":""},{"location":"research/#constrained-decoding","title":"Constrained Decoding","text":"<p>Modern LLM frameworks use constrained decoding to guarantee valid output:</p> <pre><code>Token Generation Process:\n\nUnconstrained:  \"Generate buy signal\" \u2192 [any token] \u2192 potential errors\n\nConstrained:    \"Generate buy signal\" \u2192 [only valid schema tokens] \u2192 guaranteed valid\n</code></pre> <p>Tools like Outlines, Guidance, and XGrammar enforce JSON schema compliance at ~50\u03bcs per token.</p>"},{"location":"research/#error-reduction-mechanisms","title":"Error Reduction Mechanisms","text":"<p>The Anka research identified why constrained syntax works:</p> <ol> <li>Reduced decision space: One canonical form per operation</li> <li>Explicit state: Named intermediates prevent confusion</li> <li>Structural templates: Guided sequential generation</li> </ol> <p>Python error patterns in trading code: - 42% variable shadowing - 31% operation sequencing errors - 27% method chaining confusion</p> <p>All three are eliminated by schema constraints.</p>"},{"location":"research/#34-structured-output-benchmarks","title":"3.4 Structured Output Benchmarks","text":"<p>JSONSchemaBench evaluated structured output generation:</p> Framework Coverage Notes Guidance Highest on 6/8 datasets Open source Llamacpp Highest on 2/8 datasets C++ performance OpenAI Lower coverage Closed source Gemini Lower coverage Closed source <p>Recommendation: Use open-source constrained decoding for maximum schema compliance.</p>"},{"location":"research/#35-llm-trading-code-generation-studies","title":"3.5 LLM Trading Code Generation Studies","text":"<p>Practical experiments show:</p> Model Task Accuracy Notes Claude Opus 4 Strategy generation High Prone to overfitting GPT-4o JSON processing 77% Frontier model ceiling Claude 3.5 Anka DSL 95.8% With schema constraints <p>Key insight: The prompt matters more than the model. A well-designed schema + good prompt beats raw code generation.</p>"},{"location":"research/#part-4-implications-for-utss","title":"Part 4: Implications for UTSS","text":""},{"location":"research/#41-schema-design-principles-for-llms","title":"4.1 Schema Design Principles for LLMs","text":"<p>Based on research, UTSS should:</p> Principle Implementation Benefit Canonical forms One way to express each concept Reduces decision errors Explicit typing <code>type</code> field on every node Enables constrained decoding Named references <code>$ref</code> for composition Prevents state confusion Verbose structure Full field names Aligns with LLM strengths <p>Example of LLM-friendly UTSS: <pre><code># Explicit, canonical, verbose\nwhen:\n  type: comparison           # Always explicit type\n  left:\n    type: indicator          # Nested type required\n    indicator: RSI\n    params:\n      period: 14\n  operator: \"&lt;\"              # Explicit operator\n  right:\n    type: constant           # Even constants typed\n    value: 30\n</code></pre></p> <p>vs problematic alternatives: <pre><code># Ambiguous, multiple valid forms (bad for LLMs)\nwhen: \"RSI(14) &lt; 30\"         # String parsing needed\nwhen: { RSI: { \"&lt;\": 30 } }   # Non-canonical structure\n</code></pre></p>"},{"location":"research/#42-constrained-decoding-integration","title":"4.2 Constrained Decoding Integration","text":"<p>UTSS can leverage constrained decoding:</p> <pre><code>from outlines import models, generate\nimport json\n\n# Load UTSS JSON Schema\nwith open(\"strategy.schema.json\") as f:\n    schema = json.load(f)\n\nmodel = models.transformers(\"mistralai/Mistral-7B-v0.1\")\ngenerator = generate.json(model, schema)\n\n# Generate valid UTSS from natural language\nstrategy = generator(\"RSI mean reversion: buy when RSI &lt; 30, sell when RSI &gt; 70\")\n# Guaranteed to be valid UTSS!\n</code></pre>"},{"location":"research/#43-competitive-advantages","title":"4.3 Competitive Advantages","text":"Feature Pine Script Python Code UTSS LLM generation accuracy ~70% ~60% (complex) 95%+ Validation before execution No No Yes Cross-platform No Partial Yes Version control friendly Text diff Text diff Semantic diff Constrained decoding support No No Native"},{"location":"research/#part-5-pine-script-utss-conversion","title":"Part 5: Pine Script \u2192 UTSS Conversion","text":""},{"location":"research/#51-existing-tools","title":"5.1 Existing Tools","text":"Tool Function Output Pynescript Pine Script \u2192 Python AST Syntax tree PineTS Pine Script \u2192 JavaScript Executable code PyneCore Pine Script \u2192 Python runtime Executable code <p>Gap: No tool produces a semantic schema (UTSS format).</p>"},{"location":"research/#52-proposed-conversion-pipeline","title":"5.2 Proposed Conversion Pipeline","text":"<pre><code>Pine Script Source\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Pynescript      \u2502 \u2190 ANTLR-based parser\n\u2502  (Parse)         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n   Python AST Nodes\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Semantic        \u2502 \u2190 Pattern matching + type inference\n\u2502  Analyzer        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  UTSS            \u2502 \u2190 JSON Schema validation\n\u2502  Schema          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"research/#53-mapping-examples","title":"5.3 Mapping Examples","text":"Pine Script UTSS Equivalent <code>ta.rsi(close, 14)</code> <code>{ type: indicator, indicator: RSI, params: { period: 14 } }</code> <code>ta.crossover(a, b)</code> <code>{ type: expr, formula: \"a[-1] &lt;= b[-1] and a &gt; b\" }</code> <code>strategy.entry(\"Buy\", strategy.long)</code> <code>{ type: trade, direction: buy }</code> <code>if cond</code> <code>{ when: cond, then: action }</code>"},{"location":"research/#54-conversion-challenges","title":"5.4 Conversion Challenges","text":"Challenge Difficulty UTSS Coverage Simple indicators Easy Full support Crossovers/comparisons Easy Full support Basic entry/exit Easy Full support Custom functions Medium Via <code>expression</code> type State variables (<code>var</code>) Hard Not supported Arbitrary loops Hard Not supported Drawing operations N/A Out of scope <p>Estimated coverage: ~80% of Pine Script strategies can map to UTSS.</p>"},{"location":"research/#part-6-future-research-directions","title":"Part 6: Future Research Directions","text":""},{"location":"research/#61-llm-integration","title":"6.1 LLM Integration","text":"<ol> <li>Fine-tuning on UTSS: Train models specifically on UTSS examples</li> <li>Constrained generation: Integrate with Outlines/Guidance for guaranteed validity</li> <li>Natural language interface: \"Create a strategy that...\" \u2192 UTSS</li> </ol>"},{"location":"research/#62-formal-verification","title":"6.2 Formal Verification","text":"<p>UTSS's declarative nature enables: - Property checking: \"Does this strategy ever short?\" - Consistency validation: \"Are all referenced signals defined?\" - Risk analysis: \"What's the maximum position size?\"</p>"},{"location":"research/#63-ecosystem-development","title":"6.3 Ecosystem Development","text":"<p>Priority areas: 1. Execution adapters: UTSS \u2192 Freqtrade, QuantConnect, etc. 2. Visual builders: Drag-and-drop \u2192 UTSS 3. Conversion tools: Pine Script \u2192 UTSS</p>"},{"location":"research/#references","title":"References","text":""},{"location":"research/#academic-papers","title":"Academic Papers","text":"<ol> <li>Anka DSL (2025): arXiv:2512.23214 - LLM-optimized DSL design</li> <li>DSL-Xpert 2.0 (2025): ScienceDirect - Grammar prompting for DSLs</li> <li>JSONSchemaBench (2025): arXiv:2501.10868 - Structured output benchmarks</li> <li>Trading Strategy DSL (2025): XJTLU - DSL-mediated approach</li> </ol>"},{"location":"research/#industry-standards","title":"Industry Standards","text":"<ol> <li>FIX Protocol: fixtrading.org - Message transport</li> <li>FIXatdl: Wikipedia - Algorithmic trading parameters</li> <li>FIBO: spec.edmcouncil.org - Financial ontology</li> </ol>"},{"location":"research/#tools-frameworks","title":"Tools &amp; Frameworks","text":"<ol> <li>Pynescript: GitHub - Pine Script parser</li> <li>Outlines: GitHub - Constrained LLM generation</li> <li>llguidance: GitHub - Fast structured output</li> <li>Atlas AST: Blog - Strategy tree approach</li> </ol>"},{"location":"research/#platforms","title":"Platforms","text":"<ol> <li>TradingView: tradingview.com - Pine Script ecosystem</li> <li>QuantConnect: quantconnect.com - LEAN engine</li> <li>Freqtrade: freqtrade.io - Open source crypto bot</li> <li>Tradetron: tradetron.tech - No-code strategy builder</li> </ol>"},{"location":"specification/","title":"UTSS v1.0 Schema Specification","text":"<p>Universal Trading Strategy Schema - Complete Reference</p> <p>This document defines the schema. Execution semantics are left to consuming applications.</p>"},{"location":"specification/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Design Principles</li> <li>Schema Structure</li> <li>Type Definitions</li> <li>Enumerations</li> <li>Extensibility</li> <li>Examples</li> </ol>"},{"location":"specification/#overview","title":"Overview","text":"<p>UTSS is a declarative schema for expressing trading strategies. A valid UTSS document contains all information needed to:</p> <ul> <li>Select which assets to trade (universe)</li> <li>Compute derived values (signals)</li> <li>Define trading logic (rules)</li> <li>Specify risk limits (constraints)</li> <li>Set evaluation schedule (schedule)</li> </ul>"},{"location":"specification/#schema-architecture","title":"Schema Architecture","text":"<pre><code>graph TB\n    subgraph Strategy[\"\ud83d\udcc4 Strategy Document\"]\n        Info[\"info\"]\n        Universe[\"universe\"]\n        Parameters[\"parameters\"]\n        Signals[\"signals\"]\n        Conditions[\"conditions\"]\n        Rules[\"rules\"]\n        Constraints[\"constraints\"]\n        Schedule[\"schedule\"]\n    end\n\n    subgraph Rule[\"\ud83d\udccb Rule\"]\n        When[\"when: Condition\"]\n        Then[\"then: Action\"]\n    end\n\n    subgraph SignalTypes[\"\ud83d\udcca Signal Types\"]\n        Price[\"PriceSignal\"]\n        Indicator[\"IndicatorSignal\"]\n        Fundamental[\"FundamentalSignal\"]\n        Calendar[\"CalendarSignal\"]\n        Event[\"EventSignal\"]\n        Portfolio[\"PortfolioSignal\"]\n        Relative[\"RelativeSignal\"]\n        Constant[\"ConstantSignal\"]\n        Arithmetic[\"ArithmeticSignal\"]\n        Expression[\"ExpressionSignal\"]\n        External[\"ExternalSignal\"]\n    end\n\n    subgraph ConditionTypes[\"\u2705 Condition Types (v1.0 Minimal)\"]\n        Comparison[\"ComparisonCondition\"]\n        Logical[\"And/Or/Not\"]\n        Expression[\"ExpressionCondition\"]\n        Always[\"AlwaysCondition\"]\n    end\n\n    subgraph ActionTypes[\"\u26a1 Action Types\"]\n        Trade[\"TradeAction\"]\n        Rebalance[\"RebalanceAction\"]\n        Alert[\"AlertAction\"]\n        Hold[\"HoldAction\"]\n    end\n\n    subgraph SizingTypes[\"\ud83d\udcd0 Sizing Types\"]\n        Fixed[\"FixedAmount\"]\n        PctEquity[\"PercentEquity\"]\n        PctPosition[\"PercentPosition\"]\n        RiskBased[\"RiskBased\"]\n        Kelly[\"Kelly\"]\n        VolAdj[\"VolatilityAdjusted\"]\n    end\n\n    Rules --&gt; Rule\n    When --&gt; ConditionTypes\n    Then --&gt; ActionTypes\n    Signals --&gt; SignalTypes\n    Conditions --&gt; ConditionTypes\n    Trade --&gt; SizingTypes\n    Comparison --&gt; SignalTypes\n    Expression --&gt; SignalTypes\n\n    Parameters -.-&gt;|\"$param\"| SignalTypes\n    Signals -.-&gt;|\"$ref\"| ConditionTypes\n\n    style Strategy fill:#e1f5fe\n    style Rule fill:#fff3e0\n    style SignalTypes fill:#e8f5e9\n    style ConditionTypes fill:#fce4ec\n    style ActionTypes fill:#f3e5f5\n    style SizingTypes fill:#fff8e1</code></pre>"},{"location":"specification/#type-system-overview","title":"Type System Overview","text":"<pre><code>graph LR\n    subgraph Primitives[\"Primitives\"]\n        Number[\"number\"]\n        String[\"string\"]\n        Boolean[\"boolean\"]\n        Integer[\"integer\"]\n    end\n\n    subgraph ValueTypes[\"Value Producers\"]\n        Signal[\"Signal \u2192 number\"]\n        Condition[\"Condition \u2192 boolean\"]\n    end\n\n    subgraph References[\"References\"]\n        Ref[\"$ref \u2192 any component\"]\n        Param[\"$param \u2192 parameter value\"]\n    end\n\n    subgraph Composites[\"Composites\"]\n        Rule[\"Rule = Condition + Action\"]\n        Action[\"Action = what to do\"]\n        Sizing[\"Sizing = how much\"]\n    end\n\n    Signal --&gt; Number\n    Condition --&gt; Boolean\n    Rule --&gt; Condition\n    Rule --&gt; Action\n    Action --&gt; Sizing\n\n    style Primitives fill:#f5f5f5\n    style ValueTypes fill:#e3f2fd\n    style References fill:#fff3e0\n    style Composites fill:#e8f5e9</code></pre> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      UTSS Document                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  info        \u2502 Metadata (id, name, version, author)        \u2502\n\u2502  universe    \u2502 What to trade                                \u2502\n\u2502  signals     \u2502 Named signal definitions (optional)         \u2502\n\u2502  conditions  \u2502 Named condition definitions (optional)      \u2502\n\u2502  rules       \u2502 When/then pairs (required)                  \u2502\n\u2502  constraints \u2502 Risk limits (optional)                      \u2502\n\u2502  schedule    \u2502 Evaluation timing (optional)                \u2502\n\u2502  parameters  \u2502 Optimizable values (optional)               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"specification/#design-principles","title":"Design Principles","text":""},{"location":"specification/#1-declarative-over-imperative","title":"1. Declarative Over Imperative","text":"<p>Define WHAT should happen, not HOW to compute it.</p> <pre><code># GOOD: Declarative\nwhen: RSI(14) &lt; 30\nthen: buy 10%\n\n# BAD: Imperative (not supported)\nfor each bar:\n  rsi = calculate_rsi(close, 14)\n  if rsi &lt; 30:\n    buy(0.10 * equity)\n</code></pre>"},{"location":"specification/#2-consistent-type-discriminators","title":"2. Consistent Type Discriminators","text":"<p>Every complex type has a <code>type</code> field for unambiguous parsing.</p> <pre><code>signal:\n  type: indicator    # Always present\n  indicator: RSI\n  params: { period: 14 }\n</code></pre>"},{"location":"specification/#3-composition-via-references","title":"3. Composition via References","text":"<p>Reuse components with <code>$ref</code> instead of duplication.</p> <pre><code>signals:\n  rsi_14:\n    type: indicator\n    indicator: RSI\n    params: { period: 14 }\n\nrules:\n  - when:\n      left: { $ref: \"#/signals/rsi_14\" }  # Reference\n      operator: \"&lt;\"\n      right: { type: constant, value: 30 }\n</code></pre>"},{"location":"specification/#4-progressive-disclosure","title":"4. Progressive Disclosure","text":"<p>Simple strategies are concise; complexity is opt-in.</p> <pre><code># Minimal valid strategy\ninfo: { id: simple, version: \"1.0\" }\nuniverse: { type: static, symbols: [AAPL] }\nrules:\n  - name: Buy\n    when: { type: always }\n    then: { type: trade, direction: buy, sizing: { type: percent_of_equity, percent: 100 } }\n</code></pre>"},{"location":"specification/#5-execution-agnostic","title":"5. Execution-Agnostic","text":"<p>Schema defines strategy logic. Execution details (slippage, fees, broker) are out of scope.</p>"},{"location":"specification/#evaluation-flow","title":"Evaluation Flow","text":"<p>The conceptual evaluation flow (implemented by consuming applications):</p> <pre><code>sequenceDiagram\n    participant S as Schedule\n    participant U as Universe\n    participant Sig as Signals\n    participant C as Conditions\n    participant R as Rules\n    participant A as Actions\n    participant E as Execution Engine\n\n    S-&gt;&gt;U: Trigger evaluation\n    U-&gt;&gt;U: Resolve symbols\n    loop For each symbol\n        U-&gt;&gt;Sig: Compute signals\n        Sig-&gt;&gt;C: Evaluate conditions\n        C-&gt;&gt;R: Check rule triggers\n        R-&gt;&gt;R: Sort by priority\n        loop For each triggered rule\n            R-&gt;&gt;A: Get action\n            A-&gt;&gt;E: Submit order/alert\n        end\n    end\n    E-&gt;&gt;E: Apply constraints\n    E-&gt;&gt;E: Execute actions</code></pre>"},{"location":"specification/#data-flow","title":"Data Flow","text":"<pre><code>flowchart LR\n    subgraph Input[\"\ud83d\udce5 Market Data\"]\n        OHLCV[\"OHLCV\"]\n        Fund[\"Fundamentals\"]\n        Events[\"Events\"]\n    end\n\n    subgraph Signals[\"\ud83d\udcca Signals\"]\n        Price[\"Price\"]\n        Ind[\"Indicators\"]\n        Port[\"Portfolio\"]\n        Calc[\"Calculated\"]\n    end\n\n    subgraph Logic[\"\ud83e\udde0 Logic\"]\n        Cond[\"Conditions\"]\n        Rules[\"Rules\"]\n    end\n\n    subgraph Output[\"\ud83d\udce4 Output\"]\n        Orders[\"Orders\"]\n        Alerts[\"Alerts\"]\n        Positions[\"Positions\"]\n    end\n\n    OHLCV --&gt; Price\n    OHLCV --&gt; Ind\n    Fund --&gt; Calc\n    Events --&gt; Calc\n    Price --&gt; Cond\n    Ind --&gt; Cond\n    Port --&gt; Cond\n    Calc --&gt; Cond\n    Cond --&gt; Rules\n    Rules --&gt; Orders\n    Rules --&gt; Alerts\n    Orders --&gt; Positions\n    Positions --&gt; Port\n\n    style Input fill:#e3f2fd\n    style Signals fill:#e8f5e9\n    style Logic fill:#fff3e0\n    style Output fill:#f3e5f5</code></pre>"},{"location":"specification/#schema-structure","title":"Schema Structure","text":""},{"location":"specification/#top-level-document","title":"Top-Level Document","text":"<pre><code>$schema: https://obichan117.github.io/universal-trading-strategy-schema/schema/v1/strategy.json  # Optional\n\ninfo:          # Required - Strategy metadata\nuniverse:      # Required - Asset selection\nsignals:       # Optional - Named signal definitions\nconditions:    # Optional - Named condition definitions\nrules:         # Required - Trading rules (min 1)\nconstraints:   # Optional - Risk management\nschedule:      # Optional - Evaluation timing\nparameters:    # Optional - Optimizable parameters\n</code></pre>"},{"location":"specification/#info-required","title":"Info (Required)","text":"<pre><code>info:\n  id: string              # Required. Pattern: ^[a-z0-9_-]+$\n  name: string            # Required. Max 100 chars\n  version: string         # Required. Pattern: ^\\d+\\.\\d+(\\.\\d+)?$\n  description: string     # Optional. Max 2000 chars\n  author:                 # Optional\n    id: string\n    name: string\n  tags: [string]          # Optional. Max 10 items\n  created_at: datetime    # Optional. ISO 8601\n  updated_at: datetime    # Optional. ISO 8601\n  visibility: enum        # Optional. public | private | unlisted\n</code></pre>"},{"location":"specification/#universe-required","title":"Universe (Required)","text":"<pre><code># Option A: Static list\nuniverse:\n  type: static\n  symbols: [string]       # Required. Min 1 item\n\n# Option B: Index-based\nuniverse:\n  type: index\n  index: StockIndex       # Required. See enums\n  filters: [Condition]    # Optional. Filter criteria\n  rank_by: Signal         # Optional. Ranking signal\n  order: asc | desc       # Optional. Default: desc\n  limit: integer          # Optional. Max symbols\n\n# Option C: Screener\nuniverse:\n  type: screener\n  base: string            # Optional. Starting universe (index or \"all\")\n  filters: [Condition]    # Required. Min 1\n  rank_by: Signal         # Optional\n  order: asc | desc       # Optional\n  limit: integer          # Optional\n\n# Option D: Dual (for long-short)\nuniverse:\n  type: dual\n  long:                   # Same structure as index/screener\n    type: index\n    index: SP500\n    rank_by: Signal\n    limit: 50\n    direction: top\n  short:\n    type: index\n    index: SP500\n    rank_by: Signal\n    limit: 50\n    direction: bottom\n</code></pre>"},{"location":"specification/#signals-optional","title":"Signals (Optional)","text":"<p>Named signal definitions for reuse.</p> <pre><code>signals:\n  signal_name:            # Key becomes reference name\n    &lt;Signal&gt;              # Any Signal type\n</code></pre>"},{"location":"specification/#conditions-optional","title":"Conditions (Optional)","text":"<p>Named condition definitions for reuse.</p> <pre><code>conditions:\n  condition_name:         # Key becomes reference name\n    &lt;Condition&gt;           # Any Condition type\n</code></pre>"},{"location":"specification/#rules-required","title":"Rules (Required)","text":"<pre><code>rules:\n  - name: string          # Required. Human-readable name\n    description: string   # Optional\n    when: Condition       # Required. Trigger condition\n    then: Action          # Required. Action to take\n    priority: integer     # Optional. Higher = evaluated first. Default: 0\n    enabled: boolean      # Optional. Default: true\n    regime: string        # Optional. Only active in named regime\n</code></pre>"},{"location":"specification/#constraints-optional","title":"Constraints (Optional)","text":"<pre><code>constraints:\n  # Position limits\n  max_positions: integer          # Max concurrent positions\n  min_positions: integer          # Min positions (for diversification)\n  max_position_size: number       # Max % of portfolio per position (0-100)\n\n  # Stop losses\n  stop_loss:\n    percent: number               # Fixed % stop\n    atr_multiple: number          # ATR-based stop\n  trailing_stop:\n    percent: number               # Trailing % from peak\n    activation_percent: number    # Activate after this profit %\n    atr_multiple: number          # ATR-based trailing\n  time_stop:\n    bars: integer                 # Exit after N bars\n\n  # Take profit\n  take_profit:\n    percent: number\n    atr_multiple: number\n\n  # Portfolio limits\n  max_drawdown: number            # Stop trading at this drawdown % (0-100)\n  daily_loss_limit: number        # Max daily loss % (0-100)\n  max_sector_exposure: number     # Max % in single sector (0-100)\n  max_correlation: number         # Max correlation between positions (0-1)\n\n  # Restrictions\n  no_shorting: boolean            # Default: false\n  no_leverage: boolean            # Default: true\n\n  # Turnover\n  max_daily_turnover: number      # Max % turnover per day\n  min_holding_bars: integer       # Min bars before exit allowed\n</code></pre>"},{"location":"specification/#schedule-optional","title":"Schedule (Optional)","text":"<pre><code>schedule:\n  frequency: Frequency            # tick|1m|5m|15m|30m|1h|4h|daily|weekly|monthly\n  market_hours_only: boolean      # Default: true\n  timezone: string                # Default: \"America/New_York\" (e.g., \"Asia/Tokyo\")\n  trading_days: [DayOfWeek]       # Default: [monday..friday]\n  evaluate_at: [string]           # Specific times: [\"09:30\", \"15:55\"]\n</code></pre>"},{"location":"specification/#parameters-optional","title":"Parameters (Optional)","text":"<p>For parameter optimization in downstream applications.</p> <pre><code>parameters:\n  param_name:\n    type: integer | number | boolean | string\n    default: value                # Required\n    min: number                   # For numeric types\n    max: number                   # For numeric types\n    step: number                  # For numeric types\n    choices: [value]              # For string type\n    description: string           # Optional\n\n# Usage in signals/conditions:\nsignals:\n  rsi:\n    type: indicator\n    indicator: RSI\n    params:\n      period: { $param: param_name }  # Reference parameter\n</code></pre>"},{"location":"specification/#type-definitions","title":"Type Definitions","text":""},{"location":"specification/#signal","title":"Signal","text":"<p>Produces a numeric value.</p> <pre><code>Signal:\n  oneOf:\n    - PriceSignal\n    - IndicatorSignal\n    - FundamentalSignal\n    - CalendarSignal\n    - EventSignal\n    - PortfolioSignal\n    - RelativeSignal\n    - ConstantSignal\n    - ArithmeticSignal\n    - ExpressionSignal\n    - ExternalSignal\n    - Reference\n    - ParameterReference\n</code></pre> <pre><code>classDiagram\n    class Signal {\n        &lt;&lt;abstract&gt;&gt;\n    }\n    class PriceSignal {\n        +type: \"price\"\n        +field: PriceField\n        +offset: integer\n        +timeframe: Timeframe\n        +symbol: string\n    }\n    class IndicatorSignal {\n        +type: \"indicator\"\n        +indicator: IndicatorType\n        +params: object\n        +offset: integer\n    }\n    class FundamentalSignal {\n        +type: \"fundamental\"\n        +metric: FundamentalMetric\n        +symbol: string\n    }\n    class CalendarSignal {\n        +type: \"calendar\"\n        +field: CalendarField\n    }\n    class EventSignal {\n        +type: \"event\"\n        +event: EventType\n        +days_before: integer\n        +days_after: integer\n    }\n    class PortfolioSignal {\n        +type: \"portfolio\"\n        +field: PortfolioField\n        +symbol: string\n    }\n    class RelativeSignal {\n        +type: \"relative\"\n        +signal: Signal\n        +benchmark: string\n        +measure: RelativeMeasure\n        +lookback: integer\n    }\n    class ConstantSignal {\n        +type: \"constant\"\n        +value: number\n    }\n    class ArithmeticSignal {\n        +type: \"arithmetic\"\n        +operator: ArithmeticOp\n        +operands: Signal[]\n    }\n    class ExpressionSignal {\n        +type: \"expr\"\n        +formula: string\n    }\n    class ExternalSignal {\n        +type: \"external\"\n        +source: string\n        +url: string\n        +default: number\n    }\n    class Reference {\n        +$ref: string\n    }\n    class ParameterReference {\n        +$param: string\n    }\n\n    Signal &lt;|-- PriceSignal\n    Signal &lt;|-- IndicatorSignal\n    Signal &lt;|-- FundamentalSignal\n    Signal &lt;|-- CalendarSignal\n    Signal &lt;|-- EventSignal\n    Signal &lt;|-- PortfolioSignal\n    Signal &lt;|-- RelativeSignal\n    Signal &lt;|-- ConstantSignal\n    Signal &lt;|-- ArithmeticSignal\n    Signal &lt;|-- ExpressionSignal\n    Signal &lt;|-- ExternalSignal\n    Signal &lt;|-- Reference\n    Signal &lt;|-- ParameterReference\n\n    ArithmeticSignal o-- Signal : operands\n    RelativeSignal o-- Signal : signal</code></pre>"},{"location":"specification/#pricesignal","title":"PriceSignal","text":"<pre><code>type: price\nfield: PriceField           # Required. open|high|low|close|volume|vwap\noffset: integer             # Optional. Bars back (0=current). Default: 0\ntimeframe: Timeframe        # Optional. For MTF\nsymbol: string              # Optional. Cross-symbol reference\n</code></pre>"},{"location":"specification/#indicatorsignal","title":"IndicatorSignal","text":"<pre><code>type: indicator\nindicator: IndicatorType    # Required. See enums\nparams:                     # Optional. Indicator-specific\n  period: integer\n  fast_period: integer\n  slow_period: integer\n  signal_period: integer\n  std_dev: number\n  source: open|high|low|close|hl2|hlc3|ohlc4\noffset: integer             # Optional. Default: 0\ntimeframe: Timeframe        # Optional\nsymbol: string              # Optional. Cross-symbol reference\n</code></pre>"},{"location":"specification/#fundamentalsignal","title":"FundamentalSignal","text":"<pre><code>type: fundamental\nmetric: FundamentalMetric   # Required. See enums\nsymbol: string              # Optional\n</code></pre>"},{"location":"specification/#calendarsignal","title":"CalendarSignal","text":"<pre><code>type: calendar\nfield: CalendarField        # Required\n# Returns 1 if matches, 0 otherwise (or actual value for some fields)\n</code></pre> <p>CalendarField options: - <code>day_of_week</code>: Returns 1-5 (Mon-Fri) - <code>day_of_month</code>: Returns 1-31 (or -1 for last day) - <code>week_of_month</code>: Returns 1-5 - <code>month</code>: Returns 1-12 - <code>quarter</code>: Returns 1-4 - <code>year</code>: Returns year number - <code>is_month_start</code>: Returns 1 or 0 - <code>is_month_end</code>: Returns 1 or 0 - <code>is_quarter_start</code>: Returns 1 or 0 - <code>is_quarter_end</code>: Returns 1 or 0</p>"},{"location":"specification/#eventsignal","title":"EventSignal","text":"<pre><code>type: event\nevent: EventType            # Required. See enums\ndays_before: integer        # Optional. Days before event\ndays_after: integer         # Optional. Days after event\n# Returns 1 if within window, 0 otherwise\n</code></pre>"},{"location":"specification/#portfoliosignal","title":"PortfolioSignal","text":"<pre><code>type: portfolio\nfield: PortfolioField       # Required. See below\nsymbol: string              # Optional. Default: current universe symbol\n</code></pre> <p>PortfolioField options: - <code>position_qty</code>: Current position quantity (negative for short) - <code>position_value</code>: Current position market value - <code>position_side</code>: 1 (long), -1 (short), 0 (flat) - <code>avg_entry_price</code>: Volume-weighted average entry - <code>unrealized_pnl</code>: Unrealized P/L in currency - <code>unrealized_pnl_pct</code>: Unrealized P/L as % of entry - <code>realized_pnl</code>: Realized P/L for session - <code>days_in_position</code>: Calendar days since entry - <code>bars_in_position</code>: Bars since entry - <code>equity</code>: Total account equity - <code>cash</code>: Available cash - <code>buying_power</code>: Available buying power - <code>daily_pnl</code>: Today's P/L - <code>daily_pnl_pct</code>: Today's P/L as %</p>"},{"location":"specification/#relativesignal","title":"RelativeSignal","text":"<p>For cross-asset or benchmark-relative comparisons.</p> <pre><code>type: relative\nsignal: Signal              # Required. The signal to compare\nbenchmark: string           # Required. Index or symbol (e.g., \"SPY\", \"NIKKEI225\")\nmeasure: RelativeMeasure    # Required. How to compare\nlookback: integer           # Optional. Lookback period for rolling calculations\n</code></pre> <p>RelativeMeasure options: - <code>ratio</code>: signal / benchmark (e.g., price relative strength) - <code>difference</code>: signal - benchmark - <code>beta</code>: Rolling beta vs benchmark - <code>correlation</code>: Rolling correlation vs benchmark - <code>percentile</code>: Where signal ranks vs benchmark universe - <code>z_score</code>: Standardized score vs benchmark</p> <p>Example - Price Relative to S&amp;P 500:</p> <pre><code>signals:\n  relative_strength:\n    type: relative\n    signal: { type: price, field: close }\n    benchmark: SPY\n    measure: ratio\n    lookback: 20\n\nconditions:\n  outperforming:\n    type: comparison\n    left: { $ref: \"#/signals/relative_strength\" }\n    operator: \"&gt;\"\n    right: { type: constant, value: 1.0 }\n</code></pre>"},{"location":"specification/#constantsignal","title":"ConstantSignal","text":"<pre><code>type: constant\nvalue: number               # Required\n</code></pre>"},{"location":"specification/#arithmeticsignal","title":"ArithmeticSignal","text":"<pre><code>type: arithmetic\noperator: ArithmeticOp      # Required. add|subtract|multiply|divide|min|max|avg|abs|pow\noperands: [Signal]          # Required. Min 2 items (1 for abs)\n</code></pre>"},{"location":"specification/#expressionsignal","title":"ExpressionSignal","text":"<p>For custom formulas not expressible with built-in types.</p> <pre><code>type: expr\nformula: string             # Required. Expression string\n# Examples:\n# \"(SMA(close, 20) - SMA(close, 50)) / ATR(14)\"\n# \"close / HIGHEST(close, 52)\"\n# \"IF(RSI(14) &lt; 30, 1, 0)\"\n</code></pre> <p>Expression language supports: - Arithmetic: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code> - Functions: <code>SMA(source, period)</code>, <code>RSI(period)</code>, etc. - Conditionals: <code>IF(condition, then, else)</code> - Comparisons: <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code> - Logical: <code>AND</code>, <code>OR</code>, <code>NOT</code></p>"},{"location":"specification/#externalsignal","title":"ExternalSignal","text":"<p>For runtime-resolved signals (ML models, webhooks).</p> <pre><code>type: external\nsource: webhook | file | provider\nurl: string                 # For webhook\npath: string                # For file\nprovider: string            # For registered provider\nrefresh: Frequency          # How often to refresh\ndefault: number             # Fallback value if unavailable\n</code></pre>"},{"location":"specification/#reference","title":"Reference","text":"<pre><code>$ref: string                # JSON Pointer path\n# Examples:\n# \"#/signals/rsi_14\"\n# \"#/conditions/oversold\"\n</code></pre>"},{"location":"specification/#parameterreference","title":"ParameterReference","text":"<p>Reference to a strategy parameter defined in the <code>parameters</code> section.</p> <pre><code>$param: string              # Parameter name\n# Examples:\n# { $param: rsi_period }\n# { $param: oversold_threshold }\n</code></pre> <p>Example - Parameterized RSI Strategy:</p> <pre><code>parameters:\n  rsi_period:\n    type: integer\n    default: 14\n    min: 5\n    max: 30\n    description: RSI calculation period\n\n  oversold_level:\n    type: integer\n    default: 30\n    min: 20\n    max: 40\n\nsignals:\n  rsi:\n    type: indicator\n    indicator: RSI\n    params:\n      period: { $param: rsi_period }     # Uses parameter\n\nconditions:\n  oversold:\n    type: comparison\n    left: { $ref: \"#/signals/rsi\" }\n    operator: \"&lt;\"\n    right: { $param: oversold_level }    # Uses parameter\n</code></pre>"},{"location":"specification/#condition","title":"Condition","text":"<p>Produces a boolean value.</p> <p>UTSS v1.0 uses minimal condition primitives. Complex patterns (crossovers, ranges, temporal, sequences) are expressed via <code>expr</code> formulas. See <code>patterns/</code> directory for reusable formulas.</p> <pre><code>Condition:\n  oneOf:\n    - ComparisonCondition   # Compare signals\n    - AndCondition          # All must be true\n    - OrCondition           # Any must be true\n    - NotCondition          # Negate condition\n    - ExpressionCondition   # Formula for complex patterns\n    - AlwaysCondition       # Unconditional (for scheduled actions)\n    - Reference             # $ref to named condition\n</code></pre> <pre><code>classDiagram\n    class Condition {\n        &lt;&lt;abstract&gt;&gt;\n    }\n    class ComparisonCondition {\n        +type: \"comparison\"\n        +left: Signal\n        +operator: ComparisonOp\n        +right: Signal\n    }\n    class AndCondition {\n        +type: \"and\"\n        +conditions: Condition[]\n    }\n    class OrCondition {\n        +type: \"or\"\n        +conditions: Condition[]\n    }\n    class NotCondition {\n        +type: \"not\"\n        +condition: Condition\n    }\n    class ExpressionCondition {\n        +type: \"expr\"\n        +formula: string\n    }\n    class AlwaysCondition {\n        +type: \"always\"\n    }\n\n    Condition &lt;|-- ComparisonCondition\n    Condition &lt;|-- AndCondition\n    Condition &lt;|-- OrCondition\n    Condition &lt;|-- NotCondition\n    Condition &lt;|-- ExpressionCondition\n    Condition &lt;|-- AlwaysCondition\n\n    ComparisonCondition o-- Signal : left, right\n    AndCondition o-- Condition : conditions\n    OrCondition o-- Condition : conditions\n    NotCondition o-- Condition : condition</code></pre>"},{"location":"specification/#comparisoncondition","title":"ComparisonCondition","text":"<pre><code>type: comparison\nleft: Signal                # Required\noperator: ComparisonOp      # Required. &lt;|&lt;=|=|&gt;=|&gt;|!=\nright: Signal               # Required\n</code></pre>"},{"location":"specification/#andcondition","title":"AndCondition","text":"<pre><code>type: and\nconditions: [Condition]     # Required. Min 2\n</code></pre>"},{"location":"specification/#orcondition","title":"OrCondition","text":"<pre><code>type: or\nconditions: [Condition]     # Required. Min 2\n</code></pre>"},{"location":"specification/#notcondition","title":"NotCondition","text":"<pre><code>type: not\ncondition: Condition        # Required\n</code></pre>"},{"location":"specification/#expressioncondition","title":"ExpressionCondition","text":"<p>For complex patterns not expressible with primitives. Use for crossovers, ranges, temporal conditions, sequences, etc.</p> <pre><code>type: expr\nformula: string             # Required. Boolean expression\n</code></pre> <p>Example formulas (see <code>patterns/</code> for more):</p> <pre><code># Cross above: SMA(50) crosses above SMA(200)\nformula: \"SMA(50)[-1] &lt;= SMA(200)[-1] and SMA(50) &gt; SMA(200)\"\n\n# Range: RSI between 30 and 70\nformula: \"RSI(14) &gt; 30 and RSI(14) &lt; 70\"\n\n# Temporal: RSI oversold for 3 consecutive bars\nformula: \"all(RSI(14) &lt; 30, bars=3)\"\n\n# Sequence: RSI oversold then price bounce\nformula: \"RSI(14)[-5:-1].min() &lt; 30 and close &gt; close[-1] * 1.02\"\n</code></pre> <p>Expression language supports: - Arithmetic: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code> - Comparisons: <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code> - Logical: <code>and</code>, <code>or</code>, <code>not</code> - Indexing: <code>signal[-1]</code> (1 bar ago), <code>signal[-5:-1]</code> (range) - Functions: <code>min()</code>, <code>max()</code>, <code>all()</code>, <code>any()</code>, <code>abs()</code> - Indicators: <code>SMA(period)</code>, <code>RSI(period)</code>, <code>ATR(period)</code>, etc.</p>"},{"location":"specification/#alwayscondition","title":"AlwaysCondition","text":"<pre><code>type: always\n# Always evaluates to true. Useful for scheduled rebalancing.\n</code></pre>"},{"location":"specification/#action","title":"Action","text":"<p>What to do when condition is met.</p> <pre><code>Action:\n  oneOf:\n    - TradeAction\n    - RebalanceAction\n    - AlertAction\n    - HoldAction\n</code></pre> <pre><code>classDiagram\n    class Action {\n        &lt;&lt;abstract&gt;&gt;\n    }\n    class TradeAction {\n        +type: \"trade\"\n        +direction: Direction\n        +symbol: string\n        +sizing: Sizing\n        +order_type: OrderType\n        +limit_price: Signal\n        +stop_price: Signal\n        +time_in_force: TimeInForce\n    }\n    class RebalanceAction {\n        +type: \"rebalance\"\n        +method: RebalanceMethod\n        +targets: TargetWeight[]\n        +threshold: number\n    }\n    class AlertAction {\n        +type: \"alert\"\n        +message: string\n        +level: AlertLevel\n        +channels: Channel[]\n        +throttle_minutes: integer\n    }\n    class HoldAction {\n        +type: \"hold\"\n        +reason: string\n    }\n\n    Action &lt;|-- TradeAction\n    Action &lt;|-- RebalanceAction\n    Action &lt;|-- AlertAction\n    Action &lt;|-- HoldAction\n\n    TradeAction o-- Sizing : sizing\n    TradeAction o-- Signal : limit_price, stop_price</code></pre>"},{"location":"specification/#tradeaction","title":"TradeAction","text":"<pre><code>type: trade\ndirection: buy | sell | short | cover  # Required\nsymbol: string              # Optional. Default: current universe symbol\nsizing: Sizing              # Required\norder_type: OrderType       # Optional. Default: market\nlimit_price: Signal         # Optional. For limit orders\nstop_price: Signal          # Optional. For stop orders\ntime_in_force: TimeInForce  # Optional. Default: day\n</code></pre>"},{"location":"specification/#rebalanceaction","title":"RebalanceAction","text":"<pre><code>type: rebalance\nmethod: RebalanceMethod     # Required\ntargets:                    # Required for target_weights method\n  - symbol: string\n    weight: number          # 0-1\nthreshold: number           # Optional. Min deviation to trigger. Default: 0.05\n</code></pre> <p>RebalanceMethod options: - <code>equal_weight</code>: Equal allocation to all universe symbols - <code>market_cap_weight</code>: Weight by market cap - <code>risk_parity</code>: Weight by inverse volatility (equal risk contribution) - <code>inverse_volatility</code>: Weight by inverse volatility - <code>target_weights</code>: Use explicit targets</p>"},{"location":"specification/#alertaction","title":"AlertAction","text":"<pre><code>type: alert\nmessage: string             # Required. Supports placeholders: {symbol}, {price}, {indicator:NAME}\nlevel: info | warning | critical  # Optional. Default: info\nchannels: [Channel]         # Optional. Default: [log]\nthrottle_minutes: integer   # Optional. Min minutes between repeated alerts\n</code></pre> <p>Channel options: <code>log</code>, <code>webhook</code>, <code>email</code>, <code>sms</code>, <code>telegram</code>, <code>discord</code>, <code>slack</code></p>"},{"location":"specification/#holdaction","title":"HoldAction","text":"<pre><code>type: hold\nreason: string              # Optional. Explanation for why holding\n</code></pre>"},{"location":"specification/#sizing","title":"Sizing","text":"<p>How much to trade.</p> <pre><code>Sizing:\n  oneOf:\n    - FixedAmountSizing\n    - PercentEquitySizing\n    - PercentPositionSizing\n    - RiskBasedSizing\n    - KellySizing\n    - VolatilityAdjustedSizing\n    - ConditionalSizing\n</code></pre> <pre><code>classDiagram\n    class Sizing {\n        &lt;&lt;abstract&gt;&gt;\n    }\n    class FixedAmountSizing {\n        +type: \"fixed_amount\"\n        +amount: number\n        +currency: string\n    }\n    class PercentEquitySizing {\n        +type: \"percent_of_equity\"\n        +percent: number\n    }\n    class PercentPositionSizing {\n        +type: \"percent_of_position\"\n        +percent: number\n    }\n    class RiskBasedSizing {\n        +type: \"risk_based\"\n        +risk_percent: number\n        +stop_distance: Signal\n    }\n    class KellySizing {\n        +type: \"kelly\"\n        +fraction: number\n        +lookback: integer\n    }\n    class VolatilityAdjustedSizing {\n        +type: \"volatility_adjusted\"\n        +target_volatility: number\n        +lookback: integer\n    }\n    class ConditionalSizing {\n        +type: \"conditional\"\n        +cases: SizingCase[]\n        +default: Sizing\n    }\n\n    Sizing &lt;|-- FixedAmountSizing\n    Sizing &lt;|-- PercentEquitySizing\n    Sizing &lt;|-- PercentPositionSizing\n    Sizing &lt;|-- RiskBasedSizing\n    Sizing &lt;|-- KellySizing\n    Sizing &lt;|-- VolatilityAdjustedSizing\n    Sizing &lt;|-- ConditionalSizing\n\n    RiskBasedSizing o-- Signal : stop_distance\n    ConditionalSizing o-- Sizing : cases, default\n    ConditionalSizing o-- Condition : cases.when</code></pre>"},{"location":"specification/#fixedamountsizing","title":"FixedAmountSizing","text":"<pre><code>type: fixed_amount\namount: number              # Required. Currency amount\ncurrency: string            # Optional. Default: USD\n</code></pre>"},{"location":"specification/#percentequitysizing","title":"PercentEquitySizing","text":"<pre><code>type: percent_of_equity\npercent: number             # Required. 0-100\n</code></pre>"},{"location":"specification/#percentpositionsizing","title":"PercentPositionSizing","text":"<pre><code>type: percent_of_position\npercent: number             # Required. 0-100\n</code></pre>"},{"location":"specification/#riskbasedsizing","title":"RiskBasedSizing","text":"<pre><code>type: risk_based\nrisk_percent: number        # Required. % of equity to risk (0-100)\nstop_distance: Signal       # Required. Distance to stop in price units\n</code></pre>"},{"location":"specification/#kellysizing","title":"KellySizing","text":"<pre><code>type: kelly\nfraction: number            # Optional. Fraction of Kelly (0-1). Default: 0.5\nlookback: integer           # Optional. Bars for win rate calc. Default: 100\n</code></pre>"},{"location":"specification/#volatilityadjustedsizing","title":"VolatilityAdjustedSizing","text":"<pre><code>type: volatility_adjusted\ntarget_volatility: number   # Required. Target annualized vol\nlookback: integer           # Optional. Default: 20\n</code></pre>"},{"location":"specification/#conditionalsizing","title":"ConditionalSizing","text":"<pre><code>type: conditional\ncases:                      # Required. Min 1\n  - when: Condition\n    sizing: Sizing\ndefault: Sizing             # Required. Fallback sizing\n</code></pre>"},{"location":"specification/#enumerations","title":"Enumerations","text":"<p>All enumerations follow the extensible enum pattern: core values are guaranteed portable, while prefixed values provide extensibility.</p>"},{"location":"specification/#closed-enums-fixed-values","title":"Closed Enums (Fixed Values)","text":"<p>These enums are closed and do not support extensions:</p>"},{"location":"specification/#timeframe","title":"Timeframe","text":"<pre><code>tick | 1m | 5m | 15m | 30m | 1h | 4h | daily | weekly | monthly\n</code></pre>"},{"location":"specification/#dayofweek","title":"DayOfWeek","text":"<pre><code>monday | tuesday | wednesday | thursday | friday\n</code></pre>"},{"location":"specification/#pricefield","title":"PriceField","text":"<pre><code>open | high | low | close | volume | vwap\n</code></pre>"},{"location":"specification/#ordertype","title":"OrderType","text":"<pre><code>market | limit | stop | stop_limit\n</code></pre>"},{"location":"specification/#timeinforce","title":"TimeInForce","text":"<pre><code>day | gtc | ioc | fok\n</code></pre>"},{"location":"specification/#comparisonop","title":"ComparisonOp","text":"<pre><code>&lt; | &lt;= | = | &gt;= | &gt; | !=\n</code></pre>"},{"location":"specification/#arithmeticop","title":"ArithmeticOp","text":"<pre><code>add | subtract | multiply | divide | min | max | avg | abs | pow\n</code></pre>"},{"location":"specification/#extensible-enums-open-for-extensions","title":"Extensible Enums (Open for Extensions)","text":"<p>These enums support namespaced extensions via prefixes.</p>"},{"location":"specification/#indicatortype","title":"IndicatorType","text":"<p>Core Values (Portable):</p> Category Indicators Moving Averages <code>SMA</code>, <code>EMA</code>, <code>WMA</code>, <code>DEMA</code>, <code>TEMA</code>, <code>KAMA</code>, <code>HULL</code>, <code>VWMA</code> Momentum <code>RSI</code>, <code>MACD</code>, <code>MACD_SIGNAL</code>, <code>MACD_HIST</code>, <code>STOCH_K</code>, <code>STOCH_D</code>, <code>STOCH_RSI</code>, <code>ROC</code>, <code>MOMENTUM</code>, <code>WILLIAMS_R</code>, <code>CCI</code>, <code>MFI</code>, <code>CMO</code>, <code>TSI</code> Trend <code>ADX</code>, <code>PLUS_DI</code>, <code>MINUS_DI</code>, <code>AROON_UP</code>, <code>AROON_DOWN</code>, <code>AROON_OSC</code>, <code>SUPERTREND</code>, <code>PSAR</code> Volatility <code>ATR</code>, <code>STDDEV</code>, <code>VARIANCE</code>, <code>BB_UPPER</code>, <code>BB_MIDDLE</code>, <code>BB_LOWER</code>, <code>BB_WIDTH</code>, <code>BB_PERCENT</code>, <code>KC_UPPER</code>, <code>KC_MIDDLE</code>, <code>KC_LOWER</code>, <code>DC_UPPER</code>, <code>DC_MIDDLE</code>, <code>DC_LOWER</code> Volume <code>OBV</code>, <code>VWAP</code>, <code>AD</code>, <code>CMF</code>, <code>KLINGER</code> Price Patterns <code>HIGHEST</code>, <code>LOWEST</code>, <code>RETURN</code>, <code>DRAWDOWN</code> Statistical <code>ZSCORE</code>, <code>PERCENTILE</code>, <code>RANK</code>, <code>CORRELATION</code>, <code>BETA</code> Ichimoku <code>ICHIMOKU_TENKAN</code>, <code>ICHIMOKU_KIJUN</code>, <code>ICHIMOKU_SENKOU_A</code>, <code>ICHIMOKU_SENKOU_B</code>, <code>ICHIMOKU_CHIKOU</code> <p>Extension Prefixes:</p> Prefix Pattern Example Use Case <code>custom:</code> <code>custom:[a-zA-Z0-9_]+</code> <code>custom:MY_SUPERTREND</code> User-defined indicators <code>talib:</code> <code>talib:[A-Z0-9_]+</code> <code>talib:CDLHAMMER</code> TA-Lib candle patterns <code>platform:</code> <code>platform:[a-z]+:[a-zA-Z0-9_]+</code> <code>platform:tradingview:SQUEEZE</code> Platform-specific"},{"location":"specification/#fundamentalmetric","title":"FundamentalMetric","text":"<p>Core Values (Portable):</p> Category Metrics Valuation <code>PE_RATIO</code>, <code>PB_RATIO</code>, <code>PS_RATIO</code>, <code>PEG_RATIO</code>, <code>EV_EBITDA</code>, <code>EARNINGS_YIELD</code> Profitability <code>ROE</code>, <code>ROA</code>, <code>ROIC</code>, <code>PROFIT_MARGIN</code>, <code>OPERATING_MARGIN</code>, <code>NET_MARGIN</code> Dividend <code>DIVIDEND_YIELD</code>, <code>PAYOUT_RATIO</code> Size &amp; Growth <code>MARKET_CAP</code>, <code>ENTERPRISE_VALUE</code>, <code>REVENUE</code>, <code>EBITDA</code>, <code>NET_INCOME</code>, <code>EPS</code>, <code>EPS_GROWTH</code>, <code>REVENUE_GROWTH</code> Financial Health <code>DEBT_TO_EQUITY</code>, <code>CURRENT_RATIO</code>, <code>QUICK_RATIO</code>, <code>INTEREST_COVERAGE</code> Quality <code>F_SCORE</code>, <code>ALTMAN_Z</code> Other <code>INDEX_WEIGHT</code>, <code>FREE_FLOAT</code>, <code>SHORT_INTEREST</code>, <code>ANALYST_RATING</code>, <code>PRICE_TARGET</code>, <code>EARNINGS_SURPRISE</code> <p>Extension Prefixes:</p> Prefix Pattern Example Use Case <code>custom:</code> <code>custom:[a-zA-Z0-9_]+</code> <code>custom:MODIFIED_ALTMAN_Z</code> User-defined metrics <code>provider:</code> <code>provider:[a-z]+:[a-zA-Z0-9_]+</code> <code>provider:bloomberg:WACC</code> Data provider-specific"},{"location":"specification/#eventtype","title":"EventType","text":"<p>Core Values (Portable):</p> <pre><code>EARNINGS_RELEASE | DIVIDEND_EX_DATE | DIVIDEND_PAY_DATE | STOCK_SPLIT |\nIPO | DELISTING | FDA_APPROVAL | PRODUCT_LAUNCH | INDEX_ADD | INDEX_REMOVE |\nINSIDER_BUY | INSIDER_SELL | ANALYST_UPGRADE | ANALYST_DOWNGRADE |\nSEC_FILING_10K | SEC_FILING_10Q | SEC_FILING_8K\n</code></pre> <p>Extension Prefixes:</p> Prefix Pattern Example Use Case <code>custom:</code> <code>custom:[a-zA-Z0-9_]+</code> <code>custom:PRODUCT_RECALL</code> User-defined events <code>calendar:</code> <code>calendar:[a-zA-Z0-9_]+</code> <code>calendar:FOMC_DECISION</code> Economic calendar events"},{"location":"specification/#stockindex","title":"StockIndex","text":"<p>Core Values (Portable):</p> Region Indices Japan <code>NIKKEI225</code>, <code>TOPIX</code>, <code>TOPIX100</code>, <code>TOPIX500</code>, <code>JPXNIKKEI400</code>, <code>TSE_PRIME</code>, <code>TSE_STANDARD</code>, <code>TSE_GROWTH</code>, <code>TOPIX_LARGE70</code>, <code>TOPIX_MID400</code>, <code>TOPIX_SMALL</code>, <code>MOTHERS</code> US <code>SP500</code>, <code>NASDAQ100</code>, <code>DOW30</code>, <code>RUSSELL2000</code>, <code>RUSSELL1000</code>, <code>SP400</code>, <code>SP600</code> Europe <code>FTSE100</code>, <code>DAX40</code>, <code>CAC40</code>, <code>STOXX50</code>, <code>STOXX600</code> Asia-Pacific <code>HANG_SENG</code>, <code>SSE50</code>, <code>CSI300</code>, <code>KOSPI</code>, <code>KOSDAQ</code>, <code>TWSE</code>, <code>ASX200</code> Global <code>MSCI_WORLD</code>, <code>MSCI_EM</code>, <code>MSCI_ACWI</code>, <code>MSCI_EAFE</code> <p>Extension Prefixes:</p> Prefix Pattern Example Use Case <code>custom:</code> <code>custom:[a-zA-Z0-9_]+</code> <code>custom:MY_WATCHLIST</code> User-defined lists <code>etf:</code> <code>etf:[A-Z0-9]+</code> <code>etf:SPY</code> ETF as universe source <code>sector:</code> <code>sector:[A-Z0-9_]+</code> <code>sector:TECHNOLOGY</code> Sector-based universes"},{"location":"specification/#extensibility","title":"Extensibility","text":"<p>UTSS uses a layered extensibility model that balances portability with flexibility. This design is inspired by protocols like FIX (registered tag ranges) and Protocol Buffers (open enums with unknown value handling).</p>"},{"location":"specification/#extensibility-philosophy","title":"Extensibility Philosophy","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    EXTENSIBILITY LAYERS                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Layer 1: Core Enums     \u2502 Portable, all engines MUST support  \u2502\n\u2502  Layer 2: Namespaced     \u2502 custom:, talib:, platform:, etc.    \u2502\n\u2502  Layer 3: Expressions    \u2502 type: expr with formula string      \u2502\n\u2502  Layer 4: External       \u2502 type: external for runtime signals  \u2502\n\u2502  Layer 5: x-extensions   \u2502 Platform-specific, ignored by spec  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"specification/#layer-1-core-enums-portable","title":"Layer 1: Core Enums (Portable)","text":"<p>All values in the core enum lists are guaranteed portable. Every UTSS-compliant engine MUST support them.</p> <pre><code>indicator: RSI              # Core - all engines support\nmetric: PE_RATIO            # Core - all engines support\nindex: SP500                # Core - all engines support\n</code></pre>"},{"location":"specification/#layer-2-namespaced-extensions-semi-portable","title":"Layer 2: Namespaced Extensions (Semi-Portable)","text":"<p>For values not in the core enum, use namespaced prefixes:</p> Prefix Purpose Example <code>custom:</code> User-defined <code>custom:MY_SUPERTREND</code> <code>talib:</code> TA-Lib indicators <code>talib:CDLHAMMER</code> <code>platform:</code> Platform-specific <code>platform:tradingview:SQUEEZE</code> <code>provider:</code> Data provider <code>provider:bloomberg:WACC</code> <code>calendar:</code> Economic events <code>calendar:FOMC_DECISION</code> <code>etf:</code> ETF as universe <code>etf:SPY</code> <code>sector:</code> Sector universe <code>sector:TECHNOLOGY</code> <p>Engine behavior for namespaced values: - Engine MAY support the value - Engine SHOULD log a warning if unsupported - Engine MUST NOT fail validation (schema allows the pattern)</p> <p>Example:</p> <pre><code>signals:\n  # Core indicator - guaranteed support\n  rsi:\n    type: indicator\n    indicator: RSI\n    params: { period: 14 }\n\n  # Custom indicator - engine may or may not support\n  squeeze:\n    type: indicator\n    indicator: platform:tradingview:SQUEEZE_MOMENTUM\n    params: { length: 20 }\n\n  # TA-Lib candle pattern\n  hammer:\n    type: indicator\n    indicator: talib:CDLHAMMER\n</code></pre>"},{"location":"specification/#layer-3-expression-language","title":"Layer 3: Expression Language","text":"<p>For calculations not expressible with built-in indicators:</p> <pre><code>signals:\n  custom_ratio:\n    type: expr\n    formula: \"(SMA(close, 20) - SMA(close, 50)) / ATR(14)\"\n</code></pre> <p>Expression language supports: - Arithmetic: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code> - Functions: <code>SMA(source, period)</code>, <code>RSI(period)</code>, etc. - Conditionals: <code>IF(condition, then, else)</code> - Comparisons: <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code> - Logical: <code>AND</code>, <code>OR</code>, <code>NOT</code></p> <p>Execution engines must implement an expression parser.</p>"},{"location":"specification/#layer-4-external-signals","title":"Layer 4: External Signals","text":"<p>For runtime-resolved values (ML models, webhooks, files):</p> <pre><code>signals:\n  ml_prediction:\n    type: external\n    source: webhook\n    url: \"https://api.mymodel.com/predict\"\n    refresh: daily\n    default: 0.5\n</code></pre> <p>Execution engines must implement HTTP client / file reader.</p>"},{"location":"specification/#layer-5-x-extensions","title":"Layer 5: x-extensions","text":"<p>For platform-specific metadata (ignored by schema validation):</p> <pre><code>x-backtest:\n  slippage_pct: 0.1\n  commission_pct: 0.05\n\nx-live:\n  broker: sbi\n  account_type: margin\n</code></pre>"},{"location":"specification/#adding-new-core-values","title":"Adding New Core Values","text":"<p>To add a value to core enums: 1. Submit proposal to UTSS specification 2. Value is reviewed for broad applicability 3. If accepted, added in next schema version 4. Until then, use <code>custom:</code> prefix</p>"},{"location":"specification/#portability-matrix","title":"Portability Matrix","text":"Layer Validation Portability LLM-Friendly Core enum \u2705 Strict \u2705 All engines \u2705 High <code>custom:</code> prefix \u2705 Pattern \u26a0\ufe0f Engine-dependent \u2705 High <code>platform:</code> prefix \u2705 Pattern \u274c Platform-specific \u26a0\ufe0f Medium <code>expr:</code> formula \u2705 Type \u26a0\ufe0f Parser-dependent \u26a0\ufe0f Medium <code>external:</code> \u2705 Type \u26a0\ufe0f Runtime-dependent \u26a0\ufe0f Medium <code>x-*</code> \u274c Ignored \u274c Non-portable \u274c Low"},{"location":"specification/#examples","title":"Examples","text":""},{"location":"specification/#minimal-strategy","title":"Minimal Strategy","text":"<pre><code>info:\n  id: minimal\n  name: Minimal Strategy\n  version: \"1.0\"\n\nuniverse:\n  type: static\n  symbols: [7203.T]  # Toyota\n\nrules:\n  - name: Always hold\n    when: { type: always }\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 100 }\n</code></pre>"},{"location":"specification/#rsi-mean-reversion","title":"RSI Mean Reversion","text":"<pre><code>info:\n  id: rsi_reversal\n  name: RSI Mean Reversion\n  version: \"1.0\"\n  tags: [mean-reversion, RSI]\n\nuniverse:\n  type: static\n  symbols: [AAPL, MSFT, GOOGL]\n\nsignals:\n  rsi_14:\n    type: indicator\n    indicator: RSI\n    params: { period: 14 }\n\nconditions:\n  oversold:\n    type: comparison\n    left: { $ref: \"#/signals/rsi_14\" }\n    operator: \"&lt;\"\n    right: { type: constant, value: 30 }\n\n  overbought:\n    type: comparison\n    left: { $ref: \"#/signals/rsi_14\" }\n    operator: \"&gt;\"\n    right: { type: constant, value: 70 }\n\nrules:\n  - name: Buy oversold\n    when: { $ref: \"#/conditions/oversold\" }\n    then:\n      type: trade\n      direction: buy\n      sizing: { type: percent_of_equity, percent: 10 }\n    priority: 1\n\n  - name: Sell overbought\n    when: { $ref: \"#/conditions/overbought\" }\n    then:\n      type: trade\n      direction: sell\n      sizing: { type: percent_of_position, percent: 100 }\n    priority: 2\n\nconstraints:\n  max_positions: 5\n  stop_loss: { percent: 5 }\n  take_profit: { percent: 15 }\n\nschedule:\n  frequency: daily\n  market_hours_only: true\n  timezone: America/New_York\n</code></pre>"},{"location":"specification/#nikkei-momentum-with-hedge","title":"Nikkei Momentum with Hedge","text":"<pre><code>info:\n  id: nikkei_momentum_hedged\n  name: Nikkei 225 Momentum with RSI Hedge\n  version: \"1.0\"\n  tags: [japan, momentum, hedged]\n\nparameters:\n  momentum_lookback:\n    type: integer\n    default: 126\n    min: 60\n    max: 252\n  top_n:\n    type: integer\n    default: 5\n    min: 3\n    max: 10\n  hedge_rsi_threshold:\n    type: integer\n    default: 70\n    min: 60\n    max: 80\n\nuniverse:\n  type: index\n  index: NIKKEI225\n  rank_by:\n    type: indicator\n    indicator: RETURN\n    params: { period: { $param: momentum_lookback } }\n  limit: { $param: top_n }\n\nsignals:\n  nikkei_etf_rsi:\n    type: indicator\n    indicator: RSI\n    params: { period: 14 }\n    symbol: 1321.T\n\nconditions:\n  etf_overbought:\n    type: comparison\n    left: { $ref: \"#/signals/nikkei_etf_rsi\" }\n    operator: \"&gt;\"\n    right: { type: constant, value: { $param: hedge_rsi_threshold } }\n\n  etf_recovered:\n    type: comparison\n    left: { $ref: \"#/signals/nikkei_etf_rsi\" }\n    operator: \"&lt;\"\n    right: { type: constant, value: 50 }\n\n  not_hedged:\n    type: comparison\n    left: { type: portfolio, field: position_qty, symbol: 1321.T }\n    operator: \"=\"\n    right: { type: constant, value: 0 }\n\n  is_hedged:\n    type: comparison\n    left: { type: portfolio, field: position_qty, symbol: 1321.T }\n    operator: \"&lt;\"\n    right: { type: constant, value: 0 }\n\nrules:\n  - name: Monthly rebalance\n    when:\n      type: calendar\n      field: is_month_start\n    then:\n      type: rebalance\n      method: equal_weight\n    priority: 1\n\n  - name: Activate hedge\n    when:\n      type: and\n      conditions:\n        - { $ref: \"#/conditions/etf_overbought\" }\n        - { $ref: \"#/conditions/not_hedged\" }\n    then:\n      type: trade\n      direction: short\n      symbol: 1321.T\n      sizing: { type: percent_of_equity, percent: 30 }\n    priority: 2\n\n  - name: Remove hedge\n    when:\n      type: and\n      conditions:\n        - { $ref: \"#/conditions/etf_recovered\" }\n        - { $ref: \"#/conditions/is_hedged\" }\n    then:\n      type: trade\n      direction: cover\n      symbol: 1321.T\n      sizing: { type: percent_of_position, percent: 100 }\n    priority: 3\n\nconstraints:\n  max_positions: 6\n  stop_loss: { percent: 10 }\n  no_leverage: false\n\nschedule:\n  frequency: daily\n  market_hours_only: true\n  timezone: Asia/Tokyo\n</code></pre>"},{"location":"specification/#risk-parity-portfolio","title":"Risk Parity Portfolio","text":"<pre><code>info:\n  id: risk_parity\n  name: Risk Parity Portfolio\n  version: \"1.0\"\n  tags: [portfolio, risk-parity]\n\nuniverse:\n  type: static\n  symbols: [SPY, TLT, GLD, VNQ]\n\nrules:\n  - name: Monthly risk parity rebalance\n    when:\n      type: calendar\n      field: is_month_start\n    then:\n      type: rebalance\n      method: risk_parity\n      threshold: 0.05\n\nconstraints:\n  max_drawdown: 15\n\nschedule:\n  frequency: daily\n  timezone: America/New_York\n</code></pre>"},{"location":"specification/#version-history","title":"Version History","text":"Version Date Changes 1.0.0 2024-01 Initial release with signals, conditions, rules 1.0.0 2024-01 Portfolio signals, expressions, parameters, extended indicators/indices, alerts"},{"location":"specification/#references","title":"References","text":"<ul> <li>JSON Schema Draft-07: https://json-schema.org/draft-07/schema</li> <li>ISO 8601 Datetime: https://en.wikipedia.org/wiki/ISO_8601</li> <li>IANA Timezone Database: https://www.iana.org/time-zones</li> </ul>"}]}